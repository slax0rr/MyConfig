
require=function e(t,a,s){function r(n,o){if(!a[n]){if(!t[n]){var l="function"==typeof require&&require;if(!o&&l)return l(n,!0);if(i)return i(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var p=a[n]={exports:{}};t[n][0].call(p.exports,function(e){var a=t[n][1][e];return r(a?a:e)},p,p.exports,e,t,a,s)}return a[n].exports}for(var i="function"==typeof require&&require,n=0;n<s.length;n++)r(s[n]);return r}({3:[function(e,t,a){"use strict";var s=e("../naboo/tips"),r=e("../naboo/feed"),i=e("../naboo/search"),n=e("../naboo/fan"),o=e("../naboo/artist"),l=e("../naboo/album"),c=e("../naboo/playlist"),p=e("../naboo/radio"),d=e("../naboo/talkshow"),u=e("../naboo/talk"),h=e("../naboo/track_list"),m=e("../naboo/top_track"),_=e("../naboo/discography"),y=e("../naboo/menu"),g=e("../naboo/home"),f=e("../naboo/page"),b=e("../naboo/latestEpisodes"),v=e("../naboo/profile"),E=e("../naboo/explore"),T=e("../naboo/tops"),S=e("../naboo/related"),A=e("../naboo/related_playlist"),P=e("../naboo/related_track"),N=e("../naboo/moods"),I=e("../tools/bugreporting/jira-issue-collector");e("blockadblock"),window.feed=r,window.search=i,window.fan=n,window.artist=o,window.album=l,window.playlist=c,window.radio=p,window.talkshow=d,window.talk=u,window.track_list=h,window.top_track=m,window.discography=_,window.menu=y,window.home=g,window.page=f,window.latestEpisodes=b,window.profile=v,window.explore=E,window.tops=T,window.related=S,window.related_playlist=A,window.related_track=P,window.moods=N,s.init(),document.addEventListener("DOMContentLoaded",I)},{"../naboo/album":253,"../naboo/artist":254,"../naboo/discography":255,"../naboo/explore":256,"../naboo/fan":257,"../naboo/feed":258,"../naboo/home":259,"../naboo/latestEpisodes":260,"../naboo/menu":261,"../naboo/moods":262,"../naboo/page":263,"../naboo/playlist":264,"../naboo/profile":265,"../naboo/radio":266,"../naboo/related":267,"../naboo/related_playlist":268,"../naboo/related_track":269,"../naboo/search":270,"../naboo/talk":272,"../naboo/talkshow":273,"../naboo/tips":274,"../naboo/top_track":275,"../naboo/tops":276,"../naboo/track_list":277,"../tools/bugreporting/jira-issue-collector":278,blockadblock:"blockadblock"}],278:[function(e,t,a){"use strict";var s=function(){gatekeeper.isAllowed("employee_feature")&&(window.ATL_JQ_PAGE_PROPS={triggerFunction:function(e){window.ATL_JQ_SHOW_DIALOG=e}})};t.exports=s},{}],277:[function(e,t,a){"use strict";var s,r=e("react"),i=e("react-dom"),n=e("../components/tracklist/TrackList"),o={display:function(e){s=document.getElementById("tab_track_list_content"),s&&i.render(r.createElement(n,{playlist:e.data}),s),Events.trigger(Events.navigation.tab_displayed,e)},leave:function(){s&&i.unmountComponentAtNode(s)}};t.exports=o},{"../components/tracklist/TrackList":218,react:"react","react-dom":"react-dom"}],218:[function(e,t,a){"use strict";var s=e("react"),r=e("../../core/i18n"),i=r.gettext,n=(e("../../models/track"),e("@deezer/components/common/DataGrid")),o=s.createClass({displayName:"TrackList",propTypes:{playlist:s.PropTypes.object.isRequired},childContextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),lastSeen:s.PropTypes.number},getChildContext:function(){return{id:this.props.playlist.id,lastSeen:this.props.playlist.last_seen}},componentDidMount:function(){Events.subscribe(Events.playlist.addSong,this._updateHeaderAdd),Events.subscribe(Events.playlist.removeSong,this._updateHeaderRemove)},componentWillUnmount:function(){Events.unsubscribe(Events.playlist.addSong,this._updateHeaderAdd),Events.unsubscribe(Events.playlist.removeSong,this._updateHeaderRemove)},render:function(){return this.props.playlist.playlist_private===!0?this._renderPrivatePlaceholder():s.createElement(n.FullPage,{type:this.props.playlist.playlist_personnal||this.props.playlist.playlist_collab?"personalPlaylist":"playlist",items:this.props.playlist.songs.data})},_renderPrivatePlaceholder:function(){return s.createElement("div",{className:"datagrid datagrid-header"},s.createElement("div",{className:"wrapper",id:"naboo_datagrid_private"},s.createElement("div",{className:"placeholders-img private"}),s.createElement("div",{className:"placeholders-title"},i("Cette playlist est privée"))))},_updateHeaderAdd:function(e,t){this._updateHeader("add",t.song)},_updateHeaderRemove:function(e,t){this._updateHeader("remove",t.song)},_updateHeader:function(e,t){api.call({method:"song.getListAllData",data:{sng_ids:t},success:function(t){var a=("add"===e?1:-1)*this._getPlaylistDuration(t.data),s=("add"===e?1:-1)*t.data.length;window.playlist.updateDurationAndNbSongs(a,s)}.bind(this)})},_getPlaylistDuration:function(e){switch(e.length){case 0:return 0;case 1:return Number(e[0].DURATION);default:return e.reduce(function(e,t){return(Number(e.DURATION)||e)+Number(t.DURATION)})}}});t.exports=o},{"../../core/i18n":245,"../../models/track":252,"@deezer/components/common/DataGrid":92,react:"react"}],276:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("jquery"),n=e("../core/i18n"),o=n.gettext,l=e("../components/common/grid/Grid"),c=e("@deezer/components/common/GenreList/GenreList"),p={initialized:!1,id:0,template:"naboo/tops",data:[],item_width:220,item_height:220,item_artist_height:281,default_genre:0,start:0,nb:25,max:100,parent_genre:0,genre_id:0,type:"playlist",cache:{},abtest:"default",init:function(){try{if(p.initialized)return!0;templating.load(p.template),p.$filters_types=i("#naboo_tops_filters_type"),Events.ready(Events.user.userReady,function(){gatekeeper.isAllowed("curator_feature")?i("#order_playlist_top").show().on("click",function(){var e=modal.open("/lightbox/curators/edit_top_playlist/music/"+USER.USER_ID);Events.subscribeOnce(Events.modal.close,function(t,a){e===a&&p.forceReload()},"tops")}):i("#order_playlist_top").remove()}),p.abtest=!gatekeeper.isAllowed("new_popular_musics")||gatekeeper.isAllowed("new_home_de")||gatekeeper.isAllowed("new_home_en")||"object"!=typeof USER.ABTEST.new_home?"default":USER.ABTEST.new_home.option,"layoutd"===p.abtest?i("#naboo_tops_filters").addClass(0===p.genre_id?"no-genre":"one-genre"):i("#filter_type_news").remove(),p.initialized=!0}catch(e){error.log(e)}},display:function(e){try{p.start=0,p.type=e.type||p.type,p.genre_id=parseInt(e.genre_id||p.genre_id,10),p.init(),p.load(),i(".btn",p.$filters_types).removeClass("active"),i("#filter_type_"+p.type,p.$filters_types).addClass("active"),p.updateFiltersTypesUrls();var t=document.getElementById("naboo_tops_genre");return!t||0===p.genre_id&&"layoutd"===p.abtest||r.render(s.createElement(c,{onSelect:p.onChangeGenre,selectedId:p.genre_id,withoutGenreAll:"layoutd"===p.abtest}),t),naboo.afterLoad(!0),!0}catch(a){error.log(a)}},onChangeGenre:function(e){try{return e.GENRE_ID!==p.genre_id&&(p.genre_id=e.GENRE_ID,p.start=0,p.load(),tracking.track("tops_genre_click",{id:e.GENRE_ID,genre:addslashes(e.GENRE_NAME)}),p.updateFiltersTypesUrls()),!0}catch(t){error.log(t)}},load:function(){try{p.updateUrl(),0===p.start&&(p.data=[]);var e=p.type+"_"+p.genre_id;return"undefined"!=typeof p.cache[e]&&"undefined"!=typeof p.cache[e][p.start]?(p.loadCallback(p.cache[e][p.start]),!0):(api.call({method:"deezer.pageTops",data:{TYPE:p.type,GENRE_ID:p.genre_id,START:p.start,NB:p.nb},success:p.loadCallback}),!0)}catch(t){error.log(t)}},loadCallback:function(e){try{var t=p.type+"_"+p.genre_id;return"undefined"==typeof p.cache[t]&&(p.cache[t]={}),p.max=e.ITEMS.total,p.cache[t][p.start]=e,p.render(p.cache[t][p.start].ITEMS.data),!0}catch(a){error.log(a)}},render:function(e){try{var t=document.getElementById("naboo_tops_container");if(!t)return;for(var a=[],i=p.type,n=["name","artist","fans","tracks","sticker","play_link"],c=0;c<e.length;c++){var d=e[c];switch(p.type){case"track":i="song",right.checkSongAvailable(d)===right.READABLE&&a.push(d);break;case"album":d.AVAILABLE===!0&&(a.push(d),n.push("favorite"));break;case"artist":a.push(d),n.push("favorite");break;case"playlist":(""===d.TITLE||/^\s+$/.test(d.TITLE))&&(d.TITLE=o("Sans nom")),a.push(d),n.push("favorite");break;case"news":i="album",a.push(d)}}p.data=p.data.concat(a);var u={type:i,data:p.data,context:"tops_"+p.type,options:n,highlight:"playlist"===p.type?0:!1};return r.render(s.createElement(l,u),t,p.activeInfiniteScroll),Events.trigger(Events.navigation.page_updated),!0}catch(h){error.log(h)}},activeInfiniteScroll:function(){return p.start+p.nb>=p.max?(infinite_scroll.disable(),!1):(Events.subscribeOnce(Events.layout.infiniteScroll,function(){infinite_scroll.disable(),p.start+=p.nb,p.load()},"tops"),void infinite_scroll.active())},updateFiltersTypesUrls:function(){i(".btn",p.$filters_types).each(function(){i(this).attr("href",i(this).attr("href").replace(/(\/genre\/[0-9]+)|$/,"/genre/"+p.genre_id))})},updateUrl:function(){try{var e="/charts/"+p.type.toLowerCase();return p.genre_id>0&&(e+="/genre/"+p.genre_id),www.setCurrentPath(e),!0}catch(t){error.log(t)}},forceReload:function(){p.start=0,p.type="playlist",p.cache={},p.load()},leave:function(){try{p.start=0,p.type="playlist";var e=document.getElementById("naboo_tops_container"),t=document.getElementById("naboo_tops_genre");return e&&r.unmountComponentAtNode(e),t&&r.unmountComponentAtNode(t),!0}catch(a){error.log(a)}}};t.exports=p},{"../components/common/grid/Grid":134,"../core/i18n":245,"@deezer/components/common/GenreList/GenreList":121,jquery:"jquery",react:"react","react-dom":"react-dom"}],275:[function(e,t,a){"use strict";var s,r=e("react"),i=e("react-dom"),n=e("../components/common/DataGrid"),o={id:0,display:function(e){return o.id=e.id,api.call({method:"artist.getTopTrack",data:{art_id:o.id,start:0,nb:40},success:o.displayCallback}),!0},displayCallback:function(e){if(s=document.getElementById("naboo_top_track_artist")){var t={id:o.id,type:"artistTopTracks",items:e.data};i.render(r.createElement(n.FullPage,t),s)}Events.trigger(Events.navigation.tab_displayed,{type:"top_track",id:o.id})},leave:function(){s&&r.unmountComponentAtNode(s)}};t.exports=o},{"../components/common/DataGrid":92,react:"react","react-dom":"react-dom"}],274:[function(e,t,a){"use strict";var s=e("babel-runtime/core-js/object/keys")["default"],r=e("react"),i=e("react-dom"),n=e("jquery"),o=e("../core/i18n"),l=o.gettext,c=e("../components/tips/Tip"),p=null,d={tipsOnLoad:{playerfocus:!0},init:function(){try{var e=null;for(var t in d.tipsOnLoad)if(d.tipsOnLoad.hasOwnProperty(t)&&d.tipsOnLoad[t]===!0){if(e=d.load(t),d.check(e))break;e=null}Events.subscribe(Events.tips.close,function(e,t){d.close(t)}),Events.subscribe(Events.tips.draw,function(e,t){"string"==typeof t?d.draw(t):"object"==typeof t&&d.draw(t.name,t.check)}),Events.ready(Events.player.playerReady,function(){Events.subscribeOnce(Events.player.displayCurrentSong,function(){setTimeout(function(){null!==e&&e.hasOwnProperty("active")&&e.active===!0&&u.draw(e)},500)},"tips")},"tips"),h.init()}catch(a){error.log(a)}},load:function(e){return(e=u.element[e]||function(){return{}})()},check:function(e){return e.hasOwnProperty("active")&&e.active===!0&&"function"==typeof e.trigger&&e.trigger()===!0},draw:function(e,t){t=t||!1,e=d.load(e),t===!0&&!d.check(e)||null!==p||u.draw(e)},close:function(e){try{p=null;var t=document.getElementById(u.overlayName);null!==t&&document.body.removeChild(t);var a=d.load(e);if(a.hasOwnProperty("name")){var s=document.getElementById("tips_"+a.name);null!==s&&document.body.removeChild(s)}Events.unsubscribeAll("tips"),a.hasOwnProperty("overlay")&&a.overlay.hasOwnProperty("className")&&n("body").removeClass("has-focus "+a.overlay.className)}catch(r){error.log(r)}}},u={overlayName:"tips-overlay",draw:function(e){try{var t,a=e.name;if(p=a,"undefined"==typeof u.element[a])return!1;"function"==typeof e.callback&&e.callback(),"object"==typeof e.overlay&&(t=document.createElement("div"),t.id=u.overlayName,t.className=u.overlayName,t.style.display="none",document.body.appendChild(t).addEventListener("click",function(){d.close(a)}),n("body").addClass("has-focus "+e.overlay.className));var o=document.createElement("div");o.id="tips_"+a,o.className="tips",o.style.visibility="hidden",document.body.appendChild(o),i.render(r.createElement(c,e),document.getElementById("tips_"+a),function(){if(e.hasOwnProperty("user_settings")){var a={};s(e.user_settings).map(function(t){a[t]=e.user_settings[t]}),userSetting.set({tips:a})}e.hasOwnProperty("tracking")&&tracking.track(e.tracking.key,{context:e.tracking.context}),this.setPosition(e,o),"undefined"!=typeof t&&(t.style.display="block"),o.style.visibility="visible"}.bind(this))}catch(l){error.log(l)}},setPosition:function(e,t){if("function"==typeof e.style){var a=e.style();for(var s in a)a.hasOwnProperty(s)&&(t.style[s]=a[s]);USER.OPTIONS.ads_display&&Events.subscribeOnce(Events.layout.adsBanner,function(){this.setPosition(e,t)}.bind(this),"tips")}},element:{playlist_assistant:function(){return{active:!0,name:"playlist_assistant",title:l("Rajoutez des titres à votre playlist !"),body:l("Besoin d'inspiration ? On vous recommande des titres à ajouter à votre playlist."),closeBtn:!0,direction:"right-bottom",user_settings:{playlist_assistant:!1},overlay:{className:"has-focus-playlist-assistant"},trigger:function(){return Boolean(USER.SETTING.tips.playlist_assistant)},style:function e(){var t=document.getElementById("naboo_datagrid_add_track"),e={top:t.getBoundingClientRect().top-t.getBoundingClientRect().height/2+"px",left:t.getBoundingClientRect().left+t.getBoundingClientRect().width+6+"px"};return e}}},playlist_assistant_suggest:function(){return{active:!0,name:"playlist_assistant_suggest",title:l("Vous avez compris le principe ?"),body:l('Vous pouvez stopper à tout moment. Il suffit de cliquer sur "Terminé !".'),closeBtn:!0,user_settings:{playlist_assistant_suggest:!1},trigger:function(){return Boolean(USER.SETTING.tips.playlist_assistant_suggest)},style:function e(){var t=document.getElementById("modal_playlist_assistant_submit"),a=document.getElementById("tips_playlist_assistant_suggest"),e={"z-index":8e3,top:t.getBoundingClientRect().top+1.5*t.getBoundingClientRect().height-a.getBoundingClientRect().height+"px",left:t.getBoundingClientRect().left+t.getBoundingClientRect().width+10+"px"};return e}}},playerfocus:function(){return{active:!0,name:"playerfocus",play:!0,body:l("Écoutez vite la musique que vous avez choisie !"),closeBtn:!0,direction:"right",tracking:{key:"onboarding_feed_display",context:"onboarding"},overlay:{className:"has-focus-player"},user_settings:{player:!1},callback:function(){Events.ready(Events.user.userReady,function(){var e=userData.data;return"undefined"==typeof e.FAVORITES_ARTISTS.data[0]?void userData.loadData("genre"):void dzPlayer.play({type:"artist",id:e.FAVORITES_ARTISTS.data[0].ART_ID,autoplay:!1})}),Events.subscribeOnce(Events.user.userLoadData,function(e,t){if("genre"===t.type){var a=userData.data.FAVORITES_GENRES.data;"undefined"!=typeof a[0]&&api.call({method:"deezer.pageTops",data:{nb:1,type:"track",genre_id:a[0].GENRE_ID},success:function(e){"undefined"!=typeof e.ITEMS.data[0]&&dzPlayer.play({type:"track",id:[e.ITEMS.data[0].SNG_ID],autoplay:!1})}})}})},trigger:function(){return Boolean(USER.SETTING.tips.player)},style:function e(){var t=document.getElementById("player-cover"),a=document.getElementById("tips_"+this.name);if(null===t)return d.close(this.name),{};var s=t.getBoundingClientRect(),r=a.getBoundingClientRect(),e={top:s.top+r.height/2-8+"px"};return"rtl"===window.DIRECTION?e.left=s.left-r.width-15+"px":e.left=s.left+s.width+15+"px",e}}},flow:function(){return{active:!0,name:"flow",title:l("Toute la musique que vous avez envie d'écouter"),body:l("Votre Flow : un mix basé sur vos goûts, qui s'adapte continuellement à vous. "),direction:"bottom-right",overlay:{className:"has-focus-flow"},user_settings:{flow:!1},trigger:function(){var e=document.getElementsByClassName("flow-content").length;return Boolean(USER.SETTING.tips.flow&&e)},style:function e(){var t=document.getElementById("flow-love");if(null===t)return d.close(this.name),{};var a=t.childNodes[0].getBoundingClientRect(),e={top:a.top+a.height+20+"px",left:a.left-3+"px"};return e}}},lyrics:function(){return{active:!0,name:"lyrics",title:l("Vous avez repéré le micro ?"),body:l("Les paroles sont disponibles, cliquez et commencez à chanter."),direction:"right-top",overlay:{className:"has-focus-lyrics"},user_settings:{lyrics:0},trigger:function(){return USER.SETTING.tips.lyrics<=0?!1:0===dzPlayer.getCurrentSong("LYRICS_ID")?!1:USER.SETTING.tips.lyrics>1?(userSetting.set({tips:{lyrics:Math.round(USER.SETTING.tips.lyrics-1)}}),!1):!0},style:function e(){var t=document.getElementById("player-lyrics"),a=document.getElementById("tips_lyrics");if(null===t)return d.close(this.name),{};var s=t.getBoundingClientRect(),r=a.getBoundingClientRect(),e={top:s.top-r.height+42+"px"};return"rtl"===window.DIRECTION?e.left=s.left-r.width-15+"px":e.left=s.left+s.width+15+"px",e}}},add_to_library:function(){return{active:!0,name:"add_to_library",title:"",body:"",direction:"bottom",overlay:{className:"has-focus-add-library"},user_settings:{add_to_library:!1},callback:function(){var e=naboo.getCurrentClass(),t=window[e].data;"playlist"===e?(this.title=l("Vous avez envie de retrouver cette playlist ?"),this.body=l("Ajoutez-la à votre musique préférée, vous pouvez la réécouter à tout moment.")):"album"===e?(this.title=l("%1$s vous a plu ?",{sprintf:[t.ALB_TITLE]}),this.body=l("Vous aimez, vous nous le dites, il est directement ajouté à vos favoris.")):"artist"===e&&(this.title=l("Envie d'écouter %1$s plus tard ?",{sprintf:[t.DATA.ART_NAME]}),this.body=l("Retrouvez vos artistes préférés rapidement en les ajoutant à vos favoris."))},trigger:function(){var e=naboo.getCurrentClass();if("object"!=typeof window[e])return!1;var t=window[e].id;if(0===t||!e.match(/^(playlist|album|artist)$/i))return!1;if(userData.isFavorite(e,t))return!1;var a=document.getElementById("add_to_library");return a&&USER.SETTING.tips.add_to_library!==!1?!0:!1},style:function e(){var t=document.getElementById("add_to_library"),a=document.getElementById("tips_"+this.name);if(null===t)return d.close(this.name),{};var s=t.getBoundingClientRect(),r=a.getBoundingClientRect(),e={top:s.top+s.height+15+"px",left:s.left-r.width/2+42+"px"};return e}}}}},h={init:function(){USER.SETTING.tips.flow===!0&&Events.ready(Events.flow.playerDisplay,function(){setTimeout(function(){d.draw("flow",!0)},1e3)}),USER.SETTING.tips.lyrics>0&&Events.subscribe(Events.player.play,function(){setTimeout(function(){d.draw("lyrics",!0)},1e3)},"tips"),USER.SETTING.tips.add_to_library===!0&&Events.subscribe(Events.navigation.page_displayed,function(){setTimeout(function(){d.draw("add_to_library",!0)},1e3)})}};t.exports=d},{"../components/tips/Tip":217,"../core/i18n":245,"babel-runtime/core-js/object/keys":289,jquery:"jquery",react:"react","react-dom":"react-dom"}],217:[function(e,t,a){"use strict";var s=e("react"),r=e("../../core/i18n"),i=r.gettext,n=s.createClass({displayName:"Tip",propTypes:{name:s.PropTypes.string,title:s.PropTypes.string,body:s.PropTypes.string.isRequired,play:s.PropTypes.bool,closeBtn:s.PropTypes.bool,direction:s.PropTypes.string},getDefaultProps:function(){return{title:"",play:!1,closeBtn:!1,direction:"right-top"}},componentDidMount:function(){this.props.play===!0&&Events.subscribeOnce(Events.player.play,this._close)},componentWillUnmount:function(){this.props.play===!0&&Events.unsubscribe(Events.player.play)},render:function(){return s.createElement("div",{className:"popover popover-"+this.props.direction,role:"dialog","aria-labelledby":"tipTitle","aria-describedby":"tipBody"},this.props.closeBtn===!0?s.createElement("a",{className:"popover-close",role:"button",onClick:this._close},s.createElement("span",{className:"icon icon-cancel"})):null,s.createElement("div",{className:"popover-body"},""!==this.props.title?s.createElement("div",{className:"popover-header",id:"tipTitle"},this.props.title):null,s.createElement("p",{className:"highlight",id:"tipBody"},this.props.body),s.createElement("a",{className:"btn btn-primary btn-block",role:"button",onClick:this.props.play===!0?this._play:this._close},s.createElement("span",{className:"label"},i(this.props.play===!0?"Écouter maintenant":"J'ai compris")))))},_close:function(){Events.trigger(Events.tips.close,this.props.name)},_play:function(){dzPlayer.control.play()}});t.exports=n},{"../../core/i18n":245,react:"react"}],273:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("jquery");e("dotdotdot");var n=e("@deezer/components/talk/Show"),o=e("../core/i18n"),l=o.gettext,c={id:0,template:"naboo/show",data:[],display:function(e){try{return"string"!=typeof e.show_id?!1:(c.id=parseInt(e.show_id,10),api.call("deezer.pageShow",{show_id:c.id,country:COUNTRY,lang:SETTING_LANG},c.displayCallback),!0)}catch(t){error.log(t)}},displayCallback:function(e){try{templating.load(c.template);var t=document.getElementById("tab_talkshow_content");if(!t)return;i("#naboo_show_image").replaceWith(thumbnails.draw({id:e.DATA.SHOW_ID,type:"show",cover_type:"talk",pic_id:e.DATA.SHOW_ART_MD5,play:1,play_context:"show_page",border:!0,width:200,height:200,sent_to_mobile:!1,tracking:1,play_force:!0,zoom_on_cover:!0,context_menu_excludes:["go_to_show"],enable_preview:!1})),i("#naboo_show_name").text(e.DATA.SHOW_NAME),window.setTimeout(function(){i("#naboo_show_description").dotdotdot({height:80,after:"a",callback:function(e){e||i("a",this).remove()}}).find("> a").on("click",function(e){e.preventDefault(),tabs.display("show_info")})},0),i("#naboo_show_description").html(e.DATA.SHOW_DESCRIPTION+'<a class="readmore">'+l("Lire la suite")+"</a>");var a={talkshow:{selected:!0,args:{type:"talkshow",id:e.DATA.SHOW_ID}},show_info:{args:{type:"talkshow",data:e.DATA}}};return 0===e.DATA.SHOW_DESCRIPTION.length&&i("#tab_show_info_link").hide(),r.render(s.createElement(n,e),t),i("#naboo_show_favorite").html(button_multi_state.draw({action:"favorite",type:"show",id:e.DATA.SHOW_ID})),i("#naboo_show_share > button").data("id",e.DATA.SHOW_ID),tabs.init(i("#naboo_show_tabs"),a),naboo.afterLoad(!0),!0}catch(o){error.log(o)}},onOpenTab:function(e,t){tabs.display(e),"undefined"!=typeof t&&window[e].onDisplay(t),i("#page_content").scrollTop(0)}};t.exports=c},{"../core/i18n":245,"@deezer/components/talk/Show":216,dotdotdot:"dotdotdot",jquery:"jquery",react:"react","react-dom":"react-dom"}],216:[function(e,t,a){"use strict";var s=e("react"),r=e("@deezer/components/common/DataGrid"),i=s.createClass({displayName:"Show",propTypes:{id:s.PropTypes.number,DATA:s.PropTypes.object,EPISODES:s.PropTypes.object},childContextTypes:{id:s.PropTypes.number,name:s.PropTypes.string},getDefaultProps:function(){return{id:0,DATA:{},EPISODES:{}}},getChildContext:function(){return{id:Number(this.props.DATA.SHOW_ID),name:"show_page"}},render:function(){var e={header:!1,infiniteScroll:this.props.EPISODES.data.length>100,toolbar:!1};return s.createElement(r,{type:"talkShow",items:this.props.EPISODES.data,options:e})}});t.exports=i},{"@deezer/components/common/DataGrid":92,react:"react"}],272:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("jquery"),n=e("../core/genre"),o=n.FILTER_TALK,l=e("@deezer/components/common/grid/Grid"),c=e("@deezer/components/common/GenreList/GenreList"),p={initialized:!1,template:"naboo/talk",tab:"genres",default_genre:0,genre_id:0,parent_genre_id:0,data:[],pagination:{start:0,nb:20,max:500},loading:!1,init:function(){try{return p.initialized?!1:(templating.load(p.template),p.genre_id=storage.isset("talk_explore_genre")?storage.get("talk_explore_genre"):p.genre_id,p.parent_genre_id=storage.isset("talk_explore_parent_genre")?storage.get("talk_explore_parent_genre"):p.parent_genre_id,p.pagination.start=0,p.initialized=!0,p.data=[],!0)}catch(e){error.log(e)}},display:function(e){try{gatekeeper.isAllowed("talk")||(document.location.href=document.location.protocol+"//"+SETTING_HOST+"/"),p.init();var t=e.id||p.genre_id;return p.load(t,null,!0),naboo.afterLoad(!0),!0}catch(a){error.log(a)}},load:function(e,t){try{if(p.loading===!0)return!1;p.loading=!0,e=e||0;var a=p.genre_id;p.genre_id=Number(e),t="undefined"!=typeof t&&t?i.extend(p.pagination,t):i.extend({},p.pagination),a!==e&&(t=i.extend(p.pagination,t,{start:0}));var s="/shows";0!==e&&(s+="/"+p.tab+"/"+e),i.address.value(s),api.call("deezer.pageTalkExplore",{FILTER:e,START:t.start,NB:t.nb},p.loadCallback)}catch(r){error.log(r)}},loadCallback:function(e){try{p.loading=!1,0===p.pagination.start&&(p.pagination.max=e.EXPLORE_SHOWS.total),storage.set("talk_explore_genre",p.genre_id),storage.set("talk_explore_parent_genre",p.parent_genre_id);var t=document.getElementById("selectbox_talk_genres");t&&r.render(s.createElement(c,{onSelect:p.onChangeGenre,selectedId:p.genre_id,type:o}),t),p.renderGenresReleases(e),Events.trigger(Events.navigation.page_updated)}catch(a){error.log(a)}},renderGenresReleases:function(e){try{var t=document.getElementById("talk_last_releases_grid");if(!t||"undefined"==typeof e||"undefined"==typeof e.EXPLORE_SHOWS)return!1;p.data=p.data.length?p.data.concat(e.EXPLORE_SHOWS.data):e.EXPLORE_SHOWS.data;var a={data:p.data,context:"show_page",options:["name","favorite","play_link"]};return r.render(s.createElement(l,a),t,p.activeInfiniteScroll),!0}catch(i){error.log(i)}},activeInfiniteScroll:function(){return p.pagination.start+p.pagination.nb>=p.pagination.max?(infinite_scroll.disable(),!1):(Events.subscribe(Events.layout.infiniteScroll,function(){p.load(p.genre_id,{start:p.pagination.start+p.pagination.nb,nb:p.pagination.nb})},"talk"),void infinite_scroll.active())},onChangeGenre:function(e){try{return e.GENRE_ID===p.genre_id?!1:("undefined"!=typeof e.PARENT_GENRE_ID?p.parent_genre_id=e.PARENT_GENRE_ID:p.parent_genre_id=0,p.data=[],p.pagination.start=0,p.load(e.GENRE_ID),!0)}catch(t){error.log(t)}},leave:function(){p.data=[];var e=document.getElementById("talk_last_releases_grid"),t=document.getElementById("selectbox_talk_genres");e&&r.unmountComponentAtNode(e),t&&r.unmountComponentAtNode(t)}};t.exports=p},{"../core/genre":244,"@deezer/components/common/GenreList/GenreList":121,"@deezer/components/common/grid/Grid":134,jquery:"jquery",react:"react","react-dom":"react-dom"}],269:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("../components/common/grid/Grid"),n={display:function(e){var t=document.getElementById("related_content_top");if(!t||"undefined"==typeof e.album_list||0===countObject(e.album_list))return!1;for(var a=[],n=0;n<e.album_list.length;n++)right.checkSongAvailable(e.album_list[n])===right.READABLE&&a.push(e.album_list[n]);var o={data:a,type:"album",context:"track_page",options:["name","artist"]};return r.render(s.createElement(i,o),t),Events.trigger(Events.navigation.tab_displayed,e),!0},leave:function(){var e=document.getElementById("related_content_top");e&&r.unmountComponentAtNode(e)}};t.exports=n},{"../components/common/grid/Grid":134,react:"react","react-dom":"react-dom"}],268:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("../components/common/grid/Grid"),n={id:0,type:0,destroy:function(){o.data=[],o.start=0;var e=document.getElementById("naboo_related_playlist_list");e&&r.unmountComponentAtNode(e)},display:function(e){try{return n.id=e.id,n.type=e.type,"undefined"!=typeof e.start&&(o.start=e.start),api.call({method:n.type+"_getRelatedPlaylist",data:{id:n.id,start:o.start,nb:o.nb},success:o.displayCallback}),!0}catch(t){error.log(t)}},onDisplay:function(){o.activeInfiniteScroll()}},o={start:0,nb:15,loadComplete:!1,data:[],displayCallback:function(e){try{var t=document.getElementById("naboo_related_playlist_list");if(!t)return;o.loadComplete=e.total<=parseInt(o.start+o.nb,10),o.data.length?o.data=o.data.concat(e.data):o.data=e.data;var a={data:o.data,type:"playlist",context:n.type+"_similar_playlist",tab:"related_playlists",options:["name","fans","tracks","play_link"]};return r.render(s.createElement(i,a),t,o.activeInfiniteScroll),Events.trigger(Events.navigation.tab_displayed,{type:"related_playlist",id:n.id}),!0}catch(l){error.log(l)}},activeInfiniteScroll:function(){return o.loadComplete?(infinite_scroll.disable(),!1):(Events.subscribeOnce(Events.layout.infiniteScroll,function(){infinite_scroll.disable(),n.display({id:n.id,type:n.type,start:o.start+o.nb})},"related_playlist"),void infinite_scroll.active())}};t.exports=n},{"../components/common/grid/Grid":134,react:"react","react-dom":"react-dom"}],267:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("../components/common/grid/Grid"),n={art_id:0,start:0,nb:15,loadComplete:!1,data:[],display:function(e){try{n.art_id=e.art_id,"undefined"!=typeof e.start&&(n.start=e.start);var t={art_id:n.art_id,start:n.start,nb:n.nb};return api.call("artist.getRelated",t,n.displayCallback),!0}catch(a){error.log(a)}},displayCallback:function(e){try{var t=document.getElementById("naboo_related_list");if(!t)return;n.loadComplete=e.total<=parseInt(n.start+n.nb,10),n.data.length?n.data=n.data.concat(e.data):n.data=e.data;var a={data:n.data,type:"artist",context:"artist_page",tab:"related_artists",options:["name","fans","favorite"]};return r.render(s.createElement(i,a),t,n.activeInfiniteScroll),Events.trigger(Events.navigation.tab_displayed,{type:"related",id:n.art_id}),!0}catch(o){error.log(o)}},onDisplay:function(){n.activeInfiniteScroll()},activeInfiniteScroll:function(){return n.loadComplete?(infinite_scroll.disable(),!1):(Events.subscribeOnce(Events.layout.infiniteScroll,function(){infinite_scroll.disable(),n.display({art_id:n.art_id,start:n.start+n.nb})},"related"),void infinite_scroll.active())},destroy:function(){n.data=[],n.start=0;var e=document.getElementById("naboo_related_list");e&&r.unmountComponentAtNode(e)}};t.exports=n},{"../components/common/grid/Grid":134,react:"react","react-dom":"react-dom"}],266:[function(e,t,a){"use strict";var s,r=e("react"),i=e("react-dom"),n=e("../components/radio/Page"),o={display:function(e){s=document.getElementById("naboo_content"),s&&i.render(r.createElement(n,e),s)},leave:function(){s&&i.unmountComponentAtNode(s)}};t.exports=o},{"../components/radio/Page":204,react:"react","react-dom":"react-dom"}],204:[function(e,t,a){"use strict";var s=e("react"),r=e("../../core/i18n"),i=r.gettext,n=e("../common/Thumbnail"),o=e("../common/grid/Grid"),l=e("../common/StatesButton"),c=s.createClass({displayName:"Page",propTypes:{id:s.PropTypes.string,type:s.PropTypes.string,data:s.PropTypes.object},getInitialState:function(){return{id:this._getRadioId(),type:this._getRadioType(),filled:!1,items:[],itemsType:"genre",itemsFull:!1,highlight:this.props.data?this.props.data.DATA:null,start:0,nb:20}},componentWillMount:function(){this._loadGenreList(),null===this.state.highlight&&null!==this.state.type&&null!==this.state.id&&this._loadSelectedRadio(this.state.type,this.state.id)},componentDidMount:function(){Events.subscribe(Events.radio.start,this._playRadioStart,"radio"),naboo.afterLoad(!0)},componentWillUnmount:function(){Events.unsubscribe(Events.radio.start,this._playRadioStart),Events.unsubscribe(Events.layout.infiniteScroll,this._subscribeInfiniteScroll)},render:function(){return s.createElement("div",{id:"page_radio"},s.createElement("div",{className:"wrapper"},s.createElement("h1",{className:"heading-1"},i("Mix")),s.createElement("h2",{className:"heading-4"},i("Vos chansons préférées et nos recommandations, le tout dans un mix thématique.")),this._renderHighlighted(),this._renderList()))},_renderHighlighted:function(){return null===this.state.highlight?null:s.createElement("div",{className:"radio-highlighted clearfix"},"artist"===this.state.type?this._renderHighlightedArtistDetails():this._renderHighlightedRadioDetails())},_renderHighlightedArtistDetails:function(){return this._renderHighlightedDetails({id:this.state.highlight.ART_ID,type:"artist",radio:!0,cover:"artist",context:"smartradio_page",title:this.state.highlight.ART_NAME,pic:this.state.highlight.ART_PICTURE,description:this.state.highlight.DESCRIPTION,shareType:"smartradio"})},_renderHighlightedRadioDetails:function(){return this._renderHighlightedDetails({id:this.state.highlight.RADIO_ID,type:"radio",radio:!1,cover:"misc",context:"radio_page",title:this.state.highlight.TITLE,pic:this.state.highlight.RADIO_PICTURE,description:this.state.highlight.DESCRIPTION,shareType:"radio"})},_renderHighlightedDetails:function(e){return[s.createElement(n,{key:"thumbnail_"+e.type+"_"+e.id,id:Number(e.id),type:e.type,radio:!0,width:210,height:210,height_img:250,width_img:250,play:!0,play_force:!0,overlay_force:!0,picture_type:e.cover,context:e.context,md5:e.pic,context_menu:e}),s.createElement("div",{key:"detail",className:"radio-detail"},s.createElement("div",{className:"radio-detail-heading"},i("À l'écoute :")),s.createElement("h2",{className:"heading-2"},e.title),"genre"===this.state.type?s.createElement("p",{className:"radio-description"},e.description):null,s.createElement("div",{className:"radio-detail-btn"},s.createElement(l,{key:"states_button_"+e.type+"_"+e.id,id:Number(e.id),type:e.type,action:"favorite"}),s.createElement("button",{"data-link":"0","data-share":"1","data-type":e.shareType,"data-id":e.id,type:"button",className:"btn btn-default evt-click"},s.createElement("span",{className:"icon icon-share"}),s.createElement("span",{className:"label"},i("Partager")))))]},_renderList:function(){return this.state.filled===!1?null:s.createElement(o,{data:this.state.items,context:"radio_page"})},_getRadioId:function(){return null!==this.props.id||dzPlayer.playerLoaded===!1||"radio"!==dzPlayer.getPlayerType()||"artist"!==dzPlayer.getRadioType()&&"radio"!==dzPlayer.getRadioType()?this.props.id:dzPlayer.getContext("ID")},_getRadioType:function(){return null!==this.props.type||dzPlayer.playerLoaded===!1||"radio"!==dzPlayer.getPlayerType()||"artist"!==dzPlayer.getRadioType()&&"radio"!==dzPlayer.getRadioType()?this.props.type:"radio"===dzPlayer.getRadioType()?"genre":"artist"},_loadGenreList:function(){infinite_scroll.disable(),api.call("radio.getSortedList",{START:this.state.start,NB:this.state.nb},function(e,t){this.isMounted()&&this._loadCallbackList(e,t)}.bind(this),"genre")},_loadCallbackList:function(e,t){var a;a=e.total>this.state.start+this.state.nb?!1:!0,this.setState({filled:!0,items:this.state.items.concat(e.data),itemsType:t,itemsFull:a},function(){a||(Events.subscribe(Events.layout.infiniteScroll,this._subscribeInfiniteScroll,"radio"),infinite_scroll.active())}),Events.trigger(Events.navigation.page_updated)},_subscribeInfiniteScroll:function(){Events.unsubscribe(Events.layout.infiniteScroll,this._subscribeInfiniteScroll),this.setState({start:this.state.start+this.state.nb},this._loadGenreList)},_loadSelectedRadio:function(e,t){api.call("deezer.pageRadio",{id:t,type:e},function(a){this.isMounted()&&(this.setState({id:t,type:e,highlight:a.DATA}),www.setCurrentPath("mixes/"+e+"/"+t))}.bind(this))},_playRadioStart:function(e,t){""!==t.type&&0!==t.id&&this._loadSelectedRadio("radio"===t.type?"genre":"artist",t.id)}});t.exports=c},{"../../core/i18n":245,"../common/StatesButton":127,"../common/Thumbnail":130,"../common/grid/Grid":134,react:"react"}],265:[function(e,t,a){"use strict";function s(e,t){switch(e){case"albums":return c("album","albums",{count:t});case"playlists":return c("playlist","playlists",{count:t});case"artists":return c("artiste favori","artistes favoris",{count:t});case"radios":return c("mix favori","mix favoris",{count:t});case"following":return l("following");case"followers":return c("follower","followers",{count:t});case"shows":return c("podcast","podcasts",{count:t});default:return""}}var r=e("react"),i=e("react-dom"),n=e("@deezer/components/common/DataGrid"),o=e("../core/i18n"),l=o.gettext,c=o.ngettext,p=e("@deezer/components/common/DataGrid/utils"),d=p.getSort,u=40,h=2e3,m={initialized:!1,events:!1,id:0,tab:"",data:null,data_tab:{},cache:{},coverSize:{"default":{width:250,height:250},artists:{width:250,height:320}},removeItem:{},templates:{artists:"artist",albums:"album",tracks:"track",playlists:"playlist",shows:"show",followers:"user",following:"user",radios:"radio_genre"},trad:{profile_home:l("C'est ici que vous retrouverez toute votre musique."),profile_playlists_public:l("Conseillez-lui une de vos playlists."),profile_albums_public:l("Conseillez-lui un de vos albums préférés."),profile_artists_public:l("Conseillez-lui un de vos artistes favoris."),profile_shows_public:l("Conseillez-lui un de vos shows préférés."),profile_radios_public:l("Conseillez-lui un de vos mix préférés."),profile_followers_public:l("Aucun follower."),profile_following_public:l("Aucun following."),profile_private:l("Ce profil est privé."),profile_deactivate:l("Ce profil a été supprimé."),profile_playlists:l("Découvrez vite À écouter, notre fil de recommandations musicales !"),profile_playlists_personal:l("Qu'attendez-vous pour créer votre première playlist ?"),profile_albums:l("Aucun résultat."),profile_artists:l("Aucun résultat."),profile_radios:l("Aucun résultat."),profile_shows:l("Aucun résultat."),profile_loved:l("Vous aimez une chanson ? Ajoutez-la à vos coups de cœur en cliquant sur le cœur du player "),profile_personal_song:l("Vous n'avez pas encore téléchargé vos propres MP3 ?"),profile_history:l("Découvrez vite À écouter, notre fil de recommandations musicales !")},emptyTrad:{top_tracks:l("Aucun Top Titres"),top_albums:l("Aucun Top Albums"),top_artists:l("Aucun Top Artistes")},init:function(){try{if(m.initialized)return!1;templating.load("naboo/profile/index"),templating.load("naboo/profile/header",$("#page_profile_header")),Events.subscribe(Events.navigation.page_displayed,m.resizeMenu,"profile"),Events.subscribe(Events.user.blockFriend,m.changeBlockStatus,"profile"),Events.subscribe(Events.user.unblockFriend,m.changeBlockStatus,"profile"),Events.subscribe(Events.user.addFavorite,m.favoriteAdded,"profile"),Events.subscribe(Events.user.deleteFavorite,m.favoriteRemoved,"profile"),Events.subscribe(Events.playlist.removed,m.favoriteRemoved,"profile"),Events.subscribe(Events.layout.resize,m.resizeMenu,"profile"),Events.subscribe(Events.menu.resize,m.resizeMenu,"profile"),Events.subscribe(Events.playlist.created,m.addPlaylist,"profile"),Events.subscribe(Events.layout.adsBackground,m.displayAds,"profile"),Events.subscribe(Events.user.updatePicture,m.updateAvatar,"profile"),Events.subscribe(Events.user.uploadPicture,function(){$("#profile_avatar_upload").click()},"profile"),Events.subscribe(Events.player.play,m.displayOnlineTrack,"profile"),Events.subscribe(Events.player.finish,m.displayOnlineTrack,"profile"),Events.subscribe(Events.datagrid.removedTrack,function(){m.data.TAB[m.tab].total--,m.drawDatagridTabTitle()},"profile"),m.drawHeader(),m.drawMenu(),m.initialized=!0}catch(e){error.log(e)}},leave:function(){var e=document.querySelector("section > .datagrid");e&&i.unmountComponentAtNode(e),m.data=null,m.id=0},display:function(e){try{return"string"!=typeof e.user_id?!1:(m.id=e.user_id,m.id="me"===m.id?USER.USER_ID:parseInt(m.id,10),m.tab=e.tab||"home",$("body").unbind("mouseup",m.toggleMoreMenu),"object"!=typeof e.data||m.isSorted()?(api.call("deezer.pageProfile",{user_id:m.id,tab:m.tab,nb:m.isSorted()?h:u},m.displayCallback),!0):m.displayCallback(e.data))}catch(t){error.log(t)}},onPageChanged:function(e){return m.tab=e.tab||"home","undefined"!=typeof m.data.TAB[m.tab]?(m.displayCallback(),!0):(api.call("deezer.pageProfile",{user_id:m.id,tab:m.tab,nb:m.isSorted()?h:u},m.displayCallback),!0)},displayCallback:function(e){try{if(null===m.data?(m.data=e,"home"===m.tab&&(m.data.TAB={home:e.TAB}),m.init()):e&&("home"===m.tab?m.data.TAB[m.tab]=e.TAB:(m.data.TAB[m.tab]=e.TAB[m.tab],m.data.TAB[m.tab+"_suggest"]=e.TAB[m.tab+"_suggest"],"object"==typeof e.TAB["top_"+m.tab]&&(m.data.TAB["top_"+m.tab]=e.TAB["top_"+m.tab]))),m.drawAllCoverProgress=!1,m.tab=m.data.DATA.IS_PUBLIC||m.data.DATA.IS_PERSONNAL?m.tab:"private",m.tab="2"===m.data.DATA.USER.ACTIVATION?"deactivate":m.tab,"deactivate"===m.tab||"private"===m.tab){var t="deactivate"===m.tab?"nocontent":m.tab;$("#profile_page_tab").html(placeholder.draw({wording:m.trad["profile_"+m.tab],picture:t}))}else{var a=document.querySelector("section > .datagrid");a&&i.unmountComponentAtNode(a),templating.load("naboo/profile/"+m.tab,$("#profile_page_tab"))}switch(m.currentTab=$("#profile_page_tab"),m.currentList=$("#profile_page_"+m.tab),m.currentPage=$("#page_profile"),m.updateMenu(),infinite_scroll.disable(),m.tab){case"loved":case"personal_song":case"history":case"downloads":m.drawDatagridTab();break;case"albums":case"artists":case"playlists":case"shows":case"radios":case"followers":case"following":m.drawCoverTab();break;case"home":m.drawHomeTab();break;default:naboo.afterLoad(!0)}}catch(s){error.log(s)}},displayOnlineTrack:function(e,t){return m.data.DATA.IS_PERSONNAL&&"home"===m.tab?void m.drawOnlineTrack(t.value):!1},drawOnlineTrack:function(e){try{var t=$("#profile_page_online"),a=$("#profile_page_infos");if("undefined"==typeof e||m.data.DATA.IS_PERSONNAL&&null===dzPlayer.getCurrentSong()||e.SNG_ID<0)return t.remove(),!0;$('span > [data-target="onair-song"]',t).prop("href","/album/"+e.ALB_ID).text(e.SNG_TITLE),$('span > [data-target="onair-artist"]',t).prop("href","/artist/"+e.ART_ID).text(e.ART_NAME),t.show(),a.fadeIn()}catch(s){error.log(s)}},drawCoverTab:function(){try{var e=m.data.TAB;m.inputSearch=$("#naboo_datagrid_filter_text");var t=window.debounce(function(){m.search(m.tab,$(this))},400);switch(m.inputSearch.on("keyup focus",t),m.deleteSearch=$("#search-cross"),m.deleteSearch.on("click",function(){return m.inputSearch.val().length?(m.cleanSearch(),void m.search(m.tab,m.inputSearch)):!1}),m.tab){case"playlists":gatekeeper.isAllowed("curator_feature")&&m.id===USER.USER_ID?$("#profile_page_playlists_curator",m.currentTab).show().on("click",function(){modal.open("/lightbox/curators/edit_playlist/"+USER.USER_ID)}):$("#profile_page_playlists_curator",m.currentTab).remove(),$('section [data-target="filter-playlist"] > button',m.currentTab).on("click",function(){m.filterPlaylist($(this).data("type"))}),$("#profile_page_playlist_selectbox").createSelectbox({data:[{NAME:l("Mises à jour récemment"),ID:1},{NAME:l("Ajoutées récemment"),ID:7},{NAME:l("A - Z"),ID:0},{NAME:l("Les plus écoutées"),ID:5}],align:"right",callback:function(e){m.sort("playlists",e)}}),m.data.top_playlist_hash={};for(var a=0;a<e.top_playlists.total;a++)m.data.top_playlist_hash[e.top_playlists.data[a].PLAYLIST_ID]=a;e.playlists=m.filterDisplayPlaylist(e.playlists),e.playlists.data.sort(m.sortByDate);break;case"albums":$("#profile_page_album_selectbox").createSelectbox({data:[{NAME:l("Ajoutés récemment"),ID:1},{NAME:l("A - Z (artiste)"),ID:4},{NAME:l("A - Z (album)"),ID:3},{NAME:l("Les plus écoutés"),ID:6}],align:"right",callback:function(e){m.sort("albums",e)}}),m.data.top_album_hash={};for(var a=0;a<e.top_albums.total;a++)m.data.top_album_hash[e.top_albums.data[a].ALB_ID]=a;e.albums.data.sort(m.sortByDate);break;case"shows":$("#profile_page_show_selectbox").createSelectbox({data:[{NAME:l("A - Z"),ID:8},{NAME:l("Non lus"),ID:9}],align:"right",callback:function(e){m.sort("shows",e)}}),gatekeeper.isAllowed("latest_episodes")&&(e.shows.data.length>0?($("#episodes-link").text(l("Derniers épisodes disponibles")),$("#naboo_episodes_image").replaceWith(thumbnails.draw({id:0,type:"episodes",cover_type:"misc",pic_id:"ab63361d54955f5f6494fd1b258b336a",border:!0,width:200,height:200,context_menu_hide:!0}))):$("#profile_page_episodes").hide()),e.shows.data.sort(m.sortByShowName);break;case"artists":$("#profile_page_artist_selectbox").createSelectbox({data:[{NAME:l("Ajoutés récemment"),ID:1},{NAME:l("A - Z"),ID:2}],align:"right",callback:function(e){m.sort("artists",e)}}),e.artists.data.sort(m.sortByDate)}e[m.tab].total<5&&m.data.DATA.IS_PERSONNAL?($('[data-target="suggest-contener"]',m.currentTab).show(),$('[data-target="action"]',m.currentTab).children().hide(),m.drawSuggest(m.tab,$("#profile_page_"+m.tab+"_empty"),e[m.tab+"_suggest"]),0===e[m.tab].total&&"playlists"!==m.tab&&$("#profile_page_"+m.tab).parent().hide(),"playlists"===m.tab&&$('[data-target="action"] > div:last',m.currentTab).show()):0!=e[m.tab].total||m.data.DATA.IS_PERSONNAL||($('[data-target="suggest-contener"]',m.currentTab).hide(),$('[data-target="action"]',m.currentTab).hide(),$('section[data-target="empty-message-public"]',m.currentTab).html(placeholder.draw({picture:"recommendation",wording:m.trad["profile_"+m.tab+"_public"]})),m.currentList.parent().hide()),m.drawCoverTabTitle(),m.currentTab.removeClass("full").addClass("user-empty"),m.appendCover(m.currentList,m.tab,e[m.tab].data,0,u),naboo.afterLoad(!0)}catch(s){error.log(s)}},drawCoverTabTitle:function(e){var t;try{if(e=e||"tab","tab"===e)t=m.data.TAB[m.tab].total,$("h2",m.currentTab).html('<span class="color-primary">'+breakUpThousands(t)+"</span> "+s(m.tab,t));else{var a=$('h2[data-target="title-'+e+'"]',m.currentTab);t=a.data("total"),a.html('<span class="color-primary">'+breakUpThousands(t)+"</span> "+s(e,t)),t>0&&a.wrapInner($("<a>",{"class":"link-gray-light evt-click",href:"/profile/"+m.id+"/"+e}))}}catch(r){error.log(r)}},appendCover:function(e,t,a,s,r){try{var i=Handlebars.templates["common_"+m.templates[t]],n={data:a.slice(s,s+r),play_context:"profile_"+t,profile_id:m.id};m.data.DATA.IS_PERSONNAL||(n.button_favorite=!0,n.USER_ID=USER.USER_ID.toString()),"playlist"===m.templates[t]&&(n.create_playlist=m.data.DATA.IS_PERSONNAL&&0===m.currentList.children().length),0===USER.USER_ID&&i?e.append(i(n)).data("start",s+r):i&&Events.ready(Events.user.userReady,function(){e.append(i(n)).data("start",s+r)}),setTimeout(function(){m.createCoverPaneTab(e)},1),m.tabIsAllDisplay()?Events.trigger(Events.profile.allCoverLoaded,{status:!0}):(Events.trigger(Events.profile.allCoverLoaded,{status:!1}),Events.subscribe(Events.layout.infiniteScroll,m.scrollCover,"profile"),infinite_scroll.active()),"playlists"===t&&null!=m.currentList.data("filter")&&"all"!==m.currentList.data("filter")&&m.filterPlaylist(m.currentList.data("filter")),Events.trigger(Events.navigation.page_updated)}catch(o){error.log(o)}},createCoverPaneTab:function(e){try{var t=e.responsiveCover_update();if(t===!1){var a=m.getCoverSize(m.tab);e.responsiveCover({cover_width:a.width,cover_height:a.height,gap:15})}return!0}catch(s){error.log(s)}},drawAllCover:function(e){try{if(m.tabIsAllDisplay())return m.currentList.responsiveCover_update(),!1;if(m.drawAllCoverProgress)return!1;Events.subscribeOnce(Events.profile.allCoverLoaded,function(t,a){m.drawAllCoverProgress=!1,a.status===!0?"function"==typeof e&&e():m.drawAllCover(e)}),m.drawAllCoverProgress=!0,infinite_scroll.disable();var t=m.currentList.data("start");return m.appendCover(m.currentList,m.tab,m.data.TAB[m.tab].data,t,u),!0}catch(a){error.log(a)}},scrollCover:function(){try{if(infinite_scroll.disable(),"personal_song"===m.tab)return;m.appendCover(m.currentList,m.tab,m.data.TAB[m.tab].data,m.currentList.data("start"),u)}catch(e){error.log(e)}},drawDatagridTab:function(){try{var e=m.data.TAB;"undefined"==typeof e[m.tab]&&(e[m.tab]={total:0,count:0,data:[]}),m.data.DATA.IS_PERSONNAL&&m.drawPlaceholder(e[m.tab].total),m.currentTab.removeClass("user-empty").addClass("full"),m.drawDatagridTabTitle();var t={type:m.tab,id:m.id,playlist_personnal:!1,songs:{total:e[m.tab].total,count:e[m.tab].count,data:e[m.tab].data.slice(0)}};switch(m.tab){case"loved":m.data.DATA.IS_PERSONNAL&&$.extend(t,{type:"lovedpersonal",playlist_personnal:!0,offline_data:{playlist_checksum:e.loved.checksum,playlist_picture:"87fc4422c7138e9fe33205ae5707d93f",playlist_picture_type:"playlist"}});break;case"personal_song":Modernizr.draganddrop||$("#profile_mp3_drop").hide(),$("#profile_mp3_upload").fileupload({multipart:!0,dropZone:$("#profile_mp3_drop"),sequentialUploads:!0,add:function(e,t){var a=/^audio\/(mp3|mpeg)$/i;return""!=t.originalFiles[0].type&&a.test(t.originalFiles[0].type)?void t.submit():!1},send:function(e,t){m.currentUploadSong={name:t.files[0].name.substring(0,t.files[0].name.length-4),size:t.files[0].size},Events.trigger(Events.user.sendPersonalSong,[m.currentUploadSong.size,m.currentUploadSong.name]),t.url=SETTING_HOST_UPLOAD+"/?sid="+SESSION_ID+"&resize=1&directory=&type=audio&referer="+SETTING_REFERER_UPLOAD+"&file="+m.currentUploadSong.name+"&"},done:function(e,t){Events.trigger(Events.user.addPersonalSong,-t.result.results),m.data.TAB.personal_song.total++,m.drawDatagridTabTitle()},progressall:function(e,t){var a=parseInt(t.loaded/t.total*100,10);Events.trigger(Events.user.progressPersonalSong,[m.currentUploadSong.size,m.currentUploadSong.name,a])}})}var a=m.tab;switch(a){}var s=document.querySelector("section > .datagrid");s&&i.render(r.createElement(n.FullPage,{id:m.id,type:a,items:e[m.tab].data}),s),Events.unsubscribe(Events.layout.infiniteScroll,m.scrollCover),naboo.afterLoad(!0)}catch(o){error.log(o)}},drawDatagridTabTitle:function(){try{var e=m.data.TAB[m.tab].total,t=breakUpThousands(e),a='<span class="color-primary">'+t+"</span> "+c("titre","titres",{count:e});$("h2",m.currentTab).html(a)}catch(s){error.log(s)}},drawHomeTab:function(){try{var e=m.data.TAB.home;m.$page_message=$("#profile_page_message"),""!==e.message||m.data.DATA.IS_PERSONNAL?(m.$page_message_display_inner=$("#profile_page_message_display").find("> span").text(e.message),m.$page_message_button=$("#profile_page_message_button"),m.data.DATA.IS_PERSONNAL===!1&&m.$page_message_display_inner.html(m.$page_message_display_inner.html().convertURLToLink()),m.data.DATA.IS_PERSONNAL?(m.$page_message_display=$("#profile_page_message_display"),m.$page_message_edit=$("#profile_page_message_edit"),m.$page_message_placeholder=$("#profile_page_message_placeholder"),""==e.message&&m.$page_message_placeholder.show(),m.$page_message.addClass("user-message-cursor"),m.$page_message.on("click","#profile_page_message_display, #profile_page_message_placeholder",function(){m.startEditMessage()}),m.$page_message_edit.on("blur",function(){m.endEditMessage()}).on("keydown",function(e){13==e.keyCode&&$(this).blur()}),m.$page_message_button.data("tooltipFallback",l("Cliquez ici pour éditer")).on("click",function(){m.startEditMessage()})):(m.$page_message_button.remove(),""==e.message&&m.$page_message.remove())):m.$page_message.remove(),m.drawOnlineTrack(e.online);var t=$("#profile_page_infos");0===t.children().length&&t.remove(),$("#profile_page_tops_nav > div > button").on("click",function(){m.drawTops($(this).data("type"))}),$('#profile_page_tops_nav > div > [data-type="tracks"]').addClass("active"),m.drawTops(m.data.DATA.IS_PERSONNAL?"albums":"artists");var a=["playlists","albums","artists","followers","following"];for(var r in a)if(a.hasOwnProperty(r)){var i=$("#profile_page_home_"+a[r]),n=e[a[r]].total;if("playlists"===a[r]&&(m.data.DATA.IS_PERSONNAL&&5>n&&($('[data-target="no-empty"]',i).remove(),$('section [data-target="create-playlist"]',m.currentTab).show().on("click",function(){menu.dispatchAction("openCreatePlaylist")})),e.playlists=m.filterDisplayPlaylist(e.playlists),e.playlists.data.sort(m.sortByDate),n=e.playlists.total),5>n&&m.data.DATA.IS_PERSONNAL){if(0===n&&"followers"===a[r]){i.remove();continue}$('[data-target="no-empty"]',i).remove(),$('[data-target="line"]',i).remove(),m.drawSuggest(a[r],$('[data-target="suggest"]',i),e[a[r]+"_suggest"]),0===n&&$('[data-target="contener"]',i).parent().addClass("user-thumbnail-empty")}else 0==n&&$('[data-target="no-empty"]',i).remove(),$('[data-target="suggest-contener"]',i).remove();var o=Handlebars.templates["common_"+m.templates[a[r]]],c=m.getCoverSize(a[r]),p={data:e[a[r]].data,play_context:"profile_"+a[r],profile_id:m.id};m.data.DATA.IS_PERSONNAL||(p.button_favorite=!0,p.USER_ID=USER.USER_ID.toString()),"playlist"===m.templates[a[r]]&&(p.create_playlist=m.data.DATA.IS_PERSONNAL),$('[data-target="contener"]',i).html(o(p)).responsiveCover({cover_width:c.width,cover_height:c.height,gap:15,max_line:1}),$('[data-target="no-empty"]',i).children("a").attr("href","/profile/"+m.id+"/"+a[r]);var d=$('[data-target="title-'+a[r]+'"]',i);d.html('<span class="color-primary">'+breakUpThousands(n)+"</span> "+s(a[r],n)+'<span class="icon icon-arrow-right"></span>').data("total",n),n>0&&d.wrapInner($("<a>",{"class":"evt-click",href:"/profile/"+m.id+"/"+a[r]}))}naboo.afterLoad(!0)}catch(r){error.log(r)}},drawTops:function(e){try{$("#profile_page_tops_nav > div > button").removeClass("active"),$('#profile_page_tops_nav > div > [data-type="'+e+'"]').addClass("active");var t=m.getCoverSize(e),a=m.data.TAB.home;if(0==a.top_track.total&&0==a.top_album.total&&0==a.top_artist.total)return $("#profile_page_tops").hide(),!1;var s="";if(a.top_track.total>0&&"tracks"===e&&(s=a.top_track),a.top_album.total>0&&"albums"===e&&(s=a.top_album),a.top_artist.total>0&&"artists"===e&&(s=$.extend({},a.top_artist)),""!==s){s.play_context="profile_top_"+e,m.data.DATA.IS_PERSONNAL||(s=$.extend({},s,{button_favorite:USER.USER_ID>0}));var r=Handlebars.templates["common_"+m.templates[e]];$('#profile_page_tops > [data-target="top-empty"]').hide(),$("#profile_page_tops_content").html(r(s)).responsiveCover({cover_width:t.width,cover_height:t.height,gap:15,max_line:1}),Events.trigger(Events.navigation.page_updated)}else $('#profile_page_tops > [data-target="top-empty"]').text(m.emptyTrad[e]).show(),$("#profile_page_tops_content").responsiveCover_destroy()}catch(i){error.log(i)}},drawHeader:function(){try{m.header=$('#page_profile_header [data-target="header"]'),m.fixNav=$(".navbar",m.header),1==m.data.DATA.IS_PUBLIC?(m.drawFollowerNumber(),m.data.DATA.IS_PERSONNAL&&($('[data-target="avatar-button"]',m.header).show(),$('[data-target="header-type"]',m.header).addClass("header-personnal"),$("#profile_avatar_upload").fileupload({multipart:!0,dropZone:$('[data-target="avatar-button"]',m.header),add:function(e,t){var a=/^image\/(gif|jpe?g|png)$/i;return""!=t.originalFiles[0].type&&a.test(t.originalFiles[0].type)?void t.submit():!1},send:function(e,t){var a=t.files[0].name.substring(0,t.files[0].name.length-4);t.url=SETTING_HOST_UPLOAD+"/?sid="+SESSION_ID+"&resize=1&directory=user&type=picture&referer="+SETTING_REFERER_UPLOAD+"&file="+a+"&"},done:function(e,t){0===t.result.error.length&&(m.drawAvatar(t.result.results),Events.trigger(Events.user.updatePicture,{md5:t.result.results}))}})),m.data.DATA.CURATOR!==!1&&""!==m.data.DATA.CURATOR.COUNTRY_NAME&&(m.data.DATA.IS_PERSONNAL&&$('[data-target="header-type"]',m.header).addClass("header-edito"),$('[data-target="curator"]',m.header).show().append(m.data.DATA.CURATOR.COUNTRY_NAME).children(".flag").addClass("flag-"+m.data.DATA.CURATOR.DEFAULT_COUNTRY.toLowerCase()))):"2"==m.data.DATA.USER.ACTIVATION?(m.fixNav.remove(),$('[data-target="header-type"]',m.header).addClass("header-deactivate")):(m.fixNav.remove(),$('[data-target="header-type"]',m.header).addClass("header-private")),m.drawAvatar(m.data.DATA.USER.USER_PICTURE),m.drawBanner(m.data.DATA.USER.TOP_TRACK),$('[data-target="name"]',m.header).text(m.data.DATA.USER.DISPLAY_NAME).prop("href","/profile/"+m.id).prop("title",m.data.DATA.USER.DISPLAY_NAME),$('[data-target="blocked-wording"]',m.header).text(l("BLOQUÉ")),m.data.DATA.HAS_BLOCKED&&$('[data-target="blocked-status"]',m.header).addClass("user-blocked"),"2"!=m.data.DATA.USER.ACTIVATION&&(m.data.DATA.IS_PERSONNAL||$('[data-target="follow"]',m.header).replaceWith(button_multi_state.draw({id:m.id,action:"favorite",type:"friend",wording:"full",color:"shadow-flow"})),$('[data-target="flow"]',m.header).replaceWith(button_multi_state.draw({id:m.id,action:"play",type:"user",wording:"full",color:"primary-flow",color_equalizer:"dark",play_context:"profile_user_radio",radio:!0,tracking:1,tracking_tag:"flow_click",tracking_params:"{'type': 'flow', 'instance': '"+(m.data.DATA.IS_PERSONNAL?"collection":"profile")+"'}"})),m.drawDropdown())}catch(e){error.log(e)}},drawDropdown:function(){try{$('[data-target="dropdown"]',m.header).html(thumbnails.draw({id:m.id,type:"user",cover_type:"empty",href_type:!1,cover_link:!1,responsive:!0,blocked:m.data.DATA.HAS_BLOCKED?"1":"0"}))}catch(e){error.log(e)}},updateAvatar:function(e,t){try{if(!m.data.DATA.IS_PERSONNAL)return;m.data.DATA.USER.USER_PICTURE=t.md5,m.drawAvatar(t.md5),m.drawDropdown()}catch(a){error.log(a)}},drawBanner:function(e){try{var t=SETTING_STATIC+"/images/naboo/pages/profile/private-v"+STATIC_VERSION+".jpg";return""!==e.ALB_PICTURE&&(t=SETTING_DOMAIN_IMG+"/cover/"+e.ALB_PICTURE+"/250x1200-000000-80-0-0.jpg"),$('[data-target="header-type"]',m.header).css("background-image","url("+t+")"),!0}catch(a){error.log(a)}},drawAvatar:function(e){try{$('[data-target="avatar"]',m.header).html(thumbnails.draw({id:m.id,type:"user",cover_type:"user",pic_id:e,border:!1,shadow:!1,size:"120x120",width:120,height:120,context_menu_hide:!0}))}catch(t){error.log(t)}},drawFollowerNumber:function(){try{var e=m.data.DATA.NB_FOLLOWING,t=m.data.DATA.NB_FOLLOWER,a="<strong>"+breakUpThousands(e)+"</strong> "+l("Following"),s="<strong>"+breakUpThousands(t)+"</strong> "+c("Follower","Followers",{count:t});$('[data-target="follower"]',m.header).html(s).prop("href","/profile/"+m.id+"/followers"),$('[data-target="following"]',m.header).html(a).prop("href","/profile/"+m.id+"/following")}catch(r){error.log(r)}},drawMenu:function(){try{m.menu=$('[data-target="menu"]',m.header),m.more=$('[data-target="more"]',m.header),m.data.DATA.IS_PUBLIC||(m.menu.remove(),m.more.remove()),m.menu.children().each(function(){$(this).is(".dropdown")?($(this).on("click",m.toggleMoreMenu),$(this).on("mouseup",function(){return!1}),m.more.on("mousedown",function(){return $("body").unbind("mouseup",m.toggleMoreMenu),!1})):$(this).data("public")||m.data.DATA.IS_PERSONNAL?$(this).data({width:$(this).outerWidth(!0),"user-id":m.id}).attr("href","/profile/"+m.id+"/"+$(this).data("tab")):$(this).remove()}),Events.ready(Events.user.dataStoreReady,function(){0===countObject(userData.dataStore)&&($('[data-tab="downloads"]',m.menu).remove(),$('[data-tab="downloads"]',m.more).remove(),m.resizeMenu())}),m.data.DATA.IS_PERSONNAL&&Events.ready(Events.user.userReady,function(){var e=userData.getUnseenPlaylistCount();e>0&&(e>=100&&(e="99+"),m.menu.find('[data-tab="playlists"] a').prepend('<span class="badge badge-info">'+e+"</span>"))}),m.resizeMenu()}catch(e){error.log(e)}},toggleMoreMenu:function(e){try{e.preventDefault();var t=m.more.closest(".dropdown");t.hasClass("opened")?(t.removeClass("opened"),$("body").unbind("mouseup",m.toggleMoreMenu)):(t.addClass("opened"),$("body").trigger("mouseup"),$("body").bind("mouseup",m.toggleMoreMenu))}catch(e){error.log(e)}},updateMenu:function(){try{m.menu.children().removeClass("active"),m.menu.children('[data-tab="'+m.tab+'"]').addClass("active")}catch(e){error.log(e)}},resizeMenu:function(){var e;try{"undefined"!=typeof m.menu&&m.menu.children("li").last().show(),m.more.hasClass("opened")&&m.toggleMoreMenu();var t=m.getTabsMenuWidth();if(m.fixNav.width()<t)return e=m.menu.children("li[data-tab]").last().clone(!0),m.menu.children("li[data-tab]").last().remove(),m.more.prepend(e),m.resizeMenu(),!0;var a=m.more.children().children().length,s=m.more.children().first().data("width"),r=a>1&&m.fixNav.width()>t+s,i=1===a&&m.fixNav.width()>s+t-m.more.parent().outerWidth();return r||i?(e=m.more.children().first().clone(!0),m.more.children().first().remove(),e.insertBefore(m.menu.children("li").last()),a>1?m.resizeMenu():m.menu.children("li").last().hide(),!0):(0===a&&m.menu.children("li").last().hide(),!1)}catch(n){error.log(n)}},getTabsMenuWidth:function(){try{var e=0;return m.menu.children("li").each(function(){e+=$(this).outerWidth(!0)}),e}catch(t){error.log(t)}},startEditMessage:function(){try{m.$page_message.parent().addClass("active"),m.$page_message_display.hide(),m.$page_message_button.hide(),m.$page_message_edit.val(m.data.TAB.message).show().focus(),m.$page_message_placeholder.hide()}catch(e){error.log(e)}},endEditMessage:function(){try{var e=m.$page_message_edit.val().trim();e!=m.data.TAB.message&&api.call("user.update",{USER_DATA:{DESCRIPTION:e}},function(){m.data.TAB.message=e}),m.$page_message_display.show().children("span").text(e),m.$page_message.parent().removeClass("active"),m.$page_message_button.show(),m.$page_message_edit.hide(),""==e&&m.$page_message_placeholder.show()}catch(t){error.log(t)}},search:function(e,t){var a,s,r=$.trim(t.val()),i=$("> li",m.currentList);r&&!m.drawAllCoverProgress?(r=rewriting(r.toLowerCase()),m.deleteSearch.show(),i.each(function(){s=$(this).data("search").toString(),a=-1!==s.indexOf(r)?"show":"hide",$(this)[a]()}),m.drawPlaceholder()):(m.deleteSearch.hide(),m.drawAllCover(),i.show()),m.currentList.responsiveCover_update()},cleanSearch:function(){try{m.inputSearch.val("")}catch(e){error.log(e)}},filterPlaylist:function(e){try{$(" > li",m.currentList).show(),"all"!==e&&$('> [data-type!="'+e+'"]',m.currentList).hide(),m.currentList.data("filter",e);var t=m.currentList.children(":visible").length;$("h2",m.currentTab).html("<span>"+breakUpThousands(t)+"</span> "+s(m.tab,t)),m.drawPlaceholder(t),$('[data-target="filter-playlist"] > button',m.currentTab).removeClass("active"),$('[data-target="filter-playlist"] [data-type="'+e+'"]',m.currentTab).addClass("active"),m.cleanSearch(),m.drawAllCover(function(){m.filterPlaylist(e)})}catch(a){error.log(a)}},addPlaylist:function(e,t){try{m.data.DATA.IS_PERSONNAL&&api.call("playlist.getData",{PLAYLIST_ID:t.PLAYLIST_ID},function(e){if(e.DATE_ADD=timestampToDate(SERVER_TIMESTAMP,!0,"-",!0),"playlists"===m.tab&&(m.data.TAB[m.tab].data.unshift(e),m.data.TAB[m.tab].total++,m.appendCover(m.currentList,"playlists",[e],0,1),$("#profile_page_"+m.tab).parent().show()),"home"===m.tab){var t=$('h2[data-target="title-playlists"]',m.currentTab);t.data("total",t.data("total")+1),m.appendCover($("#profile_page_playlists",m.currentTab),"playlists",[e],0,1),m.drawCoverTabTitle("playlists"),$("#profile_page_playlists",m.currentTab).parent().removeClass("user-thumbnail-empty")}})}catch(a){error.log(a)}},drawPlaceholder:function(e){try{if(e=e||m.currentList.children(":visible").length,0===e){var t="personal_song"===m.tab?"none":"nocontent",a="profile_"+m.tab;"playlists"===m.tab&&(m.data.DATA.IS_PERSONNAL?"playlist"===m.currentList.data("filter")&&(a+="_personal"):(t="recommendation",a+="_public")),$('[data-target="place-holder"]',m.currentTab).html(placeholder.draw({wording:m.trad[a],picture:t}))}else $('[data-target="place-holder"]',m.currentTab).empty()}catch(s){error.log(s)}},drawSuggest:function(e,t,a){try{if("undefined"==typeof a||0===a.total||0===a.count)return t.parents(".user-section-suggestion").addClass("hide"),!1;Events.ready(Events.user.userReady,function(){for(var s={playlists:["playlist","PLAYLIST_ID"],artists:["artist","ART_ID"],albums:["album","ALB_ID"],following:["friend","USER_ID"],radios:["radio","RADIO_ID"],shows:["show","SHOW_ID"]},r=0;r<a.data.length;r++)userData.isFavorite(s[e][0],a.data[r][s[e][1]])&&(a.data.splice(r,1),a.count--,r--);if(a.count>0){t.parent().show();var i=m.getCoverSize(e),n=Handlebars.templates["common_"+m.templates[e]],o={data:a.data,button_favorite:!0,button_close:!0,play_context:"profile_"+e};t.html(n(o)).show(),t.responsiveCover({cover_width:i.width,cover_height:i.height,gap:15,max_line:1})}})}catch(s){error.log(s)}},changeBlockStatus:function(e,t){try{if(t.id!=m.id)return!1;"USER.blockFriend"==e.namespace?$('[data-target="blocked-status"]',m.header).addClass("user-blocked"):"USER.unblockFriend"==e.namespace&&$('[data-target="blocked-status"]',m.header).removeClass("user-blocked")}catch(a){error.log(a)}},favoriteAdded:function(e,t){try{if(m.id!=USER.USER_ID)return!1;switch(t.type){case"friend":if("home"!=m.tab)m.data.TAB[m.tab].data.unshift(t),m.data.TAB[m.tab].total++,m.appendCover(m.currentList,"following",m.data.TAB[m.tab].data,0,1),$("#profile_page_following").parent().show();else{var a=$('h2[data-target="title-following"]',m.currentTab);a.data("total",a.data("total")+1),m.appendCover($("#profile_page_following",m.currentTab),"following",[t],0,1),$("#profile_page_following",m.currentTab).parent().removeClass("user-thumbnail-empty")}m.drawCoverTabTitle("home"===m.tab?"following":null);var s=$("#profile_page_following_empty");$("#user_"+t.USER_ID,s).remove(),0==s.children().length&&s.parents('[data-target="suggest-contener"]').hide();break;case"album":case"artist":case"playlist":case"radio":case"show":var r=t.type+"s";if("undefined"!=typeof m.removeItem[t.id]){var i=$("#"+t.type+"_"+t.id);if($(".picture",i).css("opacity",1),"home"!=m.tab)m.data.TAB[m.tab].data.unshift(t),m.data.TAB[m.tab].total++;else{var a=$('h2[data-target="title-'+r+'"]',m.currentTab);a.data("total",a.data("total")+1)}return m.drawCoverTabTitle("home"===m.tab?r:null),clearTimeout(m.removeItem[t.id]),delete m.removeItem[m.removeItemId],!1}if("home"!=m.tab)m.data.TAB[m.tab].data.unshift(t),m.data.TAB[m.tab].total++,m.appendCover(m.currentList,r,[t],0,1),$("#profile_page_"+m.tab).parent().show();else{var a=$('h2[data-target="title-'+r+'"]',m.currentTab);a.data("total",a.data("total")+1),m.appendCover($("#profile_page_"+r,m.currentTab),r,[t],0,1),$("#profile_page_"+r,m.currentTab).parent().removeClass("user-thumbnail-empty")}m.drawCoverTabTitle("home"===m.tab?r:null);var s=$("#profile_page_"+r+"_empty");$("#"+t.type+"_"+t.id,s).remove(),0==s.children().length&&s.parents('[data-target="suggest-contener"]').hide();break;case"song":"loved"===m.tab&&(m.data.TAB.loved.total++,m.drawDatagridTabTitle())}}catch(n){error.log(n)}},favoriteRemoved:function(e,t){try{if(m.id!=USER.USER_ID)return!1;switch(t.type){case"friend":break;case"album":case"artist":case"playlist":case"radio":case"show":var a=t.type+"s";if("home"!=m.tab){var s={playlists:"PLAYLIST_ID",albums:"ALB_ID",artists:"ART_ID",radios:"RADIO_ID",shows:"SHOW_ID"};for(var r in m.data.TAB[m.tab].data)if(m.data.TAB[m.tab].data.hasOwnProperty(r)&&m.data.TAB[m.tab].data[r][s[m.tab]]==t.id){m.data.TAB[m.tab].data.splice(r,1),m.data.TAB[m.tab].total--,m.currentList.data("start",m.currentList.data("start")-1);break}}else{var i=$('h2[data-target="title-'+a+'"]',m.currentTab);i.data("total",i.data("total")-1)}m.drawCoverTabTitle("home"===m.tab?a:null);var n=$("#"+t.type+"_"+t.id);1===n.length&&($(".picture",n).css("opacity",.2),m.removeItem[t.id]=setTimeout(function(){1===$(".preview",n).length&&preview.stop(),n.remove(),delete m.removeItem[t.id],"home"===m.tab&&$("#profile_page_"+a,m.currentTab).responsiveCover_update()},5e3));break;case"song":if(m.data.TAB.loved)for(var r in m.data.TAB.loved.data)if(m.data.TAB.loved.data.hasOwnProperty(r)&&m.data.TAB.loved.data[r].SNG_ID==t.id){m.data.TAB.loved.data.splice(r,1),m.data.TAB.loved.count--,m.data.TAB.loved.total--,"loved"===m.tab&&m.drawDatagridTabTitle();break}}}catch(o){error.log(o)}},tabIsAllDisplay:function(){try{return"home"===m.tab?!0:!(m.currentList.data("start")<m.data.TAB[m.tab].total)}catch(e){error.log(e)}},sort:function(e,t){try{m.cleanSearch();var a=[m.sortByPlaylistTitle,m.sortByDate,m.sortByArtName,m.sortByAlbTitle,m.sortByArtNameAlbTitle,m.sortByPlaylistTop,m.sortByAlbumTop,m.sortByCreationDate,m.sortByShowName,m.sortByUnheard];m.data.TAB[e].data.sort(a[t.ID]),m.currentList.empty(),m.appendCover(m.currentList,m.tab,m.data.TAB[m.tab].data,0,u)}catch(s){error.log(s)}},displayAds:function(e,t){try{$("ul.thumbnail-grid",m.currentTab).each(function(){$(this).responsiveCover_update()}),m.resizeMenu()}catch(a){error.log(a)}},sortByPlaylistTitle:function(e,t){var a=e.TITLE.toLowerCase(),s=t.TITLE.toLowerCase();return a==s?0:a>s?1:-1},sortByDate:function(e,t){"undefined"==typeof e.DATE_ADD&&(e.DATE_ADD="0000-00-00 00:00:00"),"undefined"==typeof t.DATE_ADD&&(t.DATE_ADD="0000-00-00 00:00:00");var a=e.DATE_ADD,s=t.DATE_ADD;return a==s?0:s>a?1:-1},sortByCreationDate:function(e,t){var a=e.DATE_FAVORITE||e.DATE_CREATE||"0000-00-00 00:00:00",s=t.DATE_FAVORITE||t.DATE_CREATE||"0000-00-00 00:00:00";return a===s?0:s>a?1:-1},sortByArtName:function(e,t){var a=e.ART_NAME.toLowerCase(),s=t.ART_NAME.toLowerCase();return a===s?0:a>s?1:-1},sortByArtNameAlbTitle:function(e,t){var a=e.ART_NAME.toLowerCase()+" "+e.ALB_TITLE.toLowerCase(),s=t.ART_NAME.toLowerCase()+" "+t.ALB_TITLE.toLowerCase();return a===s?0:a>s?1:-1},sortByAlbTitle:function(e,t){var a=e.ALB_TITLE.toLowerCase(),s=t.ALB_TITLE.toLowerCase();return a===s?0:a>s?1:-1},sortByShowName:function(e,t){var a=e.SHOW_NAME.toLowerCase(),s=t.SHOW_NAME.toLowerCase();return a===s?0:a>s?1:-1},sortByUnheard:function(e,t){var a=bookmark.getEpisodeBookmark(e.LATEST_EPISODE.data[0].EPISODE_ID,e.LATEST_EPISODE.data[0].DURATION).IS_HEARD,s=bookmark.getEpisodeBookmark(t.LATEST_EPISODE.data[0].EPISODE_ID,t.LATEST_EPISODE.data[0].DURATION).IS_HEARD;return a===s?0:a>s?1:-1},sortByPlaylistTop:function(e,t){var a=m.data.top_playlist_hash,s="undefined"!=typeof a[e.PLAYLIST_ID]?1/(a[e.PLAYLIST_ID]+1):0,r="undefined"!=typeof a[t.PLAYLIST_ID]?1/(a[t.PLAYLIST_ID]+1):0;return s===r?m.sortByPlaylistTitle(e,t):r>s?1:-1},sortByAlbumTop:function(e,t){var a=m.data.top_album_hash,s="undefined"!=typeof a[e.ALB_ID]?1/(a[e.ALB_ID]+1):0,r="undefined"!=typeof a[t.ALB_ID]?1/(a[t.ALB_ID]+1):0;return s===r?m.sortByAlbTitle(e,t):r>s?1:-1},isSorted:function(){var e=d(m.id,m.tab),t=e.cell,a=e.order;return null!==t||"asc"!==a},getAdsArgs:function(){return{element_id:m.id,element_data:m.tab}},getCoverSize:function(e){try{return"undefined"!=typeof m.coverSize[e]?m.coverSize[e]:m.coverSize["default"]}catch(t){error.log(t)}},filterDisplayPlaylist:function(e){try{if(0===e.total)return e;for(var t=0,a=[],s=0;s<e.count;s++)4!=e.data[s].TYPE&&(1!=e.data[s].STATUS&&3!=e.data[s].STATUS||e.data[s].PARENT_USER_ID==USER.USER_ID)?a.push(e.data[s]):++t;return e.data=a,e.count-=t,e.total-=t,e}catch(r){error.log(r)}}};t.exports=m},{"../core/i18n":245,"@deezer/components/common/DataGrid":92,"@deezer/components/common/DataGrid/utils":110,react:"react","react-dom":"react-dom"}],264:[function(e,t,a){"use strict";var s=e("react-dom"),r=e("jquery"),i=e("../core/i18n"),n=i.gettext,o=i.ngettext,l=e("../core/modal"),c=e("../models/track"),p=e("@deezer/components/common/DataGrid/utils"),d=p.getSort,u=40,h=2e3,m={id:0,template:"catalog/playlist",style:null,personal:!1,display:function(e){try{if("string"!=typeof e.playlist_id)return!1;if(m.id=m.playlist_id=parseInt(e.playlist_id,10),"object"==typeof e.data&&(m.setStatus(e.data.DATA),!m.isSorted()))return Events.ready(Events.user.initialized,function(){m.displayCallback(e.data)}),!1;var t={playlist_id:m.id,lang:SETTING_LANG,start:0,nb:m.isSorted()?h:u,tags:!1};return api.call("deezer.pagePlaylist",t,m.displayCallback),!0}catch(a){error.log(a)}},displayCallback:function(e){try{if(e.SONGS.data=c.hydrate(e.SONGS.data),m.data=e.DATA,m.setStatus(e.DATA),templating.load(m.template),null==e.DATA.PLAYLIST_PICTURE||OFFLINE||(Events.subscribe(Events.playlist.updatePicture,function(e,t){"base64"!==t.type&&(m.data.PICTURE_TYPE=t.type,m.data.PLAYLIST_PICTURE=t.md5,m.displayPicture(t))},"playlist"),Events.subscribe(Events.playlist.uploadPicture,function(){r("#naboo_playlist_image_upload").click()},"playlist"),m.isPersonal&&m.uploadPicture()),m.displayEditableData(),null!=e.DATA.PARENT_USERNAME&&r("#naboo_playlist_information_creator").prop("href","/profile/"+e.DATA.PARENT_USER_ID).html(encodeHTMLEntities(e.DATA.PARENT_USERNAME)),!m.isPrivate){var t=r("#naboo_playlist_header");"number"==typeof e.DATA.NB_SONG&&r('[data-target="nb-track"]',t).append(o("Titre","Titres",{count:e.DATA.NB_SONG})).children("strong").text(e.DATA.NB_SONG),isNaN(e.DATA.DURATION)||r('[data-target="duration"] > strong',t).text(getTotalDuration(e.DATA.DURATION)),"number"==typeof e.DATA.NB_FAN&&e.DATA.NB_FAN>0?r('[data-target="nb-fan"] > a',t).append(o("Fan","Fans",{count:e.DATA.NB_FAN})).children("strong").text(breakUpThousands(e.DATA.NB_FAN)):r('[data-target="nb-fan"]',t).remove()}m.isPersonal||"undefined"==typeof e.DATA.PARENT_BLOCK||1!=e.DATA.PARENT_BLOCK||(r("#naboo_comment_new").remove(),r("#naboo_comment_new_not_logged").remove());var a={track_list:{selected:!0,args:{}}};m.isPrivate||(a.comment={args:{type:"playlist",id:m.id,data:e.COMMENTS}},a.fan={args:{type:"playlist",id:m.id}}),m.isPersonal&&gatekeeper.isAllowed("playlist_assistant")&&Events.subscribeOnce(Events.datagrid.displayed,function(){Events.trigger(Events.tips.draw,{name:"playlist_assistant",check:!0})},"playlist"),null!=e.SONGS.count&&(a.track_list.args={id:m.id,tab:"track_list",data:{type:"playlist",id:m.id,playlist_personnal:m.isPersonal,last_seen:e.DATA.LAST_SEEN,songs:e.SONGS,playlist_private:m.isPrivate,playlist_collab:m.isCollabStatus,checksum:e.DATA.CHECKSUM,offline_data:{playlist_name:e.DATA.TITLE,playlist_creator:e.DATA.PARENT_USERNAME,playlist_checksum:e.DATA.CHECKSUM,playlist_picture:e.DATA.PLAYLIST_PICTURE,playlist_picture_type:e.DATA.PICTURE_TYPE}}});var s=r("#naboo_playlist_action");return m.isPersonal?r('[data-target="edit"]',s).data("value",m.id).show():(r('[data-target="edit"]',s).remove(),Events.subscribe(Events.user.addFavorite,m.updateNbFan,"playlist"),Events.subscribe(Events.user.deleteFavorite,m.updateNbFan,"playlist")),r('[data-target="share"] > a',s).data("id",m.id),m.isPrivateStatus&&r('[data-target="share"] > a',s).remove(),0===USER.USER_ID||m.data.IS_FAVORITE||!m.isPersonal&&!m.isPrivateStatus?(r('[data-target="favorite"]',s).html(button_multi_state.draw({action:"favorite",id:m.id,type:"playlist",elId:"add_to_library"})),Events.subscribe(Events.playlist.trackListUpdated,m.trackListUpdateHandler,"playlist"),Events.subscribe(Events.datagrid.addedItems,function(e,t){m.trackListUpdateHandler(e,{tracks:t.items})},"playlist"),Events.trigger(Events.playlist.trackListUpdated,{tracks:e.SONGS.data})):(r('[data-target="favorite"]',s).remove(),m.isPrivate&&(r("#naboo_playlist_action").remove(),r("#naboo_playlist_type").addClass("extended"))),m.isPersonal?r('[data-target="favorite"]',s).remove():r('[data-target="favorite"]',s).html(button_multi_state.draw({action:"favorite",id:m.id,type:"playlist",elId:"add_to_library"})),tabs.init(r("#naboo_playlist_tab"),a),naboo.afterLoad(!0),!0}catch(i){error.log(i)}},trackListUpdateHandler:function(e,t){m.hasUnseenTracks(t.tracks)&&m.setSeen()},hasUnseenTracks:function(e){return m.data.LAST_SEEN?e.some(function(e){return e.isUnseen(m.data.LAST_SEEN)}):!1},setSeen:function(){Events.ready(Events.user.userReady,function(){api.call("playlist.setSeen",{playlist_id:m.id}),userData.setPlaylistSeen(m.id),Events.trigger(Events.playlist.seen)})},displayEditableData:function(){var e=0==m.data.STATUS||2==m.data.STATUS,t=2==m.data.STATUS||3==m.data.STATUS;r("#naboo_playlist_title").text(ucfirst(m.data.TITLE)),r("#naboo_playlist_status").text(n(e?"Publique":"Privée")),r("#naboo_playlist_collab").text(n(t?"Collaborative":"Non collaborative")),e?r('#naboo_playlist_action [data-target="share"] > a').show():r('#naboo_playlist_action [data-target="share"] > a').hide(),null!=m.data.DESCRIPTION&&r("#naboo_playlist_description").html(encodeHTMLEntities(m.data.DESCRIPTION).convertURLToLink()),m.displayPicture()},displayPicture:function(e,t){try{t=t||{md5:m.data.PLAYLIST_PICTURE,type:m.data.PICTURE_TYPE},r("#naboo_playlist_image").html(thumbnails.draw({id:m.id,type:"playlist",play_context:"playlist_page",cover_type:t.type,pic_id:m.isPrivate?"":t.md5,play:!m.isPrivate,border:!0,width:200,height:200,tracking:1,play_force:!0,sent_to_mobile_banner:!0,edit:r("#naboo_playlist_header").is(".headings-playlist-edit"),parent_user_id:m.data.PARENT_USER_ID,context_menu_excludes:["go_to_playlist"]}))}catch(a){error.log(a)}},editPlaylist:function(){try{return Events.subscribeOnce(Events.playlist.updated,function(e,t){m.data.TITLE=t.title,m.data.DESCRIPTION=t.description,m.data.STATUS=t.status,m.displayEditableData()},"playlist"),l.open("/lightbox/playlist_assistant?type=create&playlist_id="+m.id),!1}catch(e){error.log(e)}},uploadPicture:function(){try{r("#naboo_playlist_image_upload").fileupload({multipart:!0,add:function(e,t){var a=/^image\/(gif|jpe?g|png)$/i;return""!=t.originalFiles[0].type&&a.test(t.originalFiles[0].type)?void t.submit():!1},send:function(e,t){var a=t.files[0].name.substring(0,t.files[0].name.length-4);t.url=SETTING_HOST_UPLOAD+"/?sid="+SESSION_ID+"&id="+m.id+"&resize=1&directory=playlist&type=picture&referer="+SETTING_REFERER_UPLOAD+"&file="+a+"&"},done:function(e,t){0===t.result.error.length&&Events.trigger(Events.playlist.updatePicture,{md5:t.result.results,type:"playlist"})}})}catch(e){error.log(e)}},updateDurationAndNbSongs:function(e,t){try{m.data.DURATION=parseInt(m.data.DURATION,10)+parseInt(e,10),m.data.NB_SONG=parseInt(m.data.NB_SONG,10)+parseInt(t,10);var a=r("#naboo_playlist_header");"number"==typeof m.data.NB_SONG&&r('[data-target="nb-track"]',a).html("<strong>"+m.data.NB_SONG+"</strong>"+o("Titre","Titres",{count:m.data.NB_SONG})),isNaN(m.data.DURATION)||r('[data-target="duration"] > strong',a).text(getTotalDuration(m.data.DURATION))}catch(s){error.log(s)}},updateNbFan:function(e,t){return t.id!=m.data.PLAYLIST_ID?!1:("USER.addFavorite"===e.namespace?m.data.NB_FAN+=1:m.data.NB_FAN-=1,void r('#naboo_playlist_header [data-target="nb-fan"] > a').html(o("%s Fan","%s Fans",{count:m.data.NB_FAN,sprintf:["<strong>"+breakUpThousands(m.data.NB_FAN)+"</strong>"]})))},onOpenTab:function(e){tabs.display(e),r("#page_content").scrollTop(0)},leave:function(){delete m.data;var e=document.getElementById("tab_track_list_content");e&&s.unmountComponentAtNode(e)},isSorted:function(){var e=m.isPersonal||m.isCollabStatus?"personalPlaylist":"playlist",t=d(m.id,e),a=t.cell,s=t.order;return null!==a||"asc"!==s},setStatus:function(e){m.isPrivateStatus=1===Number(e.STATUS)||3===Number(e.STATUS),m.isPrivate=Number(e.PARENT_USER_ID)!==USER.USER_ID&&m.isPrivateStatus,m.isCollabStatus=2===Number(e.STATUS),m.isPersonal=Number(e.PARENT_USER_ID)===USER.USER_ID},getLiveFeed:function(){return"1_0_PLAYLISTFEED_"+m.id}};t.exports=m},{"../core/i18n":245,"../core/modal":247,"../models/track":252,"@deezer/components/common/DataGrid/utils":110,jquery:"jquery","react-dom":"react-dom"}],263:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("@deezer/components/Page"),n={id:0,display:function(e){var t=document.getElementById("naboo_content");if(t){var a="object"==typeof e&&e.data&&e.data.sections?e.data.sections:[],n=e&&e.type||"home";r.render(s.createElement(i,{sections:a,type:n}),t,function(){naboo.afterLoad(!0)})}},leave:function(){var e=document.getElementById("naboo_content");e&&r.unmountComponentAtNode(e)}};t.exports=n},{"@deezer/components/Page":31,react:"react","react-dom":"react-dom"}],262:[function(e,t,a){"use strict";var s,r=e("react"),i=e("react-dom"),n=e("@deezer/components/moods/Moods"),o={start:0,nb:25,max:0,data:[],container:"",genreId:0,genreIdDefault:0,display:function(e){return gatekeeper.isAllowed("moods")===!1?www.navigate("/"):(e.genre_id?o.genreId=Number(e.genre_id):o.genreId=storage.isset("moods_genre")?storage.get("moods_genre"):o.genreIdDefault,s=document.getElementById("naboo_content"),e.data?o.render(e):o.load(),void naboo.afterLoad(!0))},load:function(){www.setCurrentPath("/moods"+(o.genreId!==o.genreIdDefault?"/"+o.genreId:""),!0),0===o.start&&(o.data=[]),api.call({method:"deezer.pageMoods",data:{genre_id:o.genreId,type:"playlist",start:o.start,nb:o.nb},success:function(e){o.render({data:e})}})},render:function(e){if(s){o.max=e.data.ITEMS.total,o.data=o.data.concat(e.data.ITEMS.data);var t={items:o.data,genreId:o.genreId,onChangeGenre:o.onChangeGenre};i.render(r.createElement(n,t),s,o.activeInfiniteScroll)}},onChangeGenre:function(e){infinite_scroll.disable(),o.start=0,o.genreId=e,o.load(),storage.set("moods_genre",o.genreId)},activeInfiniteScroll:function(){return o.start+o.nb>=o.max?(infinite_scroll.disable(),!1):(Events.subscribeOnce(Events.layout.infiniteScroll,function(){infinite_scroll.disable(),o.start+=o.nb,o.load()},"moods"),void infinite_scroll.active())},leave:function(){s&&i.unmountComponentAtNode(s)}};t.exports=o},{"@deezer/components/moods/Moods":183,react:"react","react-dom":"react-dom"}],183:[function(e,t,a){"use strict";var s=e("react"),r=e("../../core/i18n"),i=r.gettext,n=e("../../core/genre"),o=n.FILTER_MOODS,l=e("@deezer/components/common/grid/Grid"),c=e("@deezer/components/common/GenreList/GenreList"),p=s.createClass({displayName:"Moods",propTypes:{items:s.PropTypes.array.isRequired,genreId:s.PropTypes.number,onChangeGenre:s.PropTypes.func},getDefaultProps:function(){return{genreId:0,onChangeGenre:function(){}}},getInitialState:function(){return{genreId:this.props.genreId}},render:function(){return s.createElement("div",null,s.createElement("div",{className:"wrapper"},s.createElement("div",{className:"naboo-searchbar clearfix",id:"naboo_tops_filters"},s.createElement("h1",{className:"heading-1"},i("Moods")),s.createElement("h2",{className:"heading-4"},i("Choisir une catégorie")),s.createElement("form",{className:"form-inline"},s.createElement("div",{className:"form-group"},s.createElement(c,{onSelect:this._onChangeGenre,selectedId:this.props.genreId,type:o})),this._renderEdit())),s.createElement("div",null,this._renderGrid())))},_renderGrid:function(){var e={type:"playlist",data:this.props.items,context:"moods",options:["name","artist","creator","sticker","favorite","play_link"]};return s.createElement(l,e)},_renderEdit:function(){return gatekeeper.isAllowed("curator_feature")?s.createElement("div",{className:"form-group"},s.createElement("a",{className:"btn btn-primary",href:"#",onClick:this._onClickEdit},s.createElement("span",{className:"label"},i("Organiser le Top Moods")))):null},_onChangeGenre:function(e){this.setState({genreId:e.GENRE_ID},function(){this.props.onChangeGenre(this.state.genreId)}.bind(this))},_onClickEdit:function(e){e.preventDefault();var t=modal.open("/lightbox/curators/edit_top_playlist/moods/"+USER.USER_ID);Events.subscribeOnce(Events.modal.close,function(e,a){t===a&&window.moods.load()},"moods")}});t.exports=p},{"../../core/genre":244,"../../core/i18n":245,"@deezer/components/common/GenreList/GenreList":121,"@deezer/components/common/grid/Grid":134,react:"react"}],261:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("../core/EventDispatcher"),n=e("../components/menu/Menu"),o=e("../components/menu/Panels"),l={PanelsComponent:null,initialized:!1,init:function(){return l.initialized?!1:(l.dispatchActionEvent=new i,l.subscribeActions(l.onAction),l.initialized=!0,!0)},authorized_actions:{openCreatePlaylist:!0},dispatchAction:function(e,t){return"undefined"==typeof l.authorized_actions[e]?!1:(l.dispatchActionEvent.trigger({action:e,params:t}),!0)},subscribeActions:function(e){l.dispatchActionEvent.subscribe(e)},onAction:function(e){switch(e.action){case"openCreatePlaylist":l.PanelsComponent.isPanelMounted("playlists")||Events.subscribe(Events.menu.panel_mounted,function(e,t){"playlists"===t&&l.dispatchAction("openCreatePlaylist")}),Events.trigger(Events.menu.openPanel,"playlists")}return!0},load:function(){l.init(),l.MenuComponent=r.render(s.createElement(n,null),document.getElementById("page_sidebar")),l.PanelsComponent=r.render(s.createElement(o,null),document.getElementById("page_panels"))},dispatchNotification:function(){},dispatchApplicationNotification:function(){},autoScroll:function(){},setCurrentApplication:function(){return!1},openElement:function(){return!1},openFolder:function(){return!1},adjustUserMenu:function(){},selectItem:function(){return!0},displayCover:function(){},updateCover:function(){},getSidebarWidth:function(){},getPositionItem:function(e){e=e||"page_sidebar";var t=document.getElementById(e),a=document.getElementById("page_sidebar"),s=0,r=0;if(t&&a){var i=t.getBoundingClientRect(),n=a.getBoundingClientRect();s=Math.round(parseInt(n.width,10)+20),r=Math.round(parseInt(i.top,10)-parseInt(i.height,10)/2)}return{pos_x:s,pos_y:r}}};t.exports=l},{"../components/menu/Menu":150,"../components/menu/Panels":151,"../core/EventDispatcher":239,react:"react","react-dom":"react-dom"}],151:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("react-addons-pure-render-mixin"),n=e("./panels/SearchSuggest"),o=e("./panels/SearchHistory"),l=e("./panels/Playlists"),c=e("./panels/Albums"),p=e("./panels/Shows"),d=e("./panels/Apps"),u=e("./panels/QueueList"),h=e("./panels/Settings"),m=e("./panels/Lyrics"),_=s.createClass({displayName:"Panels",mixins:[i],getInitialState:function(){return{openPanelName:null,opened:!1}},childContextTypes:{getTrackingParams:s.PropTypes.func},getChildContext:function(){return{getTrackingParams:this.getTrackingParams}},componentWillMount:function(){Events.subscribe(Events.menu.panel_mounted,this._onPanelMounted)},componentDidMount:function(){Events.subscribe(Events.menu.closeAllPanels,this._onClosePanels),Events.subscribe(Events.menu.openPanel,this._onOpenPanel)},componentWillUnmount:function(){Events.unsubscribe(Events.menu.closeAllPanels,this._onClosePanels),Events.unsubscribe(Events.menu.openPanel,this._onOpenPanel),Events.unsubscribe(Events.menu.panel_mounted,this._onPanelMounted)},getTrackingParams:function(){return{panel:this.state.openPanelName}},isPanelMounted:function(e){return"undefined"!=typeof this._panels_mounted[e]},render:function(){this._initPanel(this.state.openPanelName);var e={"panel-wrapper":!0};this.state.openPanelName&&(e["panel-wrapper-"+this.state.openPanelName]=!0);var t=r(e),a=r({"panel-container":!0,opened:this.state.opened});return s.createElement("div",{className:a,"aria-hidden":this.state.displayed,style:this.state.displayed?{display:"block"}:{}},s.createElement("div",{className:t},this._isPanelInitialized("searchhistory")?s.createElement(o,{ref:"searchhistory",selected:this.state.openPanelName}):null,this._isPanelInitialized("searchsuggest")?s.createElement(n,{ref:"searchsuggest",selected:this.state.openPanelName}):null,this._isPanelInitialized("playlists")?s.createElement(l,{ref:"playlists",selected:this.state.openPanelName}):null,this._isPanelInitialized("albums")?s.createElement(c,{ref:"albums",selected:this.state.openPanelName}):null,this._isPanelInitialized("shows")?s.createElement(p,{ref:"shows",selected:this.state.openPanelName}):null,this._isPanelInitialized("apps")?s.createElement(d,{ref:"apps",selected:this.state.openPanelName}):null,this._isPanelInitialized("queuelist")?s.createElement(u,{ref:"queuelist",selected:this.state.openPanelName}):null,this._isPanelInitialized("settings")?s.createElement(h,{ref:"settings",selected:this.state.openPanelName}):null,this._isPanelInitialized("lyrics")?s.createElement(m,{ref:"lyrics",selected:this.state.openPanelName,displayed:this.state.displayed}):null),s.createElement("div",{className:"panel-overlay",onClick:this._onOverlayClick}))},_onPanelMounted:function(e,t){this._panels_mounted[t]=!0},_onOverlayClick:function(){Events.trigger(Events.menu.closeAllPanels)},_onClosePanels:function(){this.setState({opened:!1},function(){window.setTimeout(function(){this.setState({displayed:!1,openPanelName:null})}.bind(this),150)})},_onOpenPanel:function(e,t){this.setState({openPanelName:t,displayed:!0},function(){"lyrics"===t&&dzPlayer.control.play(),window.setTimeout(function(){this.setState({opened:!0},function(){this.refs[t].openPanel()}.bind(this))}.bind(this),0)})},_panels_initialized:{},_panels_mounted:{},_initPanel:function(e){"undefined"==typeof this._panels_initialized[e]&&(this._panels_initialized[e]=!0)},_isPanelInitialized:function(e){return"undefined"!=typeof this._panels_initialized[e]}});t.exports=_},{"./panels/Albums":153,"./panels/Apps":154,"./panels/Lyrics":155,"./panels/Playlists":156,"./panels/QueueList":157,"./panels/SearchHistory":158,"./panels/SearchSuggest":159,"./panels/Settings":160,"./panels/Shows":161,classnames:"classnames",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],161:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=r.ngettext,o=e("../../common/Selectbox"),l=e("../../common/list_items/Show"),c=e("../../_mixins/sort"),p=e("../../_mixins/panel"),d=e("../../_mixins/panelScroll"),u=s.createClass({displayName:"Shows",mixins:[p,d,c],panel_name:"shows",scrollbar:{ref:"nano",shouldUpdate:function(e){return this.state.list.length!==e.list.length}},getInitialState:function(){return{list:userData.data.FAVORITES_SHOWS.data.slice(0),sort_type:USER.SETTING.site.sort_panel_shows||"SHOW_NAME",nb_display:50,filter:""}},componentDidMount:function(){Events.subscribe(Events.user.addFavorite,function(e,t){"show"===t.type&&this.setState({list:userData.data.FAVORITES_SHOWS.data.slice(0)})}.bind(this),"panel_show"),Events.subscribe(Events.user.deleteFavorite,function(e,t){"show"===t.type&&this.setState({list:userData.data.FAVORITES_SHOWS.data.slice(0)})}.bind(this),"panel_show"),this.scrollbar_onEnd(this._displayMore),this.subscribeOnOpen(function(){this.setState({filter:""})}.bind(this))},componentWillUnmount:function(){Events.unsubscribeAll("panel_show")},shouldComponentUpdate:function(e,t){return e.selected!==this.props.selected||t.sort_type!==this.state.sort_type||t.nb_display!==this.state.nb_display||t.filter!==this.state.filter||t.list.length!==this.state.list.length},render:function(){return this._refreshCurrentList(),this.renderPanel(s.createElement("div",{className:"panel-shows"},s.createElement("div",{className:"panel-header"},this._renderTitle(),this.state.list.length?this._renderActions():null),this.renderScrollbar({"panel-body":!0},[this._renderContent()])))},_current_list:[],_display_more_enabled:!0,_displayMore:function(){return this._display_more_enabled===!1||this.state.nb_display>this._current_list.length?!1:(this._display_more_enabled=!1,this.setState({nb_display:this.state.nb_display+50},function(){this._display_more_enabled=!0}),!0)},_onSortTypeChange:function(e){this.setState({sort_type:e})},_onFilterChange:function(e){this.setState({filter:e.target.value},this.refreshScrollbar)},_renderTitle:function(){var e=this.state.list.length;return 0===e?s.createElement("h1",{className:"panel-heading heading-2"},s.createElement("span",{className:"color-primary"},breakUpThousands(e))," "+n("show","shows",{count:e})):s.createElement("h1",{className:"panel-heading heading-2"},s.createElement("a",{href:"/profile/"+USER.USER_ID+"/shows",className:"evt-click"},s.createElement("span",{className:"color-primary"},breakUpThousands(e))," "+n("show","shows",{count:e}),s.createElement("span",{className:"icon icon-arrow-right"})))},_renderActions:function(){return s.createElement("div",{className:"action form-inline"},s.createElement("div",{className:"form-group"},s.createElement("input",{className:"form-control input-small empty-filter",type:"text",onChange:this._onFilterChange,placeholder:i("Filtrer"),value:this.state.filter})),this.state.list.length>0?s.createElement("div",{className:"form-group"},s.createElement(o,{type:"show",onChange:this._onSortTypeChange})):"")},_renderContent:function(){return s.createElement("ul",{className:"nano-card-list",key:"show-list"},this._current_list.map(function(e,t){var a=$.extend({},e);return s.createElement(l,{data:a,key:"show_"+e.SHOW_ID+t,display_favorite:!1,display_add:!0,context:"menu_panel_show"})}))},_refreshCurrentList:function(){var e=this.sort(this.state.list,this.state.sort_type),t=this.state.filter.toLowerCase().trim();""!==t&&(e=e.filter(function(e){return e.SHOW_NAME.toLowerCase().indexOf(t)>-1})),e=e.slice(0,this.state.nb_display),this._current_list=e}});t.exports=u},{"../../../core/i18n":245,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/sort":43,"../../common/Selectbox":126,"../../common/list_items/Show":148,react:"react"}],160:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("classnames"),n=e("react-addons-pure-render-mixin"),o=e("../../../core/i18n"),l=o.gettext,c=e("../../../core/modal"),p=e("../../_mixins/tracking"),d=e("../../_mixins/panel"),u=e("../../_mixins/panelScroll"),h=s.createClass({displayName:"Settings",mixins:[d,u,p,n],panel_name:"settings",scrollbar:{ref:"nano",shouldUpdate:function(){}},getInitialState:function(){return{hq:dzPlayer.isHq(),fade:dzPlayer.fade}},componentDidMount:function(){Events.subscribe(Events.player.hq,function(e,t){this.setState({hq:t})}.bind(this),"player"),Events.subscribe(Events.player.fade,function(e,t){this.setState({fade:t})}.bind(this),"player");var e=this;r(this.refs.fade).draggable({axis:"x",containment:"parent",drag:function(t,a){e.setState({fade:e._getCursorFade(t,a)})},stop:function(t,a){dzPlayer.control.changeFadeValue(e._getCursorFade(t,a))}})},render:function(){var e=i({"nano-card-link settings-hq":!0,checked:this.state.hq}),t=i({"nano-card-link is-kid":!0,checked:user.getMultiAccountOptions().IS_KID});return this.renderPanel(s.createElement("div",{className:"panel-settings"},this.renderScrollbar({"panel-body":!0},s.createElement("div",null,s.createElement("h2",{className:"panel-heading-sub heading-4 heading-bordered"},l("Compte")),s.createElement("ul",{className:"nano-card-list"},s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/account",onClick:this._onLinkClick,"data-type":"account"},s.createElement("span",{className:"icon icon-rounded icon-user"}),s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l("Paramètres"))),user.getMultiAccountOptions().ENABLED||user.getMultiAccountOptions().CHILD_COUNT?s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/lightbox/multi_account/switch",onClick:this._onLinkClick,"data-type":"family_switch","data-modal":"/lightbox/multi_account/switch"},s.createElement("span",{className:"icon icon-rounded icon-family"}),s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l(user.getMultiAccountOptions().CHILD_COUNT?"Changer de profil":"Nouveau profil"))):null,s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/support",target:"_blank",onClick:this._onLinkClick,"data-type":"support"},s.createElement("span",{className:"icon icon-rounded icon-help"}),s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l("Assistance"))),user.getMultiAccountOptions().PARENT?null:s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/gift",target:"_blank",onClick:this._onLinkClick,"data-type":"gift_code"},s.createElement("span",{className:"icon icon-rounded icon-barcode"}),s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l("Activer un code"))),user.getMultiAccountOptions().PARENT?s.createElement("li",{className:t,onClick:this._setKidStatus,"data-type":"is_kid"},s.createElement("input",{className:"checkbox-input pull-right",id:"is_kid",type:"checkbox"}),s.createElement("label",{className:"checkbox-label heading-4",htmlFor:"is_kid"},l("Enfant ?"))):null),s.createElement("h2",{className:"panel-heading-sub heading-4 heading-bordered"},l("Audio")),s.createElement("ul",{className:"nano-card-list"},s.createElement("li",{className:e,onClick:this._setHq,"data-type":"audio_hq"},s.createElement("input",{className:"checkbox-input pull-right",id:"audio_hq",type:"checkbox"}),s.createElement("label",{className:"checkbox-label heading-4",htmlFor:"audio_hq"},l("Haute Qualité"))),s.createElement("li",{className:"nano-card-link"},s.createElement("span",{className:"heading-4"},s.createElement("span",{className:"slider pull-right"},s.createElement("span",{className:"slider-label"},Math.round(10*this.state.fade)),s.createElement("span",{className:"slider-bar",ref:"fade_bar",onClick:this._setFade},s.createElement("span",{className:"slider-bar-active",style:{width:100*this.state.fade+"%"}}),s.createElement("span",{className:"slider-bar-handler",style:{left:100*this.state.fade+"%"},ref:"fade"})),s.createElement("span",{className:"slider-label"},"10")),l("Fondu sonore")))),s.createElement("h2",{className:"panel-heading-sub heading-4 heading-bordered"},l("Découvrir Deezer")),s.createElement("ul",{className:"nano-card-list"},s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/offers",target:"_blank",onClick:this._onLinkClick,"data-type":"offers"},s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l("Offres"))),s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/company",target:"_blank",onClick:this._onLinkClick,"data-type":"company"},s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l("À propos"))),s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/features",target:"_blank",onClick:this._onLinkClick,"data-type":"features"},s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l("Fonctionnalités"))),s.createElement("li",{className:"nano-card-link"},s.createElement("a",{className:"heading-4",href:"/jobs",target:"_blank",onClick:this._onLinkClick,"data-type":"jobs"},s.createElement("span",{className:"icon icon-arrow-right pull-right"}),l("Jobs")))),s.createElement("div",{className:"btn-logout"},s.createElement("button",{className:"btn btn-danger btn-block",type:"button",onClick:this._logout,"data-type":"log_out"},s.createElement("span",{className:"label"},l("Déconnexion"))))))))},_getCursorFade:function(e,t){var a=t.position.left/(e.target.parentNode.offsetWidth-5);return a=Math.min(a,1),a=Math.max(a,0)},_logout:function(){user.logout()},_setHq:function(e){e.preventDefault(),"undefined"!=typeof USER&&USER.OPTIONS.web_hq?dzPlayer.control.setHq(!this.state.hq):(window.open("/offers"),Events.trigger(Events.menu.closeAllPanels))},_setFade:function(e){var t=(e.pageX-r(e.target).offset().left)/this.refs.fade_bar.offsetWidth;dzPlayer.control.changeFadeValue(t)},_setKidStatus:function(){window.user.setKidStatus()},_onLinkClick:function(e){var t=e.currentTarget.getAttribute("href"),a=e.currentTarget.getAttribute("target"),s=dom.dataset(e.currentTarget,"modal");if(this.tracking("panel_click",e.currentTarget),Events.trigger(Events.menu.closeAllPanels),"_blank"!==a){if(e.preventDefault(),e.stopPropagation(),"string"==typeof s)return c.open(s);if("string"==typeof t)return loadBox(t)}}});t.exports=h},{"../../../core/i18n":245,"../../../core/modal":247,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/tracking":45,classnames:"classnames",jquery:"jquery",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],159:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=r.ngettext,o=e("../../../naboo/stores/SearchStore"),l=e("../../common/TagList"),c=e("./_elements/History"),p=e("../../common/list_items/Artist"),d=e("../../common/list_items/Album"),u=e("../../common/list_items/Track"),h=e("../../common/list_items/Playlist"),m=e("../../common/list_items/Show"),_=e("../../_mixins/tracking"),y=e("../../_mixins/panel"),g=e("../../_mixins/panelScroll"),f=s.createClass({displayName:"SearchSuggest",mixins:[y,g,_],panel_name:"searchsuggest",getDefaultProps:function(){return{isAuthUser:0!==window.USER.USER_ID}},getInitialState:function(){return{suggest:o.getResults(),history:userData.data.SEARCH_HISTORY?userData.data.SEARCH_HISTORY.data:[]}},scrollbar:{ref:"nano",shouldUpdate:function(e){return e.suggest!==this.state.suggest}},componentDidMount:function(){o.onChange(this._onSearchStoreChange),Events.subscribe(Events.user.updateSearchHistory,this._onHistoryChange)},componentWillUnmount:function(){o.offChange(this._onSearchStoreChange),Events.unsubscribe(Events.user.updateSearchHistory,this._onHistoryChange)},render:function(){return this.renderPanel(s.createElement("div",{className:"panel-search-suggest"},s.createElement("div",{className:"panel-header panel-header-link",onClick:this._onViewAllClick.bind(null,"all")},s.createElement("h1",{className:"panel-heading heading-2"},i("Résultats")),this._isSuggestEmpty()?"":s.createElement("div",{className:"action"},s.createElement("span",{className:"icon icon-arrow-right"}))),this.renderScrollbar({"panel-body":!0},s.createElement("div",null,this._renderContent()))))},_onSearchStoreChange:function(e){"suggest"===e&&this.setState({suggest:o.getResults()})},_isSuggestEmpty:function(){return null===this.state.suggest||0===this.state.suggest.ARTIST.length&&0===this.state.suggest.ALBUM.length&&0===this.state.suggest.TRACK.length&&0===this.state.suggest.PLAYLIST.length&&0===this.state.suggest.SHOW.length},_renderPlaceholder:function(){return s.createElement("div",{key:"no-result-placeholder"},s.createElement("div",{className:"placeholders-img nocontent"}),s.createElement("div",{className:"placeholders-title"},i("Aucun résultat.")))},_renderContent:function(){var e=[];if(this._isSuggestEmpty()){e.push(this._renderPlaceholder());var t=userData.data.USER_TAGS?userData.data.USER_TAGS.data:null;return t&&t.length&&(e.push(s.createElement("h2",{key:"user-tag-title",className:"panel-heading-sub heading-4 heading-bordered"},i("Tags"))),e.push(s.createElement(l,{key:"user-tag-list",tags:t}))),this.state.history.length&&(e.push(s.createElement("h2",{key:"history-title",className:"panel-heading-sub heading-4 heading-bordered"},i("Dernières recherches"))),e.push(s.createElement(c,{key:"history-list",history:this.state.history}))),e}e.push(s.createElement(l,{key:"tag-list",max:5,tags:this.state.suggest.TAG}));var a={ARTIST:{title:n("Artiste","Artistes",{count:this.state.suggest.ARTIST.length}),view_more_wording:i("Afficher tous les artistes"),data:this.state.suggest.ARTIST},ALBUM:{title:n("Album","Albums",{count:this.state.suggest.ALBUM.length}),view_more_wording:i("Afficher tous les albums"),data:this.state.suggest.ALBUM},TRACK:{title:n("Titre","Titres",{count:this.state.suggest.TRACK.length}),view_more_wording:i("Afficher tous les titres"),data:this.state.suggest.TRACK},PLAYLIST:{title:n("Playlist","Playlists",{count:this.state.suggest.PLAYLIST.length}),view_more_wording:i("Afficher toutes les playlists"),data:this.state.suggest.PLAYLIST},SHOW:{title:n("Podcast","Podcasts",{count:this.state.suggest.SHOW.length}),view_more_wording:i("Afficher tous les podcasts"),data:this.state.suggest.SHOW}};for(var r in a)if(a.hasOwnProperty(r)){var o,_,y=a[r].data,g=Math.min(y.length,2);if(y.length){_=[];for(var f=0;g>f;f++)switch(o=y[f],r){case"ARTIST":_.push(s.createElement(p,{data:o,key:"suggest_artist_"+o.ART_ID,display_add:!0,index:f,onClick:this._onSuggestionClick,context:"suggest_artist"}));break;case"ALBUM":_.push(s.createElement(d,{data:o,key:"suggest_album_"+o.ALB_ID,display_add:!0,index:f,onClick:this._onSuggestionClick,context:"suggest_album"}));break;case"TRACK":_.push(s.createElement(u,{data:o,key:"suggest_track_"+o.SNG_ID,display_add:!0,index:f,onClick:this._onSuggestionClick,context:"suggest_track"}));break;case"PLAYLIST":_.push(s.createElement(h,{data:o,key:"suggest_playlist_"+o.PLAYLIST_ID,display_add:!0,index:f,onClick:this._onSuggestionClick,context:"suggest_playlist"}));break;case"SHOW":_.push(s.createElement(m,{data:o,key:"suggest_playlist_"+o.SHOW_ID,display_add:!0,index:f,onClick:this._onSuggestionClick,context:"suggest_show"}))}y.length>2&&_.push(s.createElement("button",{key:"viewmore_"+r,onClick:this._onViewAllClick.bind(null,r),className:"btn btn-block btn-view-more",type:"button","data-type":"view_all"},s.createElement("span",{className:"label"},a[r].view_more_wording))),e.push(s.createElement("h2",{className:"panel-heading-sub heading-4",key:"suggest_title_"+r},a[r].title)),e.push(s.createElement("ul",{key:"suggest_list_"+r,className:"nano-card-list"},_))}}return e},_onSuggestionClick:function(e,t,a){this.props.isAuthUser&&userData.addSearchHistory(o.getQuery(),t,a)},_onViewAllClick:function(e,t){this.tracking("panel_click",t.currentTarget);var a=o.getQuery();this.props.isAuthUser&&userData.addSearchHistory(a),Events.trigger(Events.menu.closeAllPanels),window.search._tabName=e&&"TRACK"!==e?e.toLowerCase():"all",0===a.lastIndexOf("#",0)?(a=a.replace(/#/g,""),loadBox("/tags/"+encodeURIComponent(a),{force:!0})):loadBox("/search/"+encodeURIComponent(a),{force:!0})},_onHistoryChange:function(){this.setState({history:userData.data.SEARCH_HISTORY})}});t.exports=f},{"../../../core/i18n":245,"../../../naboo/stores/SearchStore":271,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/tracking":45,"../../common/TagList":129,"../../common/list_items/Album":142,"../../common/list_items/Artist":144,"../../common/list_items/Playlist":147,"../../common/list_items/Show":148,"../../common/list_items/Track":149,"./_elements/History":162,react:"react"}],158:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=e("../../common/TagList"),o=e("./_elements/History"),l=e("../../_mixins/panel"),c=e("../../_mixins/panelScroll"),p=s.createClass({displayName:"SearchHistory",mixins:[l,c],panel_name:"searchhistory",getInitialState:function(){return{userTags:userData.data.USER_TAGS?userData.data.USER_TAGS.data:[],history:userData.data.SEARCH_HISTORY?userData.data.SEARCH_HISTORY.data:[],historyLength:userData.data.SEARCH_HISTORY?userData.data.SEARCH_HISTORY.total:0}},scrollbar:{ref:"nano",shouldUpdate:function(e){return e.historyLength!==this.state.historyLength}},componentDidMount:function(){Events.subscribe(Events.user.updateSearchHistory,this._onHistoryChange)},componentWillUnmount:function(){Events.unsubscribe(Events.user.updateSearchHistory,this._onHistoryChange)},shouldComponentUpdate:function(e,t){return e.selected!==this.props.selected||t.historyLength!==this.state.historyLength||t.userTags.length!==this.state.userTags.length},render:function(){var e=[];return this.state.userTags.length&&(e.push(s.createElement("h2",{key:"user-tag-list-title",className:"panel-heading-sub heading-4 heading-bordered"},i("Tags"))),e.push(s.createElement(n,{key:"user-tag-list",tags:this.state.userTags}))),this.state.history.length&&(e.push(s.createElement("h2",{key:"history-list-title",className:"panel-heading-sub heading-4 heading-bordered"},i("Dernières recherches"))),e.push(s.createElement(o,{key:"history-list",history:this.state.history})),e.push(s.createElement("button",{key:"history-clear-button",className:"btn btn-block btn-view-more",type:"button",onClick:this._clearSearchHistory},s.createElement("span",{className:"label"},i("Effacer"))))),this.renderPanel(s.createElement("div",{className:"panel-search-history"},this.renderScrollbar({"panel-body":!0},s.createElement("div",null,e))))},_onHistoryChange:function(){this.setState({historyLength:userData.data.SEARCH_HISTORY.total})},_clearSearchHistory:function(){userData.clearSearchHistory(),Events.trigger(Events.menu.closeAllPanels)}});t.exports=p},{"../../../core/i18n":245,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../common/TagList":129,"./_elements/History":162,react:"react"}],162:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../common/list_items/Artist"),i=e("../../../common/list_items/Album"),n=e("../../../common/list_items/Track"),o=e("../../../common/list_items/Playlist"),l=e("../../../common/list_items/Show"),c=e("../../../_mixins/tracking"),p=s.createClass({displayName:"History",propTypes:{history:s.PropTypes.array},mixins:[c],getInitialState:function(){return{history:this.props.history}},render:function(){if(this._isHistoryEmpty())return null;for(var e=[],t=0,a=this.state.history.length;a>t;t++){var c=this.state.history[t].query,p=this.state.history[t].result,d=null;switch(p&&p.__TYPE__){case"artist":d=s.createElement(r,{data:p,key:"artist_"+p.ART_ID,display_add:!0,index:t,context:"history_artist"});break;case"album":d=s.createElement(i,{data:p,key:"album_"+p.ALB_ID,display_add:!0,index:t,context:"history_album"});break;case"song":d=s.createElement(n,{data:p,key:"track_"+p.SNG_ID,display_add:!0,index:t,context:"history_track"});break;case"playlist":d=s.createElement(o,{data:p,key:"playlist_"+p.PLAYLIST_ID,display_add:!0,index:t,context:"history_playlist"});break;case"show":d=s.createElement(l,{data:p,key:"show_"+p.PLAYLIST_ID,display_add:!0,index:t,context:"history_show"})}e.push(s.createElement("li",{key:"query_"+c+t,className:"nano-card-link"},s.createElement("a",{className:"heading-4 ellipsis",onClick:this._onViewAll,"data-type":"query","data-query":c,"data-index":t},s.createElement("span",{className:"icon icon-arrow-top-left pull-left"}),c),d?s.createElement("ul",{className:"nano-card-list"},d):null))}return s.createElement("ul",{className:"nano-card-list search-history"},e)},_onViewAll:function(e){this.tracking("panel_click",e.currentTarget);var t=e.currentTarget.getAttribute("data-query");Events.trigger(Events.menu.closeAllPanels),loadBox("/search/"+encodeURIComponent(t))},_isHistoryEmpty:function(){return!(this.state.history&&this.state.history.length)}});t.exports=p},{"../../../_mixins/tracking":45,"../../../common/list_items/Album":142,"../../../common/list_items/Artist":144,"../../../common/list_items/Playlist":147,"../../../common/list_items/Show":148,"../../../common/list_items/Track":149,react:"react"}],148:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/context_menu"),i=e("../../_mixins/tracking"),n=e("../Thumbnail"),o=e("../Favorite"),l=s.createClass({displayName:"Show",propTypes:{data:s.PropTypes.object,display_favorite:s.PropTypes.bool,display_add:s.PropTypes.bool,context:s.PropTypes.string,index:s.PropTypes.number,onClick:s.PropTypes.func},contextTypes:{panel_name:s.PropTypes.string},mixins:[i],getDefaultProps:function(){return{display_favorite:!0,display_add:!1,context:"",index:null}},shouldComponentUpdate:function(e){return e.data.SHOW_ID!==this.props.data.SHOW_ID},getTrackingParams:function(){return{type:"show",id:this.props.data.SHOW_ID}},render:function(){return s.createElement("li",{key:"show"+this.props.data.SHOW_ID,className:"nano-card-item",onClick:this._onSelect,"data-index":this.props.index},s.createElement("div",{className:"nano-card-picture"},s.createElement(n,{id:Number(this.props.data.SHOW_ID),type:"show",picture_type:"talk",md5:this.props.data.SHOW_ART_MD5,height:56,width:56,play:!0,play_link:!0,context:this.props.context})),s.createElement("div",{className:"nano-card-options"},this._renderAdd(),this._renderFavorite()),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/show/"+this.props.data.SHOW_ID,"data-instance":"show_name"},this.props.data.SHOW_NAME))))},_renderFavorite:function(){return this.props.display_favorite?s.createElement(o,{type:"show",id:this.props.data.SHOW_ID,context:this.context.panel_name}):void 0},_renderAdd:function(){return this.props.display_add?s.createElement("a",{className:"option-hide",onClick:this._onAdd},s.createElement("span",{className:"icon icon-options"})):void 0},_onSelect:function(e){e.preventDefault(),this.tracking("panel_click",e.currentTarget),"function"==typeof this.props.onClick&&this.props.onClick(e,this.props.data,this.props.index);var t=e.target.getAttribute("href");null===t&&(t="/show/"+this.props.data.SHOW_ID);var a=dom.dataset(e.target,"instance");"undefined"!=typeof a&&dom.dataset(e.currentTarget,"instance",a),loadBox(t)},_onAdd:function(e){e.preventDefault(),e.stopPropagation(),r.open({target:e.currentTarget,id:this.props.data.SHOW_ID,type:"show",data:this.props.data,position:"right",is_thumbnail:!0,context:this.context.panel_name,listen_context:{TYPE:this.props.context,ID:this.props.data.SHOW_ID}})}});t.exports=l},{"../../../core/context_menu":242,"../../_mixins/tracking":45,"../Favorite":119,"../Thumbnail":130,react:"react"}],157:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("../../../core/i18n"),n=i.gettext,o=i.ngettext,l=e("../../../core/context_menu"),c=e("../../common/list_items/Episode"),p=e("../../common/list_items/Track"),d=e("../../common/list_items/ExternalTrack"),u=e("../../_mixins/tracking"),h=e("../../_mixins/panel"),m=e("../../_mixins/panelScroll"),_=s.createClass({displayName:"QueueList",mixins:[h,m,u],panel_name:"queuelist",scrollbar:{ref:"nano",shouldUpdate:function(e){return this.state.list.length!==e.list.length}},getInitialState:function(){return{list:dzPlayer.getTrackList(),index:dzPlayer.getTrackListIndex(),duration:dzPlayer.getTrackListDuration(),selected:0,nb_display:50}},componentDidMount:function(){Events.subscribe(Events.player.tracklist_changed,function(){this._deselectAllTracks(),this.setState({list:dzPlayer.getTrackList(),duration:dzPlayer.getTrackListDuration(),index:dzPlayer.getTrackListIndex(),nb_display:50})}.bind(this),"panel_queue"),Events.subscribe(Events.player.displayCurrentSong,function(){this.setState({index:dzPlayer.getTrackListIndex()})}.bind(this),"panel_queue"),this.scrollbar_onEnd(this._displayMore),this.subscribeOnOpen(function(){r(this.refs.nano_content).scrollTop(this._getScrollPosition())}.bind(this),"panel_queue")},componentWillUnmount:function(){Events.unsubscribeAll("panel_queue")},shouldComponentUpdate:function(e,t){return e.selected!==this.props.selected||t.index!==this.state.index||t.duration!==this.state.duration||t.selected!==this.state.selected||t.nb_display!==this.state.nb_display||t.list.length!==this.state.list.length},render:function(){return this.renderPanel(s.createElement("div",{className:"panel-qlist"},s.createElement("div",{className:"panel-header"},this._renderTitle(),this._renderActionBar()),this.renderScrollbar({"panel-body":!0},s.createElement("ul",{className:"nano-card-list",ref:"list"},this._renderTrackList()))))},_renderTitle:function(){var e=this.state.selected,t=this.state.list.length,a=o("<span>%s</span> titre","<span>%s</span> titres",{count:t,sprintf:[breakUpThousands(t)]}),r=n("À l'écoute");return dzPlayer.getMediaType()!==dzPlayer.MEDIA_TYPE_LIVE_STREAM&&(dzPlayer.isRadio()?(a="",r=n(dzPlayer.helper.isPlayingUserFlow()?"Derniers titres écoutés sur Flow":"Derniers titres écoutés dans le mix")):0===e?a+=" "+String.fromCharCode(183)+" "+formatDuration(this.state.duration,!0):a=o("<span>%s</span> titre sélectionné","<span>%s</span> titres sélectionnés",{count:e,sprintf:[breakUpThousands(e)]})),s.createElement("div",null,s.createElement("h1",{className:"heading-2 ellipsis"},r),s.createElement("h2",{className:"heading-3-sub ellipsis",dangerouslySetInnerHTML:{__html:a}}))},_renderActionBar:function(){return 0===this.state.selected?!1:s.createElement("div",{className:"action"},dzPlayer.getMediaType()!==dzPlayer.MEDIA_TYPE_TALK?s.createElement("button",{className:"btn btn-default btn-mini",type:"button",onClick:this._onAdd,"data-type":"edit_add"},s.createElement("span",{className:"icon icon-add"})):"",this.state.list.length>1?s.createElement("button",{className:"btn btn-default btn-mini",type:"button",onClick:this._onRemove,"data-type":"edit_delete"},s.createElement("span",{className:"icon icon-trash"})):"")},_renderTrackList:function(){var e=[],t=dzPlayer.isRadio(),a=dzPlayer.helper.isPlayingFlow()?"flow":null,r=dzPlayer.getIndexSong(),i=this.state.list.slice(0,this.state.nb_display);return i.forEach(function(n,o){var l=!t||o===r;dzPlayer.getMediaType(n)===dzPlayer.MEDIA_TYPE_SONG?e.push(s.createElement(p,{ref:"item_"+o,onSelect:this._onSelect,key:"track_"+n.SNG_ID+"_"+o,data:n,index:o,play_data:i,play_index:r,is_radio:t,show_play:l,display_drag:!1,display_add:!0,selectable:!t,context:"queue_list",share_context:a})):dzPlayer.getMediaType(n)===dzPlayer.MEDIA_TYPE_TALK?e.push(s.createElement(c,{ref:"item_"+o,onSelect:this._onSelect,key:"episode_"+n.EPISODE_ID+"_"+o,data:n,index:o,play_data:i,play_index:r,is_radio:t,show_play:l,selectable:!t,context:"queue_list",share_context:a})):e.push(s.createElement(d,{ref:"item_"+o,key:"external_"+n.MD5_ORIGIN+"_"+o,data:n,index:o}))}.bind(this)),e},_display_more_enabled:!0,_displayMore:function(){return this._display_more_enabled===!1||this.state.nb_display>this.state.list.length?!1:(this._display_more_enabled=!1,this.setState({nb_display:this.state.nb_display+50},function(){this._display_more_enabled=!0}),!0)},_getScrollPosition:function(){var e=this.refs.nano_content,t=this.refs.list;if(t.offsetHeight<e.offsetHeight)return 0;var a=t.offsetHeight/this.state.list.length,s=a*this.state.index;return this.state.index>0&&(s+=15),s},_getSelectedTracks:function(e){e=e||"data";for(var t=[],a=Math.min(this.state.nb_display,this.state.list.length),s=0;a>s;s++)if(this.refs["item_"+s].state.selected){var r=0;r="id"===e?this.refs["item_"+s].props.data.SNG_ID:"index"===e?s:this.refs["item_"+s].props.data,t.push(r)}return t},_deselectAllTracks:function(){for(var e=Math.min(this.state.nb_display,this.state.list.length),t=0;e>t;t++)this.refs["item_"+t].state.selected&&this.refs["item_"+t].deselect();this.setState({selected:0})},_onAdd:function(e){var t=this._getSelectedTracks("id");l.open({target:r(e.currentTarget),type:"song",id:t,context:this.panel_name,data:{SONG:1===t.length?this._getSelectedTracks()[0]:{},INDEX:1===t.length?this._getSelectedTracks("index")[0]:0},position:"bottom"}),this.tracking("panel_click",e.currentTarget)},_onRemove:function(e){for(var t=Math.min(this.state.nb_display,this.state.list.length),a=t-1;a>=0;a--)this.refs["item_"+a].state.selected&&dzPlayer.removeTracks(a);this.setState({selected:0}),this.tracking("panel_click",e.currentTarget)},_onSelect:function(){this.setState({selected:this._getSelectedTracks().length})}});t.exports=_},{"../../../core/context_menu":242,"../../../core/i18n":245,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/tracking":45,"../../common/list_items/Episode":145,"../../common/list_items/ExternalTrack":146,"../../common/list_items/Track":149,jquery:"jquery",react:"react"}],146:[function(e,t,a){"use strict";var s=e("react"),r=e("../../_mixins/tracking"),i=s.createClass({displayName:"ExternalTrack",propTypes:{data:s.PropTypes.object.isRequired,index:s.PropTypes.number},mixins:[r],getDefaultProps:function(){return{index:0}},getInitialState:function(){return{selected:!1}},shouldComponentUpdate:function(e,t){return t.selected!==this.state.selected||e.data.MD5_ORIGIN!==this.props.data.MD5_ORIGIN},getTrackingParams:function(){return{type:dzPlayer.getMediaType(),id:this.props.data.MD5_ORIGIN,index:this.props.index}},deselect:function(){},render:function(){return s.createElement("li",{key:"track"+this.props.data.MD5_ORIGIN,className:"nano-card-item",onClick:this._onClick},s.createElement("div",{className:"nano-card-picture"},s.createElement("img",{src:this.props.data.PICTURE_URL,alt:this.props.data.SNG_TITLE,height:"56",width:"56"})),s.createElement("div",{className:"nano-card-options"}),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},this.props.data.SNG_TITLE),s.createElement("div",{className:"heading-4-sub ellipsis"},this.props.data.ART_NAME)))},_onClick:function(e){e.preventDefault(),this.tracking("panel_click",e.currentTarget),dzPlayer.playTrackAtIndex(this.props.index)}});t.exports=i},{"../../_mixins/tracking":45,react:"react"}],145:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../../core/context_menu"),n=e("../../_mixins/tracking"),o=e("../Thumbnail"),l=e("../Favorite"),c=s.createClass({displayName:"Episode",propTypes:{display_favorite:s.PropTypes.bool,display_add:s.PropTypes.bool,display_drag:s.PropTypes.bool,data:s.PropTypes.object,index:s.PropTypes.number,selectable:s.PropTypes.bool,context:s.PropTypes.string,share_context:s.PropTypes.string,is_radio:s.PropTypes.bool,show_play:s.PropTypes.bool,play_index:s.PropTypes.number,play_data:s.PropTypes.array,enabled:s.PropTypes.bool,onClick:s.PropTypes.func,onSelect:s.PropTypes.func},contextTypes:{panel_name:s.PropTypes.string},mixins:[n],getDefaultProps:function(){return{display_favorite:!1,display_drag:!1,display_add:!1,data:[],index:null,selectable:!1,context:"",is_radio:!1,show_play:!0,play_data:[],onSelect:function(){}}},getInitialState:function(){return{selected:!1}},shouldComponentUpdate:function(e,t){return t.selected!==this.state.selected||e.data.EPISODE_ID!==this.props.data.EPISODE_ID},getTrackingParams:function(){return{type:dzPlayer.MEDIA_TYPE_TALK,id:this.props.data.EPISODE_ID,index:this.props.index}},deselect:function(){this.setState({selected:!1})},render:function(){var e=r({"nano-card-item":!0,checked:this.state.selected,hide:this.props.is_radio&&this.props.index>this.props.play_index});return s.createElement("li",{key:"track"+this.props.data.EPISODE_ID,className:e,onClick:this._onSelect},s.createElement("div",{className:"nano-card-picture"},s.createElement(o,{type:"track",height:56,width:56,id:Number(this.props.data.EPISODE_ID),picture_type:"talk",md5:this.props.data.SHOW_ART_MD5,play:this.props.show_play,play_index:"queuelist"===this.context.panel_name?this.props.index:null,play_data:this.props.play_data,context:this.props.context,zoom:!1,enabled:this.props.enabled,overlay:!1})),s.createElement("div",{className:"nano-card-options"},this._renderAdd(),this._renderFavorite(),this._renderDrag()),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/show/"+this.props.data.SHOW_ID,"data-instance":"track_name"},this.props.data.EPISODE_TITLE)),s.createElement("div",{className:"heading-4-sub ellipsis"},s.createElement("a",{href:"/show/"+this.props.data.SHOW_ID,"data-instance":"artist_name"},this.props.data.SHOW_NAME))))},_renderFavorite:function(){return this.props.display_favorite?s.createElement(l,{type:"show",id:this.props.data.EPISODE_ID,context:this.context.panel_name}):void 0},_renderDrag:function(){return this.props.display_drag?s.createElement("span",{className:"draggable"}):void 0},_renderAdd:function(){return this.props.display_add?s.createElement("a",{className:"option-hide",onClick:this._onAdd},s.createElement("span",{className:"icon icon-options"})):void 0},_onAdd:function(e){e.preventDefault(),e.stopPropagation(),i.open({target:e.currentTarget,id:this.props.data.EPISODE_ID,type:"talk",context:this.context.panel_name,listen_context:{TYPE:this.props.context,ID:this.props.data.EPISODE_ID},data:{EPISODE:this.props.data,INDEX:this.props.index},share_context:this.props.share_context,position:"right"})},_onSelect:function(e){e.preventDefault(),this.tracking("panel_click",e.currentTarget),"function"==typeof this.props.onClick&&this.props.onClick(e,this.props.data,this.props.index);var t=dom.dataset(e.target,"instance");if(null!==t&&dom.dataset(e.currentTarget,"instance",t),this.props.selectable&&"DIV"===e.target.tagName)return void this.setState({selected:!this.state.selected},function(){this.props.onSelect()}.bind(this));if("play"!==t||"queuelist"!==this.context.panel_name){var a=e.target.getAttribute("href");null===a&&(a="/show/"+this.props.data.SHOW_ID),loadBox(a)}}});t.exports=c},{"../../../core/context_menu":242,"../../_mixins/tracking":45,"../Favorite":119,"../Thumbnail":130,classnames:"classnames",react:"react"}],156:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("../../../core/i18n"),n=i.gettext,o=i.ngettext,l=e("../../../core/modal"),c=e("../../common/Selectbox"),p=e("../../common/list_items/Playlist"),d=e("../../_mixins/tracking"),u=e("../../_mixins/sort"),h=e("../../_mixins/panel"),m=e("../../_mixins/panelScroll"),_=s.createClass({displayName:"Playlists",mixins:[h,u,m,d],panel_name:"playlists",scrollbar:{ref:"nano",shouldUpdate:function(e){return this.state.list.length!==e.list.length}},getInitialState:function(){return{list:this._getPlaylistList(),playlist_on_top:[],create_playlist:!1,sort_type:USER.SETTING.site.sort_panel_playlist||"PLAYLIST_TITLE",filter:"",nb_display:50}},componentDidMount:function(){Events.subscribe(Events.user.addFavorite,function(e,t){"playlist"===t.type&&this._updatePlaylists()}.bind(this),"panel_playlist"),Events.subscribe(Events.user.deleteFavorite,function(e,t){"playlist"===t.type&&this._updatePlaylists()}.bind(this),"panel_playlist"),Events.subscribe(Events.playlist.created,this._updatePlaylists,"panel_playlist"),Events.subscribe(Events.playlist.removed,this._updatePlaylists,"panel_playlist"),Events.subscribe(Events.playlist.updated,this._updatePlaylists,"panel_playlist"),Events.subscribe(Events.playlist.addSong,this._updatePlaylists,"panel_playlist"),Events.subscribe(Events.playlist.removeSong,this._updatePlaylists,"panel_playlist"),this.scrollbar_onEnd(this._displayMore),this.subscribeOnOpen(function(){this.setState({playlist_on_top:[],filter:""})}.bind(this))},componentWillUnmount:function(){Events.unsubscribeAll("panel_playlist")},render:function(){return this._refreshCurrentList(),this.renderPanel(s.createElement("div",{className:"panel-playlists"},s.createElement("div",{className:"panel-header"},this._renderTitle(),this.state.list.length?this._renderActions():null),this.renderScrollbar({"panel-body":!0},[this._renderContent()])))},_current_list:[],_display_more_enabled:!0,_renderTitle:function(){var e=this.state.list.length;return 0===e?s.createElement("h1",{className:"panel-heading heading-2"},s.createElement("span",{className:"color-primary"},breakUpThousands(e))," "+o("playlist","playlists",{count:e})):s.createElement("h1",{className:"panel-heading heading-2"},s.createElement("a",{href:"/profile/"+USER.USER_ID+"/playlists",className:"evt-click"},s.createElement("span",{className:"color-primary"},breakUpThousands(e))," "+o("playlist","playlists",{count:e}),s.createElement("span",{className:"icon icon-arrow-right"})))},_renderActions:function(){return s.createElement("div",{className:"action form-inline"},s.createElement("div",{className:"form-group"},s.createElement("input",{className:"form-control input-small empty-filter",type:"text",onChange:this._onFilterChange,placeholder:n("Filtrer"),value:this.state.filter})),this.state.list.length>0?s.createElement("div",{className:"form-group"},s.createElement(c,{type:"playlist",onChange:this._onSortTypeChange})):"")},_renderContent:function(){return s.createElement("ul",{key:"playlist-list",className:"nano-card-list"},s.createElement("li",{className:"nano-card-item nano-card-plus",onClick:this._onOpenPlaylistAssistant,"data-type":"create_playlist"},s.createElement("div",{className:"nano-card-picture"},s.createElement("span",{className:"icon icon-16 icon-add"})),s.createElement("div",{className:"nano-card-infos"},s.createElement("span",{className:"heading-4"},n("Créer une playlist")))),this._current_list.map(function(e){var t=r.extend({},e);return s.createElement(p,{data:t,key:"playlist_"+e.PLAYLIST_ID,display_favorite:!1,display_add:!0,context:"menu_panel_playlist"})}))},_updatePlaylists:function(){this.setState({list:this._getPlaylistList()})},_onSortTypeChange:function(e){this.setState({sort_type:e,playlist_on_top:[]})},_onOpenPlaylistAssistant:function(e){this.tracking("panel_click",e.currentTarget),l.open("/lightbox/playlist_assistant?type=create"),Events.trigger(Events.menu.closeAllPanels)},_onFilterChange:function(e){this.setState({filter:e.target.value},this.refreshScrollbar)},_refreshCurrentList:function(){var e=[],t=this.sort(this.state.list,this.state.sort_type),a=this.state.filter.toLowerCase().trim();""!==a&&(t=t.filter(function(e){return e.TITLE.toLowerCase().indexOf(a)>-1||"undefined"!=typeof e.PARENT_USERNAME&&e.PARENT_USERNAME.toLowerCase().indexOf(a)>-1}));for(var s=0;s<this.state.playlist_on_top.length;s++)for(var r=0;r<t.length;r++)if(Number(t[r].PLAYLIST_ID)===Number(this.state.playlist_on_top[s])){e.push(t[r]),t.splice(r,1);break}t=e.concat(t),t=t.slice(0,this.state.nb_display),this._current_list=t},_displayMore:function(){return this._display_more_enabled===!1||this.state.nb_display>this._current_list.length?!1:(this._display_more_enabled=!1,this.setState({nb_display:this.state.nb_display+50},function(){this._display_more_enabled=!0}),!0)},_getPlaylistList:function(){return r.merge(r.merge([],userData.data.PLAYLISTS.data),userData.data.FAVORITES_PLAYLISTS.data)}});t.exports=_},{"../../../core/i18n":245,"../../../core/modal":247,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/sort":43,"../../_mixins/tracking":45,"../../common/Selectbox":126,"../../common/list_items/Playlist":147,jquery:"jquery",react:"react"}],155:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("classnames"),n=e("jquery");e("visibly.js");var o=e("../../../core/i18n"),l=o.gettext,c=e("../../../core/Blurred"),p=e("./_elements/lyrics/Spinner"),d=e("./_elements/lyrics/Placeholder"),u=e("./_elements/lyrics/Header"),h=e("./_elements/lyrics/List"),m=e("../../_mixins/tracking"),_=e("../../_mixins/panel"),y=e("../../_mixins/panelScroll"),g=s.createClass({displayName:"Lyrics",propTypes:{hasAds:s.PropTypes.bool,unloggedClipLength:s.PropTypes.number,isAuthUser:s.PropTypes.bool,autoScrollEasing:s.PropTypes.string,autoScrollDuration:s.PropTypes.number,scrollWaitTimeout:s.PropTypes.number},mixins:[_,y,m],panel_name:"lyrics",scrollbar:{ref:"nano",disableScrollTopOnUpdate:!0,shouldUpdate:function(e){return this.state.lyrics.length!==e.lyrics.length}},getTrackingParams:function(){return{action:{type:"display"},container:"panel",sng:this.state.track.SNG_ID,type:dzPlayer.hasSyncLyrics()?"synchro":"full_text"}},getInitialState:function(){var e=this._getStateFromStore();return e.position=dzPlayer.getPosition(),e.isActivePanel=!0,e.firstOpen=!0,e},getDefaultProps:function(){return{tolerance:0,autoScrollDuration:500,scrollWaitTimeout:900,unloggedClipLength:30,autoScrollEasing:"swing",isAuthUser:0!==window.USER.USER_ID,hasAds:USER.OPTIONS.ads_display}},componentDidMount:function(){Events.subscribe(Events.player.displayCurrentSong,this._onTrackChange,"lyrics_panel"),Events.subscribe(Events.player.changePlayerType,this._onPlayerTypeChange,"lyrics_panel"),Events.subscribe(Events.player.position,this._onPositionChange,"lyrics_panel"),Events.subscribe(Events.player.seek,this._onPlayerSeek,"lyrics_panel"),Events.subscribe(Events.lyrics.load,this._onLyricsLoad,"lyrics_panel"),Events.subscribe(Events.lyrics.seek,this._onLyricsSeek,"lyrics_panel"),this.subscribeOnOpen(function(){this.state.track.SNG_ID===dzPlayer.getCurrentSong("SNG_ID")&&this._scrollToActiveLyric(this.state.activeLyricIndex,!0),"undefined"!=typeof advertising&&advertising.call("lyrics",{element_id:this.state.track.SNG_ID})}.bind(this)),n(this.refs.nano_content).on("scroll",this._onPanelScroll),this._setCoverBackground(this.state.track.ALB_PICTURE),dzPlayer.control.loadLyrics()},componentWillReceiveProps:function(e){this.setState({isActivePanel:"lyrics"===e.selected&&e.displayed===!0})},componentWillUnmount:function(){Events.unsubscribeAll("lyrics_panel"),n(this.refs.nano_content).off("scroll",this._onPanelScroll)},componentWillUpdate:function(e,t){t.isActivePanel&&(this._scrollTopWhenActive?(this._scrollTopWhenActive=!1,setTimeout(this._scrollToTop,0)):t.autoScroll&&t.hasLyrics&&this._scrollToActiveLyric(t.activeLyricIndex))},shouldComponentUpdate:function(){return this.state.isActivePanel===!0},render:function(){var e,t=i({"panel-lyrics":!0,"has-lyrics":this.state.hasLyrics,"has-synchro":this.state.synchro}),a=i({"lyrics-container":!0,"lyrics-container-active":this.state.ready});this.state.synchro&&!this.state.autoScroll&&-1!==this.state.activeLyricIndex&&(e=this.state.lyrics[this.state.activeLyricIndex]);var r,n=this.state.ready&&this.state.hasLyrics,o=n&&this.state.synchro?"marquee":null;return n&&this.state.synchro&&(r=this.state.autoScroll?"assertive":"polite"),this.renderPanel(s.createElement("div",{className:t,ref:"panel_lyrics",itemScope:!0,itemType:"http://data-vocabulary.org/MusicRecording"},s.createElement("div",{className:"panel-lyrics-overlay"}),s.createElement(u,{track:this.state.track,lyric:e}),this.renderScrollbar({"panel-body lyrics-panel-body":!0},s.createElement("div",{className:a,role:o,"aria-live":r},s.createElement(d,{show:this.state.ready&&!this.state.hasLyrics,track:this.state.track}),s.createElement(p,{show:n,max:this.state.timeToFirstLyric,now:this.state.position}),s.createElement(h,{ref:"lyriclist",synchro:this.state.synchro,lyrics:this.state.lyrics,activeIndex:this.state.activeLyricIndex}),this.state.hasLyrics?s.createElement("aside",{className:"legal"},l("Licence et autorisation données par LyricFind"),s.createElement("br",null),"© ",this.state.metadata.copyrights,s.createElement("br",null),this.state.metadata.writers,s.createElement("br",null)):"")),this.props.hasAds?s.createElement("div",{className:"ads ads-bottom"},s.createElement("div",{id:"lyrics_ads_banner_bottom"})):"",s.createElement("div",{className:"panel-footer"},this.state.hasLyrics?s.createElement("a",{className:"evt-click btn btn-link",href:"/track/"+this.state.track.SNG_ID},s.createElement("span",{className:"label"},l("TOUTES LES PAROLES")),s.createElement("span",{className:"icon icon-after icon-arrow-right-long"})):"")))},_getStateFromStore:function(){var e=dzPlayer.hasLyrics();return{track:dzPlayer.getCurrentSong(),hasLyrics:e,lyrics:[],metadata:{},position:0,synchro:!1,autoScroll:!1,autoSeek:!1,timeToFirstLyric:-1,activeLyricIndex:-1,ready:!e,canSeek:dzPlayer.control.canSeek(),firstOpen:!1}},_onTrackChange:function(e,t){this._scrollTopWhenActive=!0,this.state.track.ALB_ID!==t.ALB_ID&&setTimeout(function(){this._setCoverBackground(t.ALB_PICTURE)}.bind(this),0),"undefined"!=typeof advertising&&this.state.isActivePanel&&!this.state.firstOpen&&advertising.call("lyrics",{element_id:this.state.track.SNG_ID}),this.setState(this._getStateFromStore(),dzPlayer.control.loadLyrics)},_onLyricsLoad:function(){var e,t=dzPlayer.hasSyncLyrics(),a=dzPlayer.getLyrics(),s=dzPlayer.getLyricsMetadata(),r={lyrics:a,metadata:s,hasLyrics:a&&0!==a.length,ready:!0,synchro:!1,autoScroll:!1,autoSeek:!1};if(this.tracking("lyrics"),t){e=[];for(var i=0,o=a.length;o>i;i++){var l=a[i];l&&l.line&&l.milliseconds&&(l.originalIndex=i,e.push(l))}e.length>0?n.extend(r,{lyricIndex:e,synchro:!0,autoScroll:!0,autoSeek:!0,timeToFirstLyric:parseInt(e[0].milliseconds,10)/1e3}):n.extend(r,{hasLyrics:!1,lyrics:[]})}setTimeout(function(){this.setState(r)}.bind(this),0)},_onPositionChange:function(e,t){if(!window.visibly.hidden()&&this.state.isActivePanel&&this.state.hasLyrics&&this.state.synchro){!this.props.isAuthUser&&this.state.canSeek&&(t+=this.props.unloggedClipLength);var a=this._findLyric(t);this.state.autoSeek?(-1===a&&-1!==this.state.activeLyricIndex&&(this._scrollTopWhenActive=!0),this.setState({position:t,activeLyricIndex:a})):this.setState({position:t,autoSeek:a===this.state.activeLyricIndex})}},_onLyricsSeek:function(e,t){var a,s,r,i=this.state.activeLyricIndex;if(!t.seek||this.state.canSeek){if("undefined"!=typeof t.index){if(t.index===this.state.activeLyricIndex&&dzPlayer.playing)return;i=t.index}if(t.seek){if(r=parseInt(t.milliseconds,10)/1e3,s=parseInt(this.state.track.DURATION,10),this.props.isAuthUser||(s=this.props.unloggedClipLength,r-=this.props.unloggedClipLength),a=r/s,a>1||!this.props.isAuthUser&&0>r)return;dzPlayer.control.seek(a)}else this._scrollToActiveLyric(i),dzPlayer.isPaused()&&dzPlayer.control.togglePause();this.setState({activeLyricIndex:i,autoSeek:!t.seek,autoScroll:!0})}},_onPlayerSeek:function(e,t){this.state.synchro&&!this.state.autoScroll&&this.setState({activeLyricIndex:this._findLyric(t),autoScroll:!0})},_onPanelScroll:function(){this.state.synchro&&!this._blockUserScroll&&this.setState({autoScroll:!1})},_onPlayerTypeChange:function(){this.state.isActivePanel&&"ads"===dzPlayer.getPlayerType()&&Events.trigger(Events.menu.togglePanel,"lyrics")},_scrollToActiveLyric:function(e,t){if(!this.state.autoScroll||t||this.state.activeLyricIndex!==e){var a=this.refs.lyriclist.getLyric(e);if(a){this._blockUserScroll=!0;var s=this.refs.nano_content,i=n(s).scrollTop(),o=s.offsetHeight||0,l=r.findDOMNode(a),c=n(l).position().top,p=this.props.autoScrollDuration,d=this.props.autoScrollEasing,u=l.getBoundingClientRect();(t||u.bottom<=0||u.bottom>o)&&(p=this.props.autoScrollDuration/3),n(s).animate({scrollTop:i+c-o/2},p,d,function(){setTimeout(function(){this._blockUserScroll=0!==n(s).queue("fx").length}.bind(this),this.props.scrollWaitTimeout)}.bind(this))}}},_scrollToTop:function(){this._blockUserScroll=!0,this.refs.nano_content.scrollTop=0,setTimeout(function(){this._blockUserScroll=!1}.bind(this),this.props.scrollWaitTimeout)},_setCoverBackground:function(e){var t=this.refs.panel_lyrics,a="%1/cover/%2/500x500-000000-80-0-0.jpg".replace("%1","http://cdn-images.deezer.com/images").replace("%2",e),s=window.attachEvent&&!window.addEventListener;s?t.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'", sizingMethod="scale");':new c(t).setUrl(a).setBlurStrength(3).render()},_findLyric:function(e){var t,a,s,r=0,i=this.state.lyricIndex.length,n=Math.round(1e3*e),o=1e3*this.state.timeToFirstLyric;if(o>n)return-1;var l=this.state.lyricIndex[i-1],c=parseInt(l.milliseconds,10);if(n>c)return this.state.lyricIndex[i-1].originalIndex;for(;r!==i&&(t=Math.floor((r+i)/2),a=parseInt(this.state.lyricIndex[t].milliseconds,10),a!==n);)n>a?r=t+1:i=t;return s=0===r?r:r-1,window.LYRICS_DEBUG,this.state.lyricIndex[s].originalIndex}});t.exports=g},{"../../../core/Blurred":237,"../../../core/i18n":245,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/tracking":45,"./_elements/lyrics/Header":163,"./_elements/lyrics/List":164,"./_elements/lyrics/Placeholder":166,"./_elements/lyrics/Spinner":167,classnames:"classnames",jquery:"jquery",react:"react","react-dom":"react-dom","visibly.js":"visibly.js"}],167:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../../../../core/i18n"),n=i.ngettext,o=s.createClass({displayName:"Spinner",propTypes:{max:s.PropTypes.number,now:s.PropTypes.number,message:s.PropTypes.string,strokeDasharray:s.PropTypes.number,show:s.PropTypes.bool},getDefaultProps:function(){return{now:0,max:-1,strokeDasharray:300,show:!1}},getInitialState:function(){return this._getState()},componentWillReceiveProps:function(e){setTimeout(function(){this.setState(this._getState(e))}.bind(this),0)},shouldComponentUpdate:function(e,t){return-1===e.max||t.strokeDashoffset>=0&&0!==this.state.strokeDashoffset},render:function(){if(!this.props.show)return null;var e,t,a,i,o,l={strokeDashoffset:this.state.strokeDashoffset},c=r({"starter-svg":!0,"svg-animate":this.state.transition});return this.props.max>0&&(e=0,t=this.props.max,a=this.props.now<t?this.props.now:t,i=Math.floor(t-a),o=n("%s seconde","%s secondes",{sprintf:[i],count:i})),s.createElement("div",{className:"lyrics-starter"},s.createElement("div",{className:"starter-anim"},s.createElement("svg",{className:c,height:"100",width:"100",x:"0px",y:"0px"},s.createElement("g",{fill:"none",stroke:"rgba(255,255,255,0.3)"},s.createElement("circle",{cx:"50",cy:"50",r:"45"})),s.createElement("g",{className:"spinner",fill:"none",stroke:"#FFFFFF",role:"timer","aria-describedby":"starter-message",strokeDasharray:this.props.strokeDasharray,style:l,"aria-valuemin":e,"aria-valuemax":t,"aria-valuenow":a,"aria-valuetext":o},s.createElement("circle",{cx:"50",cy:"50",r:"45"}))),s.createElement("span",{className:"icon icon-32 icon-lyrics"})))},_getState:function(e){e=e||this.props;var t,a,s=e.max>=0?e.strokeDasharray:0,r=this.state?this.state.strokeDashoffset:null;return e.max>0&&e.now<=e.max&&(s=e.now>0?e.strokeDasharray/(e.max/e.now):0),a=e.strokeDasharray-s,t=!(0===a||a===e.strokeDasharray||null!==r&&a>=r),{strokeDashoffset:e.strokeDasharray-s,transition:t}}});t.exports=o},{"../../../../../core/i18n":245,classnames:"classnames",react:"react"}],166:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("react-addons-pure-render-mixin"),n=e("../../../../../core/i18n"),o=n.gettext,l=s.createClass({displayName:"Placeholder",propTypes:{placeholders:s.PropTypes.array,explanations:s.PropTypes.array,track:s.PropTypes.object.isRequired,show:s.PropTypes.bool},mixins:[i],getDefaultProps:function(){return{placeholders:[{title:"You Oughta Know",artist:"Alanis Morissette",quote:"It's not fair, to deny me of the cross-eyed bear that you gave to me"},{title:"Rock the Casbah",artist:"The Clash",quote:"Shareef don't like it. Rock the cat box, rock the cat box"},{title:"Sweet Dreams",artist:"Eurythmics",quote:"Sweet dreams are made of cheese"},{title:"Bad Moon Rising",artist:"Creedence Clearwater Revival",quote:"Don't go around tonight, it's bound to take your life, there's a bathroom on the right"},{title:"Smells Like Teen Spirit",artist:"Nirvana",quote:"Here we are now, in containers"},{title:"Message in a Bottle",artist:"The Police",quote:"Mon opinel a dû mal couper !"}],explanations:[o("OK... Nous n'avons pas les paroles de cette chanson."),o("Pas tout à fait... On donne tout pour trouver les paroles de cette chanson."),o("Presque... On se dépêche de vous trouver les paroles de cette chanson.")]}},getInitialState:function(){return this._getState(this.props.track,this.props.show)},componentWillReceiveProps:function(e){return this.setState(this._getState(e.track,e.show),function(){setTimeout(function(){this.setState({fadeIn:e.show})}.bind(this),0)}.bind(this))},render:function(){if(!this.props.show)return null;var e=this.props.placeholders[this.state.placeholderIndex],t=this.props.explanations[this.state.explanationIndex],a=this.state.placeholderIndex+1,i=o("(Mal) entendu dans %1$s <em>de %2$s</em>",{sprintf:[e.title,e.artist]}),n=r({"lyrics-placeholder":!0,"lyrics-placeholder-active":this.state.fadeIn});return s.createElement("div",{className:n,role:"alert"},s.createElement("p",{className:"picto-"+a},s.createElement("span",{className:"lyrics-placeholder-picto"})),s.createElement("p",{className:"quote"},s.createElement("span",{className:"lyrics-placeholder-quote"},e.quote)),s.createElement("p",{className:"lyrics-placeholder-track",dangerouslySetInnerHTML:{__html:i}}),s.createElement("p",{className:"lyrics-placeholder-message"},t))},_getState:function(e,t){if(!t)return{};var a=this.props.placeholders.length,s=this.state?this.state.placeholderIndex:null,r=this.state?this.state.explanationIndex:null,i="fr"===window.SETTING_LANG?a:a-1;return{placeholderIndex:this._getRandom(0,i,s),explanationIndex:this._getRandom(0,this.props.explanations.length,r),fadeIn:!1}},_getRandom:function(e,t,a){if(1>=t)return 0;var s=Math.floor(Math.random()*(t-e))+e;return"undefined"!=typeof a&&s===a?s===t-1?--s:++s:s}});t.exports=l},{"../../../../../core/i18n":245,classnames:"classnames",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],164:[function(e,t,a){"use strict";var s=e("react"),r=e("./Lyric"),i=s.createClass({displayName:"List",propTypes:{lyrics:s.PropTypes.array,activeIndex:s.PropTypes.number,synchro:s.PropTypes.bool},shouldComponentUpdate:function(e){return e.activeIndex!==this.props.activeIndex||e.synchro!==this.props.synchro||e.lyrics.length!==this.props.lyrics.length},getLyric:function(e){return this.refs["lyric_"+e]},render:function(){var e,t,a,i,n=this.props.lyrics||[];return s.createElement("ol",{className:"lyrics-content",itemProp:"text"},n.map(function(n,o){return e=o===this.props.activeIndex,t="lyric_"+o,a=n,this.props.synchro&&(a=n.line,i=n.milliseconds),s.createElement("li",{key:t},s.createElement(r,{ref:t,index:o,line:a,milliseconds:i,active:e}))}.bind(this)))}});t.exports=i},{"./Lyric":165,react:"react"}],163:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../../../../core/i18n"),n=i.gettext,o=e("./Lyric"),l=s.createClass({displayName:"Header",propTypes:{track:s.PropTypes.object.isRequired,lyric:s.PropTypes.object},shouldComponentUpdate:function(e){return e.track.SNG_ID!==this.props.track.SNG_ID||void 0!==e.lyric&&void 0===this.props.lyric||void 0===e.lyric&&void 0!==this.props.lyric||void 0!==e.lyric&&void 0!==this.props.lyric&&(e.lyric.milliseconds!==this.props.lyric.milliseconds||e.lyric.line!==this.props.lyric.line)},render:function(){var e="undefined"!=typeof this.props.lyric,t="%1/cover/%2/65x65-000000-80-0-0.jpg".replace("%1",window.SETTING_DOMAIN_IMG).replace("%2",this.props.track.ALB_PICTURE),a=r({"lyrics-track-infos":!0,hide:e}),i=r({"lyrics-active":!0,hide:!e});return s.createElement("div",{className:"panel-header"},s.createElement("div",{className:"panel-header-container clearfix"},s.createElement("a",{href:"/album/"+this.props.track.ALB_ID,className:"evt-click"},s.createElement("figure",{className:"lyrics-thumbnail"},s.createElement("img",{width:"65",height:"65",src:t,alt:this.props.track.ALB_TITLE,title:this.props.track.ALB_TITLE}))),s.createElement("div",{className:"lyrics-infos"},s.createElement("p",{className:"sticker sticker-small sticker-flow"},n("PAROLES")),s.createElement("div",{className:a,"aria-hidden":e},s.createElement("h2",{className:"heading-4 heading-inverse",itemProp:"name"},this.props.track.SNG_TITLE),s.createElement("h3",{className:"heading-4-sub heading-inverse"},n("par")+" "," ",s.createElement("a",{href:"/artist/"+this.props.track.ART_ID,className:"lyrics-artist-link evt-click"},this.props.track.ART_NAME))),s.createElement("p",{className:i,"aria-hidden":!e},e?s.createElement(o,{line:this.props.lyric.line,milliseconds:this.props.lyric.milliseconds,active:!0,seek:!1}):""))),s.createElement("button",{className:"btn btn-link panel-close",type:"button",onClick:this._closePanels},s.createElement("span",{className:"icon icon-cancel"})))},_closePanels:function(){Events.trigger(Events.menu.closeAllPanels)}});t.exports=l},{"../../../../../core/i18n":245,"./Lyric":165,classnames:"classnames",react:"react"}],165:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("react-addons-pure-render-mixin"),n=s.createClass({displayName:"Lyric",propTypes:{line:s.PropTypes.string.isRequired,milliseconds:s.PropTypes.string,index:s.PropTypes.number,active:s.PropTypes.bool,seek:s.PropTypes.bool},mixins:[i],getDefaultProps:function(){return{seek:!0}},render:function(){var e="undefined"!=typeof this.props.milliseconds,t=this.props.line?this.props.line.trim():"",a=r({"lyrics-line":!0,"lyrics-line-empty":!t,"lyrics-line-active":e&&this.props.active});return e?s.createElement("a",{className:a,onClick:this._onClick},t):s.createElement("p",{className:a},t)},_onClick:function(){Events.trigger(Events.lyrics.seek,{milliseconds:this.props.milliseconds,index:this.props.index,seek:this.props.seek})}});t.exports=n},{classnames:"classnames",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],154:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=r.ngettext,o=e("../../common/Thumbnail"),l=e("../../common/Favorite"),c=e("../../common/list_items/App"),p=e("../../_mixins/tracking"),d=e("../../_mixins/sort"),u=e("../../_mixins/panel"),h=e("../../_mixins/panelScroll"),m=s.createClass({displayName:"Apps",mixins:[u,d,h,p],panel_name:"apps",scrollbar:{ref:"nano",shouldUpdate:function(e){return this.state.list.length!==e.list.length}},getInitialState:function(){return{list:userData.data.FAVORITES_APPLICATIONS?userData.data.FAVORITES_APPLICATIONS.data.slice(0):[],suggest:userData.data.DEFAULT_APPLICATIONS?userData.data.DEFAULT_APPLICATIONS.data.slice(0):[]}},componentDidMount:function(){Events.subscribe(Events.user.addFavorite,function(e,t){"application"===t.type&&this.setState({list:userData.data.FAVORITES_APPLICATIONS.data.slice(0)})}.bind(this),"panel_application"),Events.subscribe(Events.user.deleteFavorite,function(e,t){"application"===t.type&&this.setState({list:userData.data.FAVORITES_APPLICATIONS.data.slice(0)})}.bind(this),"panel_application")},componentWillUnmount:function(){Events.unsubscribeAll("panel_application")},shouldComponentUpdate:function(e,t){return e.selected!==this.props.selected||t.suggest!==this.state.suggest||t.list.length!==this.state.list.length},render:function(){var e=this.sort(this.state.list,"APP_NAME");return this.renderPanel(s.createElement("div",{className:"panel-apps"},s.createElement("div",{className:"panel-header"},s.createElement("h1",{className:"panel-heading heading-2"},s.createElement("span",{className:"color-primary"},breakUpThousands(e.length))," "+n("application","applications",{count:e.length}))),this.renderScrollbar({"panel-body":!0},[this._renderSuggest(this.state.suggest),this._renderContent(e)])))},_onAppClick:function(e){e.preventDefault(),e.stopPropagation(),loadBox(dom.dataset(e.currentTarget,"url")),this.tracking("panel_click",e.currentTarget)},_onDiscoverClick:function(e){e.preventDefault(),e.stopPropagation(),loadBox(e.currentTarget.getAttribute("href")),this.tracking("panel_click",e.currentTarget)},_getSuggestUrl:function(){var e=this.state.suggest[0],t=""!==e.INAPP_ALIAS?e.INAPP_ALIAS:e.APP_ID;return"app/"+t},_renderContent:function(e){return e=e||[],s.createElement("div",{className:"nano-card-list",key:"apps-list"},s.createElement("li",{className:"nano-card-item nano-card-plus"},s.createElement("a",{key:"discover_link",href:"/appstudio","data-type":"all_apps",onClick:this._onDiscoverClick},s.createElement("div",{className:"nano-card-picture"},s.createElement("span",{className:"icon icon-16 icon-add"})),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},i("Découvrir nos apps")),s.createElement("div",{className:"heading-4-sub ellipsis"},i("100 % musique & jeux !"))))),e.map(function(e){var t=$.extend({},e);return s.createElement(c,{data:t,key:"app_"+e.APP_ID})}))},_renderSuggest:function(e){return 0===e.length?null:(e=e[0],s.createElement("div",{key:"suggest",className:"app-suggest",onClick:this._onAppClick,"data-type":"suggested_apps","data-url":this._getSuggestUrl(),"data-id":e.APP_ID},s.createElement("h2",{className:"panel-heading-sub heading-4"},i("Deezer vous recommande :")),s.createElement(o,{type:"app",id:Number(e.APP_ID),md5:e.APP_PICTURE,height:120,width:320}),s.createElement("ul",{className:"nano-card-list"},s.createElement("li",{className:"nano-card-item"},s.createElement("div",{className:"nano-card-options"},s.createElement(l,{type:"application",context:"appsuggest",id:e.APP_ID})),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/"+this._getSuggestUrl()},e.NAME)),s.createElement("div",{className:"heading-4-sub ellipsis"},s.createElement("a",{href:"/"+this._getSuggestUrl()},e.DESCRIPTION)))))))}});t.exports=m},{"../../../core/i18n":245,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/sort":43,"../../_mixins/tracking":45,"../../common/Favorite":119,"../../common/Thumbnail":130,"../../common/list_items/App":143,react:"react"}],143:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=e("../../../core/context_menu"),o=e("../../../core/favorite"),l=e("../../_mixins/tracking"),c=e("../Thumbnail"),p=s.createClass({displayName:"App",propTypes:{data:s.PropTypes.object,display_add:s.PropTypes.bool,display_remove:s.PropTypes.bool},mixins:[l],getDefaultProps:function(){return{display_add:!1,display_remove:!0}},shouldComponentUpdate:function(e){return e.data.APP_ID!==this.props.data.APP_ID},getTrackingParams:function(){return{type:"app",id:this.props.data.APP_ID}},render:function(){return s.createElement("li",{className:"nano-card-item",onClick:this._onSelect},s.createElement("div",{className:"nano-card-picture"},s.createElement(c,{id:Number(this.props.data.APP_ID),type:"app",md5:this.props.data.APP_PICTURE,height:56,width:87,play_link:!0,overlay:!1})),s.createElement("div",{className:"nano-card-options"},this._renderAdd(),this._renderRemove()),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/app/"+this._getAppAlias()},this.props.data.NAME))))},_renderAdd:function(){return this.props.display_add?s.createElement("a",{className:"option-hide",onClick:this._onAdd},s.createElement("span",{className:"icon icon-options"})):void 0},_renderRemove:function(){return this.props.display_remove?s.createElement("a",{className:"option-hide",onClick:this._onRemove,"data-tooltip":"1","data-tooltip-gravity":"n","data-tooltip-delay":"400",title:i("Retirer de Ma musique")},s.createElement("span",{className:"icon icon-cancel"})):void 0},_onSelect:function(e){e.preventDefault();var t=e.target.getAttribute("href");null===t&&(t="/app/"+this._getAppAlias()),loadBox(t),this.tracking("panel_click",e.currentTarget)},_onAdd:function(e){e.preventDefault(),e.stopPropagation(),n.open({target:e.currentTarget,id:this.props.data.APP_ID,type:"app",data:this.props.data,position:"right"})},_onRemove:function(e){e.preventDefault(),e.stopPropagation(),o.remove({id:this.props.data.APP_ID,type:"application"})},_getAppAlias:function(){return""===this.props.data.INAPP_ALIAS?this.props.data.APP_ID:this.props.data.INAPP_ALIAS}});t.exports=p},{"../../../core/context_menu":242,"../../../core/favorite":243,"../../../core/i18n":245,"../../_mixins/tracking":45,"../Thumbnail":130,react:"react"}],153:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("../../../core/i18n"),n=i.gettext,o=i.ngettext,l=e("../../common/Selectbox"),c=e("../../common/list_items/Album"),p=e("../../_mixins/sort"),d=e("../../_mixins/panel"),u=e("../../_mixins/panelScroll"),h=s.createClass({displayName:"Albums",mixins:[d,p,u],panel_name:"albums",scrollbar:{ref:"nano",shouldUpdate:function(e){return this.state.list.length!==e.list.length}},getInitialState:function(){return{list:userData.data.FAVORITES_ALBUMS.data.slice(0),sort_type:USER.SETTING.site.sort_panel_album||"ART_NAME",nb_display:50,filter:""}},componentDidMount:function(){Events.subscribe(Events.user.addFavorite,function(e,t){"album"===t.type&&this.setState({list:userData.data.FAVORITES_ALBUMS.data.slice(0)})}.bind(this),"panel_album"),Events.subscribe(Events.user.deleteFavorite,function(e,t){"album"===t.type&&this.setState({list:userData.data.FAVORITES_ALBUMS.data.slice(0)})}.bind(this),"panel_album"),this.scrollbar_onEnd(this._displayMore),this.subscribeOnOpen(function(){this.setState({filter:""})}.bind(this))},componentWillUnmount:function(){Events.unsubscribeAll("panel_album")},shouldComponentUpdate:function(e,t){return e.selected!==this.props.selected||t.filter!==this.state.filter||t.nb_display!==this.state.nb_display||t.sort_type!==this.state.sort_type||t.list.length!==this.state.list.length},render:function(){return this._refreshCurrentList(),this.renderPanel(s.createElement("div",{className:"panel-albums"},s.createElement("div",{className:"panel-header"},this._renderTitle(),this.state.list.length?this._renderActions():null),this.renderScrollbar({"panel-body":!0},[this._renderContent()])))},_current_list:[],_display_more_enabled:!0,_refreshCurrentList:function(){var e=this.sort(this.state.list,this.state.sort_type),t=this.state.filter.toLowerCase().trim();t&&(e=e.filter(function(e){return e.ALB_TITLE.toLowerCase().indexOf(t.toLowerCase())>-1||e.ART_NAME.toLowerCase().indexOf(t.toLowerCase())>-1})),e=e.slice(0,this.state.nb_display),this._current_list=e},_onSortTypeChange:function(e){this.setState({sort_type:e})},_onFilterChange:function(e){this.setState({filter:e.target.value},function(){this.refreshScrollbar()})},_renderTitle:function(){var e=this.state.list.length;return 0===e?s.createElement("h1",{className:"panel-heading heading-2"},s.createElement("span",{className:"color-primary"},breakUpThousands(e))," "+o("album","albums",{count:e})):s.createElement("h1",{className:"panel-heading heading-2"},s.createElement("a",{href:"/profile/"+USER.USER_ID+"/albums",className:"evt-click"},s.createElement("span",{className:"color-primary"},breakUpThousands(e))," "+o("album","albums",{count:e}),s.createElement("span",{className:"icon icon-arrow-right"})))},_renderActions:function(){return s.createElement("div",{className:"action form-inline",key:"actions"},s.createElement("div",{className:"form-group"},s.createElement("input",{className:"form-control input-small empty-filter",type:"text",onChange:this._onFilterChange,placeholder:n("Filtrer"),value:this.state.filter})),this.state.list.length?s.createElement("div",{className:"form-group"},s.createElement(l,{type:"album",onChange:this._onSortTypeChange})):"")},_renderContent:function(){return s.createElement("ul",{key:"album-list",className:"nano-card-list"},this._current_list.map(function(e,t){var a=r.extend({},e);return s.createElement(c,{data:a,key:"album_"+e.ALB_ID+t,display_favorite:!1,display_add:!0,context:"menu_panel_album"})}))},_displayMore:function(){return this._display_more_enabled===!1||this.state.nb_display>this._current_list.length?!1:(this._display_more_enabled=!1,this.setState({nb_display:this.state.nb_display+50},function(){this._display_more_enabled=!0}),!0)}});t.exports=h},{"../../../core/i18n":245,"../../_mixins/panel":40,"../../_mixins/panelScroll":41,"../../_mixins/sort":43,"../../common/Selectbox":126,"../../common/list_items/Album":142,jquery:"jquery",react:"react"}],41:[function(e,t,a){"use strict";var s=e("jquery"),r=e("classnames"),i=e("react"),n=e("../../core/EventDispatcher"),o={componentWillMount:function(){this.scrollbar.shouldUpdate=this.scrollbar.shouldUpdate.bind(this)},componentDidMount:function(){this.hasScrollbar()&&this.refreshScrollbar()},componentWillUnmount:function(){s(this.refs[this.scrollbar.ref]).unbind("scrollend")},componentDidUpdate:function(e,t){this.scrollbarShouldUpdate(t)&&(this.isActive()?this.refreshScrollbar():this.onOpenEvent.subscribe(this.delayedRefreshScrollbar))},scrollbarShouldUpdate:function(e){return this.scrollbar.shouldUpdate(e)},hasScrollbar:function(){return"undefined"!=typeof this.scrollbar},scrollbar_endEvent:null,scrollbar_onEnd:function(e){null===this.scrollbar_endEvent&&(this.scrollbar_endEvent=new n,s(this.refs[this.scrollbar.ref]).bind("scrollend",function(){this.scrollbar_endEvent.trigger()}.bind(this))),this.scrollbar_endEvent.subscribe(e)},scrollbar_offEnd:function(e){return null===this.scrollbar_endEvent?!0:void this.scrollbar_endEvent.unSubscribe(e)},refreshScrollbar:function(){s(this.refs[this.scrollbar.ref]).nanoScroller()},delayedRefreshScrollbar:function(){this.refreshScrollbar(),this.onOpenEvent.unSubscribe(this.delayedRefreshScrollbar)},renderScrollbar:function(e,t){e[this.scrollbar.ref]=!0;var a=r(e);return i.createElement("div",{className:a,ref:this.scrollbar.ref},i.createElement("div",{className:"nano-content",ref:"nano_content"},i.createElement("div",{className:"nano-wrapper"},t)))}};t.exports=o},{"../../core/EventDispatcher":239,classnames:"classnames",jquery:"jquery",react:"react"}],40:[function(e,t,a){"use strict";var s=e("react"),r=e("../../core/EventDispatcher"),i={childContextTypes:{panel_name:s.PropTypes.string},getChildContext:function(){return{panel_name:this.panel_name}},onOpenEvent:null,openPanel:function(){this.onOpenEvent.trigger()},subscribeOnOpen:function(e){this.onOpenEvent.subscribe(e)},componentWillMount:function(){this.onOpenEvent=new r},componentDidMount:function(){Events.trigger(Events.menu.panel_mounted,this.panel_name)},isActive:function(){return this.props.selected===this.panel_name},renderPanel:function(e){return s.createElement("div",{className:"panel-content","data-panel":this.panel_name,style:this.isActive()?{display:"block"}:{},"aria-hidden":this.isActive()},e)}};t.exports=i},{"../../core/EventDispatcher":239,react:"react"}],150:[function(e,t,a){"use strict";var s=e("babel-runtime/core-js/object/keys")["default"],r=e("react"),i=e("classnames"),n=e("jquery"),o=e("../../core/i18n"),l=o.gettext,c=o.ngettext,p=e("../../core/modal"),d=e("../../core/genre"),u=e("../common/Badge"),h=e("../player/Player"),m=e("./SearchBar"),_=e("../_mixins/tracking"),y=r.createClass({displayName:"Menu",mixins:[_],getInitialState:function(){return{pages:this._getPagesState(),panels:this._getPanelsState(),player_ready:!1,unseenPlaylistCount:0,new_home_abtest:!gatekeeper.isAllowed("new_popular_musics")||gatekeeper.isAllowed("new_home_de")||gatekeeper.isAllowed("new_home_en")||"object"!=typeof USER.ABTEST.new_home?"default":USER.ABTEST.new_home.option,topGenre:0}},componentWillMount:function(){this._custo.active="object"==typeof CUSTO&&"object"==typeof CUSTO.logos&&"string"==typeof CUSTO.logos.logo_position&&""!==CUSTO.logos.header.trim(),this._custo.active&&(this._custo.position=CUSTO.logos.logo_position),Events.unsubscribe(Events.playlist.seen,this.updateUnseenPlaylists)},componentDidMount:function(){this._onPageChanged(www.getCurrentPath()),n(this.refs.navigation).nanoScroller(),Events.subscribe(Events.navigation.page_displayed,this._pageDisplayed),Events.subscribe(Events.menu.closeAllPanels,this._onClosePanels),Events.subscribe(Events.menu.openPanel,this._onOpenPanel),Events.subscribe(Events.menu.togglePanel,this._onTogglePanel),Events.ready(Events.player.playerReady,this._onPlayerReady),Events.ready(Events.user.userReady,this.updateUnseenPlaylists),Events.ready(Events.user.userReady,this.updateTopGenre),Events.subscribe(Events.playlist.seen,this.updateUnseenPlaylists,"panel_playlist")},shouldComponentUpdate:function(e,t){if(t.player_ready!==this.state.player_ready||t.unseenPlaylistCount!==this.state.unseenPlaylistCount)return!0;var a,r;return r=s(t.pages).some(function(e){return t.pages[e]!==this.state.pages[e]}.bind(this)),a=s(t.panels).some(function(e){return t.panels[e]!==this.state.panels[e]}.bind(this)),r||a},componentWillUnmount:function(){Events.unsubscribe(Events.navigation.page_displayed,this._pageDisplayed),Events.unsubscribe(Events.menu.closeAllPanels,this._onClosePanels),Events.unsubscribe(Events.menu.openPanel,this._onOpenPanel),Events.unsubscribe(Events.menu.togglePanel,this._onTogglePanel)},updateUnseenPlaylists:function(){this.setState({unseenPlaylistCount:userData.getUnseenPlaylistCount()})},updateTopGenre:function(){var e=userData.getTopGenre();if(0===e){var t=d.getList(d.FILTER_MUSIC);e=t.length>1?t[1].GENRE_ID:132}this.setState({topGenre:e})},isPanelOpen:function(e){return e&&this._panels[e]?this._panels[e].active:!1},render:function(){var e=i({"sidebar-container":!0,"has-partner":this._custo.active&&"right"===this._custo.position,"has-partner-large":this._custo.active&&"bottom"===this._custo.position});return r.createElement("div",{className:e},r.createElement("div",{className:"brand"},r.createElement("a",{className:"logo logo-deezer",onClick:USER.USER_ID>0?this._onMenuItemClick:!1,href:"/"}),this._custo.active?r.createElement("a",{className:"logo-partner",href:CUSTO.logos.logo_link,target:"_blank"},r.createElement("img",{src:CUSTO.logos.header})):""),r.createElement(m,{active:"active-panel"===this.state.panels.search}),r.createElement("div",{className:"navigation nano",id:"menu_navigation",ref:"navigation"},r.createElement("div",{className:"nano-content"},r.createElement("ul",{className:"nav nav-main"+(this._hasOpenPanel()?" panel-opened":"")},USER.USER_ID>0?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.home,onClick:this._onMenuItemClick,href:"/","data-type":"home"},l("ACCUEIL"))):!1,USER.USER_ID>0&&!user.isKid()?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.feed,onClick:this._onFeedLinkClick,href:"/feed","data-type":"feed"},l("À ÉCOUTER"))):!1,USER.USER_ID>0&&!user.isKid()&&"layoutd"!==this.state.new_home_abtest?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.explore,onClick:this._onMenuItemClick,href:"/explore","data-type":"explore"},l("NOUVEAUTÉS"))):!1,USER.USER_ID>0&&!user.isKid()&&"layoutd"===this.state.new_home_abtest?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.tops,onClick:this._onMenuItemClick,href:"/charts/playlist/genre/0","data-type":"tops"},l("TOPS"))):!1,USER.USER_ID>0&&!user.isKid()&&"layoutd"!==this.state.new_home_abtest?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.charts,onClick:this._onMenuItemClick,href:"/charts","data-type":"tops"},l("TOP PLAYLISTS"))):!1,USER.USER_ID>0&&!user.isKid()&&"layoutd"===this.state.new_home_abtest?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.genres,onClick:this._onMenuItemClick,href:"/charts/playlist/genre/"+this.state.topGenre,"data-type":"genres"},l("GENRES"))):!1,user.isKid()?!1:r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.mixes,onClick:this._onMenuItemClick,href:"/mixes","data-type":"radio"},c("MIX","MIX",{count:2}))),!user.isKid()&&gatekeeper.isAllowed("deezer_pro")?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.pro,onClick:this._onMenuItemClick,href:"/pro","data-type":"pro"},"For Professional")):!1,USER.USER_ID>0&&!user.isKid()&&gatekeeper.isAllowed("talk")?r.createElement("li",null,r.createElement("a",{className:"nav-link ellipsis "+this.state.pages.talk,onClick:this._onMenuItemClick,href:"/shows","data-type":"talk"},l("INFOS & DIVERTISSEMENT"))):!1,USER.USER_ID>0&&!user.isKid()&&gatekeeper.isAllowed("audiobooks")?r.createElement("li",null,r.createElement("a",{className:"nav-link ellipsis "+this.state.pages.audiobooks,onClick:this._onMenuItemClick,href:"/app/audiobooks","data-type":"audiobooks"},l("LIVRES AUDIO"))):!1,USER.USER_ID>0&&gatekeeper.isAllowed("moods")?r.createElement("li",null,r.createElement("a",{className:"nav-link ellipsis "+this.state.pages.moods,onClick:this._onMenuItemClick,href:"/moods","data-type":"moods"},l("MOODS"))):!1,gatekeeper.isAllowed("employee_feature")?r.createElement("li",null,r.createElement("a",{className:"nav-link ellipsis",onClick:this._onBugReportClick},"REPORT A BUG")):!1),this._custo.active&&""!==CUSTO.tab_header.name?r.createElement("div",null,r.createElement("div",{className:"nav-divider"}),r.createElement("ul",{className:"nav"},r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.pages.exclus,href:"/"+CUSTO.tab_header.url,onClick:this._onMenuItemClick},CUSTO.tab_header.name)))):"",r.createElement("div",{className:"nav-divider"}),USER.USER_ID>0?r.createElement("ul",{className:"nav"+(this._hasOpenPanel()?" panel-opened":"")},r.createElement("li",{className:"profile"},r.createElement("a",{className:"nav-link "+this.state.pages.profile,href:"/profile/"+USER.USER_ID,onClick:this._onMenuItemClick,"data-type":"profile"},r.createElement("span",{className:"profile-picture"},r.createElement("img",{id:"naboo_menu_collection_avatar",src:SETTING_DOMAIN_IMG+"/user/"+USER.USER_PICTURE+"/24x24.jpg"})),user.getMultiAccountOptions().ENABLED&&user.getMultiAccountOptions().PARENT?r.createElement("span",{className:"profile-username ellipsis",id:"naboo_menu_collection_user_name"},window.user.getDisplayName(!0)):r.createElement("span",{className:"profile-username ellipsis",id:"naboo_menu_collection_user_name"},l("Ma musique"))),r.createElement("span",{className:"icon icon-16 icon-settings profile-settings "+this.state.panels.settings,"data-type":"settings",onClick:this._onMenuItemClick})),USER.OPTIONS.can_subscribe?r.createElement("li",{className:"subscribe"},this._renderABTestPushMobile()):"",r.createElement("li",null,r.createElement("a",{href:"/profile/"+USER.USER_ID+"/loved",className:"nav-link "+this.state.pages.loved,onClick:this._onMenuItemClick,"data-type":"loved"},r.createElement("span",{className:"icon icon-16 icon-love"}),r.createElement("span",null,l("Coups de cœur")))),r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.panels.playlists,"data-type":"playlists",onClick:this._onMenuItemClick},r.createElement("span",{className:"icon icon-16 icon-playlist"}),r.createElement("span",null,l("Playlists"),r.createElement(u,{counter:this.state.unseenPlaylistCount})))),r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.panels.albums,"data-type":"albums",onClick:this._onMenuItemClick},r.createElement("span",{className:"icon icon-16 icon-album"}),r.createElement("span",null,l("Albums")))),USER.USER_ID>0&&gatekeeper.isAllowed("talk")?r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.panels.shows,"data-type":"shows",onClick:this._onMenuItemClick},r.createElement("span",{className:"icon icon-16 icon-podcast"}),r.createElement("span",null,l("Podcasts")))):"",r.createElement("li",null,r.createElement("a",{className:"nav-link "+this.state.panels.apps,"data-type":"apps",onClick:this._onMenuItemClick},r.createElement("span",{className:"icon icon-16 icon-app"}),r.createElement("span",null,l("Applications"))))):r.createElement("div",{className:"unlogged"},r.createElement("button",{className:"btn btn-primary btn-block evt-click","data-register":"1",type:"button"},r.createElement("span",{className:"label"},l("Inscription"))),r.createElement("button",{className:"btn btn-inverse btn-block evt-click","data-login":"1",type:"button"},r.createElement("span",{className:"label"},l("Connexion"))),r.createElement("div",{className:"divider"},r.createElement("span",{className:"or"},l("ou"))),r.createElement("a",{href:"/company",className:"btn btn-discover btn-block",type:"button",onClick:this._onMenuItemClick,target:"_blank","data-type":"discovery"},r.createElement("span",{className:"label"},l("Découvrir Deezer")),r.createElement("span",{className:"icon icon-arrow-link"}))))),this.state.player_ready?r.createElement(h,{ref:"player"}):"")},_renderABTestPushMobile:function(){var e="undefined"!=typeof USER.OPTIONS.upgrade?USER.OPTIONS.upgrade.offer.duration:0,t="undefined"!=typeof USER.ABTEST.abtest_senttomobile_oldreg?USER.ABTEST.abtest_senttomobile_oldreg.option:"default";return e>0&&"A"===t?r.createElement("button",{className:"btn btn-primary btn-block",type:"button","data-modal":"/lightbox/push_mobile?context=button_menu",onClick:this._onMenuItemClick},r.createElement("span",{className:"label"},c("%s JOUR OFFERT","%s JOURS OFFERTS",{count:e,sprintf:[e]}))):r.createElement("button",{href:"/offers",className:"btn btn-primary btn-block",type:"button",onClick:this._onMenuItemClick,target:"_blank","data-type":"offers_subscribe"},r.createElement("span",{className:"icon icon-add"}),r.createElement("span",{className:"label"},l("S'ABONNER")))},_onPlayerReady:function(){this.setState({player_ready:!0})},_onFeedLinkClick:function(e){e.preventDefault(),e.stopPropagation(),feed.flushCache(),this._onMenuItemClick(e)},_onMenuItemClick:function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.getAttribute("href"),a=e.currentTarget.getAttribute("target"),s=dom.dataset(e.currentTarget,"type"),r=dom.dataset(e.currentTarget,"modal");return this.tracking("menu_click",e.currentTarget),null!==t?(Events.trigger(Events.menu.closeAllPanels),void("_blank"===a?window.open(t):loadBox(t))):"undefined"!=typeof r?void p.open(r):"undefined"!=typeof s?void Events.trigger(Events.menu.togglePanel,s):void 0},_onBugReportClick:function(e){e.preventDefault();var t=window.ATL_JQ_SHOW_DIALOG;"function"==typeof t&&t()},_onClosePanels:function(){for(var e in this._panels)this._panels.hasOwnProperty(e)&&(this._panels[e].active=!1);this.setState({panels:this._getPanelsState()}),this.refs.player&&this.refs.player.setState({queuelist_opened:!1,lyrics_opened:!1})},_onOpenPanel:function(e,t){for(var a in this._panels)this._panels.hasOwnProperty(a)&&(this._panels[a].active=t===a);this.setState({panels:this._getPanelsState()}),this.refs.player&&this.refs.player.setState({queuelist_opened:this._panels.queuelist.active,lyrics_opened:this._panels.lyrics.active})},_onTogglePanel:function(e,t){this.isPanelOpen(t)?Events.trigger(Events.menu.closeAllPanels):Events.trigger(Events.menu.openPanel,t)},_onPageChanged:function(e){var t;for(var a in this._pages)this._pages.hasOwnProperty(a)&&(t=!0,t=t&&this._pages[a].pattern.test(e),"undefined"!=typeof this._pages[a].pattern_not&&(t=t&&!this._pages[a].pattern_not.test(e)),this._pages[a].selected=t);this.setState({pages:this._getPagesState()})},_hasOpenPanel:function(){for(var e in this._panels)if(this._panels.hasOwnProperty(e)&&this._panels[e].active===!0)return!0;return!1},_pages:{home:{pattern:/^\/?$/i,selected:!1},feed:{pattern:/^\/feed?$/i,selected:!1},loved:{pattern:new RegExp("^/profile/"+USER.USER_ID+"/loved","i"),selected:!1},profile:{pattern:new RegExp("^/profile/"+USER.USER_ID+"[^0-9]*(/.*)?$","i"),pattern_not:new RegExp("^/profile/"+USER.USER_ID+"/loved","i"),selected:!1},explore:{pattern:/^\/explore/i,selected:!1},charts:{pattern:/^\/charts/i,selected:!1},tops:{pattern:/^\/charts\/[a-z]+((\/genre\/0)|$)/i,selected:!1},genres:{pattern:/^\/charts\/[a-z]+\/genre\/[1-9][0-9]*/i,selected:!1},mixes:{pattern:/^\/mixes/i,selected:!1},exclus:{pattern:/^\/exclus/i,selected:!1},pro:{pattern:/^\/pro\/?$/i,selected:!1},talk:{pattern:/^\/shows/i,selected:!1},audiobooks:{pattern:/^\/app\/audiobooks/i,selected:!1},moods:{pattern:/^\/(moods)/i,selected:!1}},_panels:{searchhistory:{active:!1},searchsuggest:{active:!1},playlists:{active:!1},albums:{active:!1},shows:{active:!1},loved:{active:!1},apps:{active:!1},queuelist:{active:!1},settings:{active:!1},lyrics:{active:!1}},_custo:{active:!1,large:!1},_getPagesState:function(){var e={};for(var t in this._pages)this._pages.hasOwnProperty(t)&&(e[t]=this._pages[t].selected===!0?"active-link":"");return e},_getPanelsState:function(){var e={};for(var t in this._panels)this._panels.hasOwnProperty(t)&&(e[t]=this._panels[t].active===!0?"active-panel":"");return e},_pageDisplayed:function(e,t){this._onPageChanged(t?t.path:www.getCurrentPath()),this._hasOpenPanel()&&Events.trigger(Events.menu.closeAllPanels)}});t.exports=y},{"../../core/genre":244,"../../core/i18n":245,"../../core/modal":247,"../_mixins/tracking":45,"../common/Badge":57,"../player/Player":193,"./SearchBar":152,"babel-runtime/core-js/object/keys":289,classnames:"classnames",jquery:"jquery",react:"react"}],193:[function(e,t,a){"use strict";var s=e("react"),r=e("./_elements/Cover"),i=e("./_elements/ControlBar"),n=e("../_mixins/control"),o=s.createClass({displayName:"Player",mixins:[n],render:function(){return s.createElement("div",{className:"player",id:"player"},s.createElement(r,{lyrics_opened:this.state.lyrics_opened}),s.createElement(i,{queuelist_opened:this.state.queuelist_opened}))}});t.exports=o},{"../_mixins/control":36,"./_elements/ControlBar":198,"./_elements/Cover":199,react:"react"}],199:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../_mixins/currentSong"),n=e("../../_mixins/currentType"),o=e("../../_mixins/control"),l=e("./Title"),c=e("./Action"),p=e("./TimeBar"),d=s.createClass({displayName:"Cover",propTypes:{lyrics_opened:s.PropTypes.bool.isRequired},mixins:[i,n,o],componentWillUpdate:function(e,t){this.state.track.SNG_ID!==t.track.SNG_ID&&this.refs.action.closeContextMenu()},render:function(){var e=SETTING_STATIC+"/images/common/ads/player.jpg",t=r({"player-options":!0,hide:"ads"===this.state.type||this.state.track_type!==dzPlayer.MEDIA_TYPE_SONG});return"ads"!==this.state.type&&(e=SETTING_DOMAIN_IMG+"/cover/",this.state.track_type===dzPlayer.MEDIA_TYPE_TALK?e=SETTING_DOMAIN_IMG+"/talk/"+this.state.track.SHOW_ART_MD5:playercontrol.blindTestMode||"string"!=typeof this.state.track.ALB_PICTURE||(e+=this.state.track.ALB_PICTURE),e+="/250x250.jpg"),(this.state.track_type===dzPlayer.MEDIA_TYPE_EXTERNAL||this.state.track_type===dzPlayer.MEDIA_TYPE_LIVE_STREAM)&&(e=this.state.track.PICTURE_URL),s.createElement("div",{className:"player-cover",id:"player-cover"},s.createElement("img",{src:e,height:"220",width:"220",alt:""}),s.createElement(l,null),s.createElement(c,{ref:"action",lyrics_opened:this.props.lyrics_opened}),s.createElement(p,null),s.createElement("a",{className:t,"data-action":"add",role:"button",onClick:this.action},s.createElement("span",{className:"icon icon-options"})),s.createElement("div",{className:"player-overlay","data-action":"seek",role:"button",onClick:this.action}))}});t.exports=d},{"../../_mixins/control":36,"../../_mixins/currentSong":37,"../../_mixins/currentType":38,"./Action":194,"./TimeBar":202,"./Title":203,classnames:"classnames",react:"react"}],203:[function(e,t,a){"use strict";var s=e("react"),r=e("../../_mixins/control"),i=e("./SongTitle"),n=e("./ArtistName"),o=s.createClass({displayName:"Title",mixins:[r],render:function(){return s.createElement("div",{className:"player-track","data-action":"seek",onClick:this.action},s.createElement(i,null),s.createElement(n,null))}});t.exports=o},{"../../_mixins/control":36,"./ArtistName":195,"./SongTitle":201,react:"react"}],201:[function(e,t,a){"use strict";var s=e("react"),r=e("../../_mixins/currentSong"),i=e("../../_mixins/currentType"),n=e("../../_mixins/control"),o=s.createClass({displayName:"SongTitle",mixins:[r,i,n],render:function(){if(playercontrol.blindTestMode)return s.createElement("h2",{className:"player-track-title heading-2"},"???");if("ads"===this.state.type){var e={title:null===dzPlayer.getAudioAds()?"":dzPlayer.getAudioAds().textlink.text,link:null===dzPlayer.getAudioAds()?"":dzPlayer.getAudioAds().tracking.clickCommand};return s.createElement("h2",{className:"player-track-title heading-2 ads"},s.createElement("a",{className:"player-track-link","data-action":"link","data-href":e.link,onClick:this.action},e.title))}var t=this.state.track_type===dzPlayer.MEDIA_TYPE_TALK?this.state.track.EPISODE_TITLE:this.state.track.SNG_TITLE;"string"==typeof this.state.track.VERSION&&this.state.track.VERSION.length>0&&(t+=" "+this.state.track.VERSION),window.document.title=t;var a="";return this.state.track_type===dzPlayer.MEDIA_TYPE_TALK?a="/show/"+this.state.track.SHOW_ID:Number(this.state.track.ALB_ID)>0&&(a="/album/"+this.state.track.ALB_ID),s.createElement("h2",{className:"player-track-title heading-2"},s.createElement("span",{className:"player-track-link","data-action":"link","data-href":a,onClick:this.action},t))}});t.exports=o},{"../../_mixins/control":36,"../../_mixins/currentSong":37,"../../_mixins/currentType":38,react:"react"}],195:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=e("../../_mixins/currentSong"),o=e("../../_mixins/currentType"),l=e("../../_mixins/control"),c=s.createClass({displayName:"ArtistName",mixins:[n,o,l],render:function(){var e=this.state.track.ARTISTS||[];if("ads"===this.state.type)return s.createElement("div",null);if(this.state.track_type===dzPlayer.MEDIA_TYPE_TALK)return s.createElement("h3",{className:"player-track-artist heading-2-sub ellipsis"},s.createElement("span",{className:"player-track-link","data-action":"link","data-href":"/show/"+this.state.track.SHOW_ID,onClick:this.action},this.state.track.SHOW_NAME));if(this.state.track_type===dzPlayer.MEDIA_TYPE_EXTERNAL||this.state.track_type===dzPlayer.MEDIA_TYPE_LIVE_STREAM)return s.createElement("h3",{className:"player-track-artist heading-2-sub ellipsis"},s.createElement("span",{className:"player-track-link"},this.state.track.ART_NAME));0===e.length&&e.push({ART_NAME:this.state.track.ART_NAME,ART_ID:this.state.track.ART_ID});var t={};return s.createElement("h3",{className:"player-track-artist heading-2-sub ellipsis"},i("par")," ",e.map(function(e,a){return"boolean"==typeof t[e.ART_ID]?[]:(t[e.ART_ID]=!0,playercontrol.blindTestMode?"???":(window.document.title+=" - "+e.ART_NAME,[a>0?", ":"",s.createElement("span",{className:"player-track-link","data-action":"link",key:"artist_"+e.ART_ID,"data-href":0!==e.ART_ID?"/artist/"+e.ART_ID:"",onClick:this.action},e.ART_NAME)]))}.bind(this)))}});t.exports=c},{"../../../core/i18n":245,"../../_mixins/control":36,"../../_mixins/currentSong":37,"../../_mixins/currentType":38,react:"react"}],202:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("../../_mixins/playing"),n=e("../../_mixins/control"),o=s.createClass({displayName:"TimeBar",propTypes:{dragging:s.PropTypes.bool},mixins:[i,n],getDefaultProps:function(){return{dragging:!1}},componentDidMount:function(){var e=this;r(this.refs.seek).draggable({axis:"x",containment:"parent",start:function(){e.props.dragging=!0},stop:function(t,a){e.props.dragging=!1,dzPlayer.isPlaying()?dzPlayer.control.seek(a.position.left/t.target.parentNode.offsetWidth):r(this).css("left",e.cursorPosition())}}),Events.subscribe(Events.player.changePlayerType,function(){r(this.refs.seek).draggable(this.seekAllowed()?"enable":"disable")}.bind(this),"player")},cursorPosition:function(){var e=Math.min(this.state.position,this.state.duration);return e>0?Math.floor(100*e/this.state.duration)+"%":"0%"},seek:function(e){this.seekAllowed()&&dzPlayer.control.seek(e.pageX/e.currentTarget.parentNode.offsetWidth)},render:function(){var e=this.cursorPosition(),t={};return this.props.dragging||(t.left=e),s.createElement("div",{className:"player-progress",role:"progressbar"},s.createElement("div",{className:"progress progress-background"}),s.createElement("div",{className:"progress progress-buffer",style:{width:this.state.buffer+"%"},onClick:this.action,"data-action":"seek"}),s.createElement("div",{className:"progress progress-seek",style:{width:e},onClick:this.action,"data-action":"seek"},s.createElement("div",{className:"progress-seek-overlay"})),s.createElement("div",{className:"progress-handler",style:t,ref:"seek"}),s.createElement("div",{className:"progress-time"},secToMin(this.state.position)),s.createElement("div",{className:"progress-length"},secToMin(this.state.duration)))}});t.exports=o},{"../../_mixins/control":36,"../../_mixins/playing":42,jquery:"jquery",react:"react"}],194:[function(e,t,a){"use strict";var s=e("babel-runtime/helpers/extends")["default"],r=e("react"),i=e("classnames"),n=e("../../../core/i18n"),o=n.gettext,l=e("../../_mixins/currentSong"),c=e("../../_mixins/currentType"),p=e("../../_mixins/notification"),d=e("../../_mixins/control"),u=e("../../common/Dislike"),h=e("../../common/Favorite"),m=r.createClass({displayName:"Action",propTypes:{lyrics_opened:r.PropTypes.bool},mixins:[l,d,c,p],render:function(){var e=this.state.type,t=dzPlayer.isRadio(),a=dzPlayer.helper.isPlayingFlow()?"flow":null,n="undefined"!=typeof this.state.track.LYRICS_ID&&0!==this.state.track.LYRICS_ID,l=[];if("ads"!==e&&this.state.track_type===dzPlayer.MEDIA_TYPE_SONG){var c=i({"evt-out evt-over action action-hide":!0,disabled:this.state.track.SNG_ID<0}),p=i({"icon icon-lyrics":!0,disabled:this.state.track.SNG_ID<0,active:this.props.lyrics_opened}),d={"data-tooltip":1,"data-tooltip-delay":700,"data-tooltip-offset":2,"data-tooltip-gravity":"sw"},m=r.createElement(h,{type:"song",style:"heart",context:"player",tooltip:!0,tooltip_gravity:"sw",id:String(this.state.track.SNG_ID),overlay:!1,key:this.state.track.SNG_ID,onClickCallback:this._onFavoriteClick,share_context:a}),_=r.createElement(u,{tooltip:!0,tooltip_gravity:"sw",style:"heart",id:this.state.track.SNG_ID,overlay:!1,key:"dislike_"+this.state.track.SNG_ID,onClickCallback:this._onDislikeClick}),y=r.createElement("a",s({className:c,onClick:this.action,key:"add_playlist_"+this.state.track.SNG_ID,role:"button","data-action":"playlist","data-tooltip-fallback":o("Ajouter à une playlist")},d),r.createElement("span",{className:"icon-32 icon-stack icon-stack-circle"},r.createElement("span",{className:"icon icon-playlist-add"})));d.title=o(this.props.lyrics_opened?"Masquer les paroles":"Afficher les paroles");var g=r.createElement("a",s({className:"evt-out evt-over action",onClick:this.action,key:"lyrics_"+this.state.track.SNG_ID,role:"button","data-action":"lyrics"},d),r.createElement("span",{className:"icon-32 icon-stack icon-stack-circle",id:"player-lyrics"},r.createElement("span",{className:p})));l=[m],t&&l.unshift(_),n&&l.push(g),t||l.push(y)}return r.createElement("div",{className:"player-actions clearfix","data-action":"seek",onClick:this.action},l.map(function(e,t){return[e,t===l.length-1]}))},_onDislikeClick:function(){return dzPlayer.skipRadioAllowed()?(this.displayNotification("dislike"),void setTimeout(dzPlayer.control.nextSong,300)):this.notify_already_displayed?!1:(this.notify_already_displayed=!0,notificationBar.display("flow_skip_push",{}),!1)},_onFavoriteClick:function(e,t,a){a&&this.displayNotification("like")}});t.exports=m},{"../../../core/i18n":245,"../../_mixins/control":36,"../../_mixins/currentSong":37,"../../_mixins/currentType":38,"../../_mixins/notification":39,"../../common/Dislike":115,"../../common/Favorite":119,"babel-runtime/helpers/extends":294,classnames:"classnames",react:"react"}],198:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=e("../../_mixins/control"),o=e("../../_mixins/playing"),l=e("../../_mixins/statusButton"),c=e("../../_mixins/currentSong"),p=e("./BottomControl"),d=e("./PlayControl"),u=e("./ChromecastControl"),h=s.createClass({displayName:"ControlBar",propTypes:{queuelist_opened:s.PropTypes.bool.isRequired},mixins:[n,o,l,c],render:function(){var e=i("Précédent"),t=i("Suivant");return s.createElement("div",{className:"player-controls"},s.createElement("ul",{className:"controls controls-main clearfix"},s.createElement("li",null,s.createElement("button",{className:"control control-prev",type:"button",onClick:this.action,"data-action":"prevSong",disabled:this.status("prev"),title:e},s.createElement("span",{className:"icon icon-prev"}))),this.state.track_type===dzPlayer.MEDIA_TYPE_TALK?s.createElement("li",null,s.createElement("button",{className:"control control-prev-30",type:"button",onClick:this.action,"data-action":"backward"},s.createElement("span",{className:"icon icon-prev-30"}))):!1,s.createElement("li",null,s.createElement(d,null)),this.state.track_type===dzPlayer.MEDIA_TYPE_TALK?s.createElement("li",null,s.createElement("button",{className:"control control-next-30",type:"button",onClick:this.action,"data-action":"forward"},s.createElement("span",{className:"icon icon-next-30"}))):!1,s.createElement("li",null,s.createElement("button",{className:"control control-next",type:"button",onClick:this.action,"data-action":"nextSong",disabled:this.status("next"),title:t},s.createElement("span",{className:"icon icon-next"})))),s.createElement(p,{queuelist_opened:this.props.queuelist_opened}),this.state.track_type===dzPlayer.MEDIA_TYPE_SONG?s.createElement(u,null):!1)}});t.exports=h},{"../../../core/i18n":245,"../../_mixins/control":36,"../../_mixins/currentSong":37,"../../_mixins/playing":42,"../../_mixins/statusButton":44,"./BottomControl":196,"./ChromecastControl":197,"./PlayControl":200,react:"react"}],200:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../../core/i18n"),n=i.gettext,o=e("../../_mixins/control"),l=e("../../_mixins/playing"),c=e("../../_mixins/currentSong"),p=e("../../_mixins/statusButton"),d=s.createClass({displayName:"PlayControl",mixins:[o,l,p,c],getInitialState:function(){return{playing:!1,paused:!1}},componentDidMount:function(){Events.subscribe(Events.player.playing,function(e,t){this.setState({playing:t,loading:!1})}.bind(this),"player"),Events.subscribe(Events.player.paused,function(e,t){this.setState({paused:t})}.bind(this),"player"),Events.subscribe(Events.player.finishTrackList,function(){this.setState({playing:!1,paused:!1,loading:!1})}.bind(this),"player")},render:function(){var e=n("Play"),t=n(this.state.track_type===dzPlayer.MEDIA_TYPE_LIVE_STREAM?"Stop":"Pause");if(this.state.paused&&!this.state.playing||!this.state.paused&&!this.state.playing)return s.createElement("button",{className:"control control-play",type:"button",onClick:this.action,"data-action":"play",disabled:this.status("play")||this.state.loading,title:e},s.createElement("span",{className:"icon icon-play"}));var a=r({icon:!0,"icon-pause":this.state.track_type!==dzPlayer.MEDIA_TYPE_LIVE_STREAM,"icon-square-fill":this.state.track_type===dzPlayer.MEDIA_TYPE_LIVE_STREAM}),i=r({control:!0,"control-pause":this.state.track_type!==dzPlayer.MEDIA_TYPE_LIVE_STREAM,"control-stop":this.state.track_type===dzPlayer.MEDIA_TYPE_LIVE_STREAM}),o=this.state.track_type===dzPlayer.MEDIA_TYPE_LIVE_STREAM?"stop":"pause";return s.createElement("button",{className:i,type:"button",onClick:this.action,"data-action":o,disabled:this.status("pause"),title:t},s.createElement("span",{className:a}))}});t.exports=d},{"../../../core/i18n":245,"../../_mixins/control":36,"../../_mixins/currentSong":37,"../../_mixins/playing":42,"../../_mixins/statusButton":44,classnames:"classnames",react:"react"}],196:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("../../../core/i18n"),n=i.gettext,o=e("../../_mixins/playing"),l=e("../../_mixins/control"),c=e("../../_mixins/statusButton"),p=e("../../_mixins/currentSong"),d=e("../../_mixins/currentType"),u=e("../../_mixins/tracking"),h=e("./ChromecastControl"),m=s.createClass({displayName:"BottomControl",mixins:[o,l,c,d,u,p],componentDidMount:function(){var e=this;r(this.refs.volume).draggable({axis:"x",containment:"parent",drag:function(t,a){r(this).is(":visible")&&dzPlayer.control.setVolume(e.getCursorVolume(t,a),!0)},stop:function(t,a){r(this).is(":visible")?dzPlayer.control.setVolume(e.getCursorVolume(t,a),!0):r(this).css("left",e.status("volume"))}}),Events.subscribe(Events.player.changePlayerType,function(e,t){r(this.refs.volume).draggable("ads"!==t?"enable":"disable")}.bind(this),"player")},getCursorVolume:function(e,t){var a=t.position.left/(e.target.parentNode.offsetWidth-4);return a=Math.min(a,1),a=Math.max(a,0)},render:function(){var e=[],t=n("Répéter"),a=n("Aléatoire"),r=n("File d'attente");if(("mod"===this.state.type||"chromecast"===this.state.type&&!chromecast.isRadio())&&(e=this.state.track_type===dzPlayer.MEDIA_TYPE_SONG||this.state.track_type===dzPlayer.MEDIA_TYPE_EXTERNAL?[s.createElement("li",{key:"repeat"},s.createElement("button",{className:"control control-repeat"+this.status("repeat"),type:"button",onClick:this.action,"data-type":"repeat","data-action":"setRepeat",title:t},s.createElement("span",{className:"icon icon-repeat"}),s.createElement("span",{className:"icon icon-repeat-one"}))),s.createElement("li",{key:"shuffle"},s.createElement("button",{className:"control control-shuffle"+this.status("shuffle"),type:"button",onClick:this.action,"data-type":"shuffle","data-action":"setShuffle",title:a},s.createElement("span",{className:"icon icon-shuffle"})))]:this.state.track_type===dzPlayer.MEDIA_TYPE_TALK?[s.createElement("li",{className:"chromecast",key:"chromecast"},s.createElement(h,null))]:[s.createElement("li",{className:"invisible",key:"invisible"})]),"radio"===this.state.type||"chromecast"===this.state.type&&chromecast.isRadio()){var i="user"===dzPlayer.radioType;e=[s.createElement("li",{key:"radio",className:"tag"},s.createElement("span",{className:"sticker sticker-small sticker-flow"},n(i?"FLOW":"MIX")))]}return"ads"===this.state.type&&(e=[s.createElement("li",{key:"ads",className:"tag"},s.createElement("span",{className:"sticker sticker-small sticker-flow"},n("PUBLICITÉ")))]),s.createElement("ul",{className:"controls controls-options clearfix"},s.createElement("li",{className:"volume"},s.createElement("button",{className:"control control-volume"+this.status("mute"),type:"button",onClick:this.action,"data-action":"mute"},s.createElement("span",{className:"icon icon-volume"}),s.createElement("span",{className:"icon icon-volume-min"}),s.createElement("span",{className:"icon icon-volume-off"})),s.createElement("span",{className:"volume-progress",onClick:this.action,"data-action":"setVolume",ref:"volume_bar"},s.createElement("span",{className:"volume-progress-bar"},s.createElement("span",{className:"volume-bar",style:{width:this.status("volume")},onClick:this.action,"data-action":"setVolume"}),s.createElement("span",{className:"volume-handler",style:{left:this.status("volume")},ref:"volume"}))),s.createElement("button",{className:"control control-volume-max",type:"button"},s.createElement("span",{className:"icon icon-volume-max"}))),e,s.createElement("li",null,s.createElement("button",{className:"control "+("chromecast"===this.state.type?"disabled":"")+" control-qlist"+this.status("queue"),type:"button",title:r,onClick:this.action,"data-type":"queuelist","data-action":"queuelist"},s.createElement("span",{className:"icon icon-qlist"}))))}});t.exports=m},{"../../../core/i18n":245,"../../_mixins/control":36,"../../_mixins/currentSong":37,"../../_mixins/currentType":38,"../../_mixins/playing":42,"../../_mixins/statusButton":44,"../../_mixins/tracking":45,"./ChromecastControl":197,jquery:"jquery",react:"react"}],197:[function(e,t,a){"use strict";var s=e("react"),r=e("../../_mixins/chromecast"),i=s.createClass({displayName:"ChromecastControl",mixins:[r],render:function(){var e=this.state.chromecast;chromecast.canCast()||(e="hide");var t,a,r="chromecast-icon",i={hide:"hidden",loading:"loading",connected:"active",show:"",disconnected:""},n=!1;return"show"===e&&(storage.get("CCIntro_"+USER.USER_ID)||(n=!0)),t=r+" "+i[e],a=s.createElement("a",{className:t,title:"Chromecast","data-action":"chromecast",onClick:this._onClick}),n&&(a=s.createElement("div",{className:"chromecast-tooltip"},a)),a},_onClick:function(){"connected"!==chromecast.getStatus()&&Events.trigger(Events.chromecast.status,"show"),storage.set("CCIntro_"+USER.USER_ID,!0),chromecast.launch()}});t.exports=i},{"../../_mixins/chromecast":35,react:"react"}],35:[function(e,t,a){"use strict";var s={getInitialState:function(){return{chromecast:chromecast.getStatus()}},componentDidMount:function(){Events.subscribe(Events.chromecast.status,this._onStatusChange)},componentWillUnmount:function(){Events.unsubscribe(Events.chromecast.status,this._onStatusChange)},_onStatusChange:function(e,t){this.setState({chromecast:t})}};t.exports=s},{}],38:[function(e,t,a){"use strict";var s={getInitialState:function(){return{type:dzPlayer.getPlayerType()}},componentDidMount:function(){Events.subscribe(Events.player.changePlayerType,function(e,t){this.setState({type:t})}.bind(this),"player")}};t.exports=s},{}],44:[function(e,t,a){"use strict";var s={status:function(e){switch(e){case"prev":return("chromecast"===dzPlayer.getPlayerType()&&!chromecast.isRadio()||"mod"===dzPlayer.getPlayerType())&&(dzPlayer.getIndexSong()>0||this.state.repeat>0)&&dzPlayer.getMediaType()!==dzPlayer.MEDIA_TYPE_LIVE_STREAM?"":"disabled";case"next":return"chromecast"!==dzPlayer.getPlayerType()&&"mod"!==dzPlayer.getPlayerType()&&!dzPlayer.isRadio()||dzPlayer.isLastSong()&&!(this.state.repeat>0)||dzPlayer.getMediaType()===dzPlayer.MEDIA_TYPE_LIVE_STREAM?"disabled":"";case"play":case"pause":return"ads"===dzPlayer.getPlayerType()?"disabled":"";case"volume":return this.state.volume+"%";case"mute":return this.state.mute||0===this.state.volume?"-mute":"";case"repeat":return this.state.repeat>0?2===this.state.repeat?"-one active":" active":"";case"shuffle":return this.state.shuffle?" active":"";case"queue":return this.props.queuelist_opened?" active":""}}};t.exports=s},{}],42:[function(e,t,a){"use strict";var s={getInitialState:function(){return{position:0,buffer:0,duration:0,loading:0}},componentDidMount:function(){Events.subscribe(Events.player.position,function(e,t){this.setState({position:t})}.bind(this),"player"),Events.subscribe(Events.player.pourcentLoaded,function(e,t){this.setState({buffer:t})}.bind(this),"player"),Events.subscribe(Events.player.duration,function(e,t){this.setState({duration:t})}.bind(this),"player"),Events.subscribe(Events.player.loading,function(e,t){this.setState({loading:t})}.bind(this),"player")}};t.exports=s},{}],37:[function(e,t,a){"use strict";function s(){var e=dzPlayer.getCurrentSong();return{track:e||{},track_type:dzPlayer.getMediaType(e)}}var r={getInitialState:function(){return s()},componentDidMount:function(){Events.subscribe(Events.player.displayCurrentSong,this._onSongChange,"currentSongMixin"),Events.subscribe(Events.player.blind_test_mode_changed,this._onSongChange,"currentSongMixin")},componentWillUnmount:function(){Events.unsubscribeAll("currentSongMixin")},_onSongChange:function(){this.setState(s())}};t.exports=r},{}],36:[function(e,t,a){"use strict";var s=e("jquery"),r=e("../../core/context_menu"),i={getInitialState:function(){return{volume:100*dzPlayer.getVolume(),shuffle:dzPlayer.isShuffle(),repeat:dzPlayer.getRepeat(),mute:dzPlayer.isMuted(),queuelist_opened:!1,lyrics_opened:!1}},componentWillUnmount:function(){Events.unsubscribe(Events.player.changePlayerType,this._onChangePlayerType),Events.unsubscribe(Events.player.repeat_changed,this._onChangeRepeat),Events.unsubscribe(Events.player.shuffle_changed,this._onChangeShuffle),Events.unsubscribe(Events.player.volume_changed,this._onChangeVolume),Events.unsubscribe(Events.player.mute_changed,this._onChangeMute)},componentDidMount:function(){Events.subscribe(Events.player.changePlayerType,this._onChangePlayerType,"player"),Events.subscribe(Events.player.repeat_changed,this._onChangeRepeat,"player"),Events.subscribe(Events.player.shuffle_changed,this._onChangeShuffle,"player"),Events.subscribe(Events.player.volume_changed,this._onChangeVolume,"player"),Events.subscribe(Events.player.mute_changed,this._onChangeMute,"player")},action:function(e){e.preventDefault(),e.stopPropagation();var t=dom.dataset(e.currentTarget),a=e.currentTarget.className,i=dzPlayer.helper.isPlayingFlow()?"flow":"";if("string"==typeof t.action&&-1===a.indexOf("disabled")){var n,o=[],l=t.action;switch(t.action){case"link":""!==t.href&&("http"===t.href.substr(0,4)?window.open(t.href):loadBox(t.href));break;case"setShuffle":o=[!dzPlayer.isShuffle(),!0];break;case"setRepeat":o=[2===dzPlayer.getRepeat()?0:dzPlayer.getRepeat()+1];break;case"share":sharebox.load(0,dzPlayer.getCurrentSong("SNG_ID"));break;case"add":case"playlist":r.open({target:e.target,position:"right",type:"song",view:"playlist"===t.action?"playlist":"home",data:{SONG:dzPlayer.getCurrentSong(),PLAYLIST_ID:dzPlayer.getContext("ID")},id:dzPlayer.getCurrentSong("SNG_ID"),context:"player",share_context:i});break;case"mute":o=[!dzPlayer.isMuted()];break;case"setVolume":var c=(e.pageX-s(e.currentTarget).offset().left)/this.refs.volume_bar.offsetWidth;c=Math.min(c,1),o=[Math.max(c,0),!0];break;case"queuelist":Events.trigger(Events.menu.togglePanel,"queuelist");break;case"lyrics":Events.trigger(Events.menu.togglePanel,"lyrics");break;case"play":if(OFFLINE)return void dzoffline.display();break;case"seek":if(!this.seekAllowed())return;o=[e.pageX/e.currentTarget.parentNode.offsetWidth];break;case"chromecast":"connected"!==chromecast.getStatus()&&Events.trigger(Events.chromecast.status,"show"),storage.set("CCIntro_"+USER.USER_ID,!0),chromecast.launch();break;case"nextSong":dzPlayer.skipRadioAllowed()||notificationBar.display("flow_skip_push",{});break;case"forward":l="seek",n=(dzPlayer.position+30)/dzPlayer.duration,n>=1&&(l="nextSong"),o=[n];break;case"backward":l="seek",n=(dzPlayer.position-30)/dzPlayer.duration,o=[Math.max(n,0)]}this.doTracking(t.action,e),"function"==typeof dzPlayer.control[l]&&dzPlayer.control[l].apply(dzPlayer,o)}},closeContextMenu:function(){r.close("player")},doTracking:function(e,t){if("function"!=typeof this.tracking)return!1;var a={queuelist:!0,setRepeat:!0,setShuffle:!0};return"boolean"!=typeof a[e]?!1:void this.tracking("player_click",t.currentTarget)},seekAllowed:function(){return!(dzPlayer.isRadio()&&!USER.OPTIONS.web_hq||"chromecast"===dzPlayer.getPlayerType()&&chromecast.isRadio()||"ads"===dzPlayer.getPlayerType()||"jingle"===dzPlayer.getPlayerType()||dzPlayer.getMediaType()===dzPlayer.MEDIA_TYPE_LIVE_STREAM)},_onChangePlayerType:function(e,t){this.setState({type:t})},_onChangeRepeat:function(e,t){this.setState({repeat:t})},_onChangeShuffle:function(e,t){this.setState({shuffle:t})},_onChangeVolume:function(e,t){this.setState({volume:t})},_onChangeMute:function(e,t){this.setState({mute:t,volume:t?0:100*dzPlayer.getVolume()})}};t.exports=i},{"../../core/context_menu":242,jquery:"jquery"}],152:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("react-addons-pure-render-mixin"),n=e("../../core/i18n"),o=n.gettext,l=e("../../naboo/search"),c=e("../../naboo/stores/SearchStore"),p=s.createClass({displayName:"SearchBar",mixins:[i],getDefaultProps:function(){return{request_suggest_wait_value:400,isAuthUser:0!==window.USER.USER_ID}},componentDidMount:function(){c.onChange(this._searchStoreChanged)},componentWillUnmount:function(){c.offChange(this._searchStoreChanged)},render:function(){var e=o("Rechercher"),t=r({search:!0,active:this.props.active});return s.createElement("div",{className:t},s.createElement("div",{className:"search-form",role:"search"},s.createElement("label",{htmlFor:"menu_search",className:"sr-only"},e),s.createElement("input",{id:"menu_search",ref:"query",className:"search-control",type:"text",placeholder:e,onBlur:this._handleBlur,onKeyUp:this._handleKeys,onClick:this._handleClick}),s.createElement("button",{className:"search-submit",type:"button",onClick:this._triggerSearch},s.createElement("span",{className:"icon icon-16 icon-search"}))))},_focused:!1,_request_suggest_timeout:null,_searchStoreChanged:function(e){return"suggest"!==e?!1:void(""!==c.getQuery()&&this._focused?Events.trigger(Events.menu.openPanel,"searchsuggest"):this.props.isAuthUser&&userData.isLoaded&&this._focused?Events.trigger(Events.menu.openPanel,"searchhistory"):Events.trigger(Events.menu.closeAllPanels))},_handleKeys:function(e){var t=e.which;if(13===t)return this.refs.query.blur(),void this._triggerSearch();var a=this.refs.query.value;c.setQuery(a),this._triggerSuggest()},_handleClick:function(){var e=c.getQuery();e?Events.trigger(Events.menu.openPanel,"searchsuggest"):this.props.isAuthUser&&Events.trigger(Events.menu.openPanel,"searchhistory"),this._focused||(this.refs.query.select(),this._focused=!0)},_handleBlur:function(){this._focused=!1},_triggerSuggest:function(){var e=c.getQuery();null!==this._request_suggest_timeout&&(window.clearTimeout(this._request_suggest_timeout),this._request_suggest_timeout=null),this._request_suggest_timeout=window.setTimeout(function(){c.search(e)},this.props.request_suggest_wait_value)},_triggerSearch:function(e){e&&(e.preventDefault(),e.stopPropagation());var t=c.getQuery();t&&(this.props.isAuthUser&&userData.addSearchHistory(t),l._tabName="all",Events.trigger(Events.menu.closeAllPanels),0===t.lastIndexOf("#",0)?(t=t.replace(/#/g,""),loadBox("/tags/"+encodeURIComponent(t),{force:!0})):loadBox("/search/"+encodeURIComponent(t),{force:!0}))}});t.exports=p},{"../../core/i18n":245,"../../naboo/search":270,"../../naboo/stores/SearchStore":271,classnames:"classnames",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],271:[function(e,t,a){"use strict";function s(e){var t=n;api.call({method:"deezer.suggest",data:{QUERY:t,TYPES:{ARTIST:!0,ALBUM:!0,TRACK:!0,PLAYLIST:!0,SHOW:!0,TAG:!0},NB:3},success:function(a){o[t]=a,t===n&&e(a)}})}var r=e("../../core/Store"),i=null,n="",o={},l=new r({getQuery:function(){return n},setQuery:function(e){return e=e.trim(),n!==e&&(n=e,this.emitChange("input")),this},getResults:function(){return i},search:function(e){return this.setQuery(e),""===n||"#"===n?(i=null,this.emitChange("suggest")):"undefined"!=typeof o[n]?(i=o[n],this.emitChange("suggest")):void s(function(e){i=e,this.emitChange("suggest")}.bind(this))}});t.exports=l},{"../../core/Store":240}],270:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("../components/search/Search"),n={query:"",display:function(e){n.fetch(e,function(e,t){return e?error.log(e):void Events.trigger(Events.search.loaded,t)})},leave:function(){var e=document.getElementById("naboo_content");e&&r.unmountComponentAtNode(e)},fetch:function(e,t){if(n.query=decodeURIComponent(e.query),e.data===Object(e.data))return setTimeout(t.bind(this,null,e.data),0);if(!n.query)return setTimeout(t(new Error("Missing query parameter")),0);try{var a=e.tags?"deezer.tagSearch":"deezer.pageSearch";api.call({method:a,data:{query:n.query,start:0,nb:40,suggest:!0,artist_suggest:!0,top_tracks:!0},error:t,success:t.bind(this,null)})}catch(s){var r="string"==typeof s?new Error(s):s;setTimeout(t(r),0)}return!0},render:function(e,t){var a=document.getElementById("naboo_content");a&&(Events.subscribeOnce(Events.layout.adsBackground,n.resizeCover,"search"),t.tab=n._tabName||"all",t.TRACK.count||t.ARTIST.count||t.ALBUM.count||(t.tab="playlist"),r.render(s.createElement(i,t),a,function(){naboo.afterLoad(!0)}))},getAdsArgs:function(){return{element_id:"ALL",element_data:n.query}}};Events.subscribe(Events.search.loaded,n.render),t.exports=n},{"../components/search/Search":205,react:"react","react-dom":"react-dom"}],205:[function(e,t,a){"use strict";var s=e("react"),r=e("../../core/i18n"),i=r.gettext,n=r.ngettext,o=e("./_elements/Header"),l=e("./_elements/Suggest"),c=e("./_elements/NavBar"),p=e("./_elements/NoResult"),d=e("@deezer/components/common/DataGrid"),u=e("../common/grid/Grid"),h=s.createClass({displayName:"Search",propTypes:{tab:s.PropTypes.string,QUERY:s.PropTypes.string.isRequired,TRACK:s.PropTypes.object.isRequired,ARTIST:s.PropTypes.object.isRequired,ALBUM:s.PropTypes.object.isRequired,PLAYLIST:s.PropTypes.object.isRequired,SHOW:s.PropTypes.object.isRequired,TAG:s.PropTypes.array,FILTER:s.PropTypes.string},childContextTypes:{id:s.PropTypes.string,name:s.PropTypes.string.isRequired},getDefaultProps:function(){return{tab:"all",allFilled:!0,artistFilled:!1,albumFilled:!1,playlistFilled:!1,showlistFilled:!1,FILTER:"all",TAG:[]}},getInitialState:function(){return this.props.ARTIST.total=Math.min(this._maxResults,this.props.ARTIST.total),this.props.ALBUM.total=Math.min(this._maxResults,this.props.ALBUM.total),this.props.PLAYLIST.total=Math.min(this._maxResults,this.props.PLAYLIST.total),this.props.SHOW.total=Math.min(this._maxResults,this.props.SHOW.total),{query:this.props.QUERY,tab:this.props.tab,track:this.props.TRACK,artist:this.props.ARTIST,album:this.props.ALBUM,playlist:this.props.PLAYLIST,show:this.props.SHOW,tag:this.props.TAG,allFilled:!0,artistFilled:!1,albumFilled:!1,playlistFilled:!1}},getChildContext:function(){return{id:this.state.query,name:"search_page"}},componentWillReceiveProps:function(e){e.ARTIST.total=Math.min(this._maxResults,e.ARTIST.total),e.ALBUM.total=Math.min(this._maxResults,e.ALBUM.total),e.PLAYLIST.total=Math.min(this._maxResults,e.PLAYLIST.total),e.SHOW.total=Math.min(this._maxResults,e.SHOW.total),this.setState({query:e.QUERY,tab:e.tab,track:e.TRACK,artist:e.ARTIST,album:e.ALBUM,playlist:e.PLAYLIST,show:e.SHOW,tag:e.TAG||[]})},render:function(){if(!(this.state.track.total||this.state.artist.total||this.state.album.total||this.state.playlist.total))return s.createElement(p,{query:this.state.query});var e=[{id:"all",label:i("Tout"),action:this._onTabClick},{id:"artist",label:i("Artistes"),action:this._onTabClick},{id:"album",label:i("Albums"),action:this._onTabClick},{id:"playlist",label:i("Playlists"),action:this._onTabClick},{id:"show",label:i("Podcasts"),action:this._onTabClick}];return s.createElement("div",{className:"page-naboo-search",id:"page_naboo_search"},s.createElement(o,{query:this.state.query,tags:this.state.tag,filter:this.props.FILTER}),s.createElement(c,{items:e,active:this.state.tab}),this._renderTabContent())},_renderTabContent:function(){if(this._loadTab(this.state.tab),"all"===this.state.tab)return[s.createElement(l,{key:"suggest",artist:this.state.artist,album:this.state.album,playlist:this.state.playlist,shows:this.state.show,onTitleClick:this._changeTab}),s.createElement(d.FullPage,{key:"tracklist",type:"search",items:this.state.track.data})];var e,t=this.state[this.state.tab].total,a={artist:n("Artiste","Artistes",{count:t}),album:n("Album","Albums",{count:t}),playlist:n("Playlist","Playlists",{count:t}),show:n("Podcast","Podcasts",{count:t})};switch(this.state.tab){case"artist":e=s.createElement(u,{data:this.state.artist.data,options:["name","fans","favorite"]});break;case"album":e=s.createElement(u,{data:this.state.album.data,options:["name","artist","favorite"],context:"search_album"});break;case"playlist":e=s.createElement(u,{data:this.state.playlist.data,options:["name","favorite"],context:"search_playlist"});break;case"show":e=s.createElement(u,{data:this.state.show.data,options:["title","name","favorite"],context:"search_show"})}return s.createElement("div",{className:"search-results"},s.createElement("h2",{className:"heading-2","data-target":"title-"+this.state.tab+"s","data-total":"0"},s.createElement("span",{className:"color-primary"},t)," ",a[this.state.tab]),e)},_onTabClick:function(e){this._changeTab(e.id)},_maxResults:40,_changeTab:function(e){this.setState({tab:e})},_loadTab:function(e){this.state[e+"Filled"]||this._fetchTabData(e,function(t,a){if(t)return error.log(t);if(this.isMounted()){var s={};a.total=Math.min(this._maxResults,a.total),s[e]=a,s[e+"Filled"]=!0,this.setState(s)}}.bind(this))},_fetchTabData:function(e,t){api.call({method:"search.music",data:{query:this.state.query,filter:this.props.FILTER,output:e.toUpperCase(),start:0,nb:this._maxResults},error:t,success:t.bind(this,null)})}});t.exports=h},{"../../core/i18n":245,"../common/grid/Grid":134,"./_elements/Header":206,"./_elements/NavBar":207,"./_elements/NoResult":208,"./_elements/Suggest":209,"@deezer/components/common/DataGrid":92,react:"react"}],209:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.ngettext,n=e("./suggest/Column"),o=s.createClass({displayName:"Suggest",propTypes:{artist:s.PropTypes.object,album:s.PropTypes.object,playlist:s.PropTypes.object,shows:s.PropTypes.object,onTitleClick:s.PropTypes.func,limit:s.PropTypes.number},getDefaultProps:function(){return{artist:{data:[],length:0},album:{data:[],length:0},playlist:{data:[],length:0},limit:USER.OPTIONS.mobile_offline?2:1}},render:function(){if(this.props.artist.data.length+this.props.album.data.length+this.props.playlist.data.length===0)return null;var e=0;return["artist","album","playlist","shows"].forEach(function(t){this.props[t].data.length>0&&e++}.bind(this)),s.createElement("div",{className:"search-suggest clearfix"},s.createElement(n,{key:"artist",title:i("Artiste","Artistes",{count:this.props.artist.total}),onTitleClick:this.props.onTitleClick,items:this.props.artist.data,count:this.props.artist.total,limit:this.props.limit}),s.createElement(n,{key:"album",title:i("Album","Albums",{count:this.props.album.total}),onTitleClick:this.props.onTitleClick,items:this.props.album.data,count:this.props.album.total,limit:this.props.limit}),s.createElement(n,{key:"playlist",title:i("Playlist","Playlists",{count:this.props.playlist.total}),onTitleClick:this.props.onTitleClick,items:this.props.playlist.data,count:this.props.playlist.total,limit:this.props.limit}),3>=e?s.createElement(n,{key:"shows",title:i("Podcast","Podcasts",{count:this.props.shows.total}),onTitleClick:this.props.onTitleClick,items:this.props.shows.data,count:this.props.shows.total,limit:this.props.limit}):"")}});t.exports=o},{"../../../core/i18n":245,"./suggest/Column":212,react:"react"}],212:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("./Artist"),n=e("./Album"),o=e("./Playlist"),l=e("./Show"),c=s.createClass({displayName:"Column",propTypes:{title:s.PropTypes.string,onTitleClick:s.PropTypes.func,items:s.PropTypes.array,count:s.PropTypes.number,limit:s.PropTypes.number},getDefaultProps:function(){return{title:"",items:[],count:0,limit:2}},getInitialState:function(){return{type:this.props.items.length?this.props.items[0].__TYPE__:""}},componentWillReceiveProps:function(e){this.setState({type:e.items.length?e.items[0].__TYPE__:""})},render:function(){if(!this.props.items.length)return null;var e=r({"suggest-column":!0,"column-artists":"artist"===this.state.type,"column-albums":"album"===this.state.type,"column-playlists":"playlist"===this.state.type});return s.createElement("dl",{className:e},s.createElement("dt",{className:"suggest-title"},s.createElement("a",{onClick:this._onTitleClick,"data-type":this.state.type},s.createElement("span",{className:"color-primary"},this.props.count)," ",this.props.title,s.createElement("span",{className:"icon icon-arrow-right-long"}))),this._renderItems())},_renderItems:function(){for(var e,t=[],a=0;a<this.props.limit;a++)if("undefined"==typeof this.props.items[a])t.push(s.createElement("dd",{className:"nano-card-item invisible","aria-hidden":"true",key:"blank_"+a}));else switch(e=this.props.items[a],e.__TYPE__){case"artist":t.push(s.createElement(i,{data:e,key:e.__TYPE__+e.ART_ID}));break;case"album":t.push(s.createElement(n,{data:e,key:e.__TYPE__+e.ALB_ID}));break;case"playlist":t.push(s.createElement(o,{data:e,key:e.__TYPE__+e.PLAYLIST_ID}));break;case"show":t.push(s.createElement(l,{data:e,key:e.__TYPE__+e.SHOW_ID}));break;default:error.log(new Error('Unknown "'+e.__TYPE__+'" item type'))}return t},_onTitleClick:function(e){"function"==typeof this.props.onTitleClick&&this.props.onTitleClick(e.currentTarget.getAttribute("data-type"))}});t.exports=c},{"./Album":210,"./Artist":211,"./Playlist":213,"./Show":214,classnames:"classnames",react:"react"}],214:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../common/Thumbnail"),i=s.createClass({displayName:"Show",propTypes:{data:s.PropTypes.object.isRequired},render:function(){return s.createElement("dd",{className:"nano-card-item has-shadow"},s.createElement("div",{className:"nano-card-picture"},s.createElement(r,{id:Number(this.props.data.SHOW_ID),type:"show",picture_type:"talk",md5:this.props.data.SHOW_ART_MD5,height:110,width:110,height_img:120,width_img:120,context:"search_show",play:!0,play_link:!0})),s.createElement("aside",{className:"nano-card-info"},s.createElement("h2",{className:"heading-4 ellipsis"},s.createElement("a",{className:"evt-click",href:"/show/"+this.props.data.SHOW_ID,"data-instance":"show_name"},this.props.data.SHOW_NAME))))}});t.exports=i},{"../../../common/Thumbnail":130,react:"react"}],213:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../common/Thumbnail"),i=e("../../../../core/i18n"),n=i.gettext,o=i.ngettext,l=s.createClass({displayName:"Playlist",propTypes:{data:s.PropTypes.object.isRequired},render:function(){return s.createElement("dd",{className:"nano-card-item has-shadow"},s.createElement("div",{className:"nano-card-picture"},s.createElement(r,{id:Number(this.props.data.PLAYLIST_ID),type:"playlist",md5:this.props.data.PLAYLIST_PICTURE,picture_type:this.props.data.PICTURE_TYPE,height:110,width:110,height_img:180,width_img:180,context:"search_playlist",play:!0,preview:!0,play_link:!0,multi_cover:!0,overlay:!1})),s.createElement("aside",{className:"nano-card-info"},s.createElement("h2",{className:"heading-4 ellipsis"},s.createElement("a",{className:"evt-click",href:"/playlist/"+this.props.data.PLAYLIST_ID,"data-instance":"playlist_name"},this.props.data.TITLE)),this._renderInfos()))},_renderInfos:function(){return this.props.data.PARENT_USER_ID!==window.USER.USER_ID?s.createElement("h3",{className:"heading-4-sub ellipsis"},n("par")+" ",s.createElement("a",{className:"evt-click",href:"/profile/"+this.props.data.PARENT_USER_ID,"data-instance":"user_name"},this.props.data.PARENT_USERNAME)," - ",this.props.data.NB_SONG+" "+o("titre","titres",{count:this.props.data.NB_SONG})):s.createElement("h3",{className:"heading-4-sub ellipsis"},this.props.data.NB_SONG+" "+o("titre","titres",{count:this.props.data.NB_SONG}))}});t.exports=l},{"../../../../core/i18n":245,"../../../common/Thumbnail":130,react:"react"}],211:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../common/Thumbnail"),i=e("../../../../core/i18n"),n=i.ngettext,o=s.createClass({displayName:"Artist",propTypes:{data:s.PropTypes.object.isRequired},render:function(){return s.createElement("dd",{className:"nano-card-item has-shadow"},s.createElement("div",{className:"nano-card-picture"},s.createElement(r,{id:Number(this.props.data.ART_ID),type:"artist",md5:this.props.data.ART_PICTURE,height:110,width:86,height_img:320,width_img:250,overlay:!1})),s.createElement("aside",{className:"nano-card-info"},s.createElement("h2",{className:"heading-4 ellipsis"},s.createElement("a",{className:"evt-click",href:"/artist/"+this.props.data.ART_ID},this.props.data.ART_NAME)),s.createElement("h3",{className:"heading-4-sub ellipsis"},window.breakUpThousands(this.props.data.NB_FAN)," ",n("fan","fans",{count:this.props.data.NB_FAN}))))}});t.exports=o},{"../../../../core/i18n":245,"../../../common/Thumbnail":130,react:"react"}],210:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../common/Thumbnail"),i=e("../../../../core/i18n"),n=i.gettext,o=s.createClass({displayName:"Album",propTypes:{data:s.PropTypes.object.isRequired},render:function(){return s.createElement("dd",{className:"nano-card-item has-shadow"},s.createElement("div",{className:"nano-card-picture"},s.createElement(r,{id:Number(this.props.data.ALB_ID),type:"album",md5:this.props.data.ALB_PICTURE,height:110,width:110,height_img:120,width_img:120,context:"search_album",play:!0,preview:!0,overlay:!1})),s.createElement("aside",{className:"nano-card-info"},s.createElement("h2",{className:"heading-4 ellipsis"},s.createElement("a",{className:"evt-click",href:"/album/"+this.props.data.ALB_ID,"data-instance":"album_name"},this.props.data.ALB_TITLE)),s.createElement("h3",{className:"heading-4-sub ellipsis"},n("par")+" ",s.createElement("a",{className:"evt-click",href:"/artist/"+this.props.data.ART_ID,"data-instance":"artist_name"},this.props.data.ART_NAME))))}});t.exports=o},{"../../../../core/i18n":245,"../../../common/Thumbnail":130,react:"react"}],208:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=r.ngettext,o=e("../../common/grid/Grid"),l=s.createClass({displayName:"NoResult",propTypes:{query:s.PropTypes.string.isRequired},getInitialState:function(){return{albums:[],tracks:[],artists:[]}},componentDidMount:function(){this._fetchData()},render:function(){var e=i("Aucun résultat pour «<strong>%s</strong>»",{sprintf:[" "+window.encodeHTMLEntities(this.props.query)+" "]});return s.createElement("div",{className:"page-naboo-search",id:"page_search_noresult"},s.createElement("div",{className:"search-header"},s.createElement("h1",{className:"heading-1 ellipsis",dangerouslySetInnerHTML:{__html:e}}),s.createElement("h2",{className:"heading-2"},i("Découvrez ce qui cartonne sur Deezer en ce moment :"))),s.createElement("div",{className:"search-results"},this._renderArtists(),this._renderAlbums(),this._renderTracks()))},_renderAlbums:function(){return 0===this.state.albums.length?null:[s.createElement("h3",{className:"heading-2"},n("Album","Albums",{count:this.state.albums.length})),s.createElement(o,{data:this.state.albums,options:["name","artist"]})]},_renderArtists:function(){return 0===this.state.artists.length?null:[s.createElement("h3",{className:"heading-2"},n("Artiste","Artistes",{count:this.state.artists.length})),s.createElement(o,{data:this.state.artists,options:["name","fans"]})]},_renderTracks:function(){return 0===this.state.artists.length?null:[s.createElement("h3",{className:"heading-2"},n("Titre","Titres",{count:this.state.tracks.length})),s.createElement(o,{data:this.state.tracks,options:["name","artist"],type:"album"})]},_fetchData:function(){api.call("deezer.pageTops",{genre_id:0,type:"all",nb:7},function(e){this.isMounted()&&this.setState({artists:e.ITEMS.artist.data,albums:e.ITEMS.album.data,tracks:e.ITEMS.track.data})}.bind(this))}});t.exports=l},{"../../../core/i18n":245,"../../common/grid/Grid":134,react:"react"}],207:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=s.createClass({displayName:"NavBar",propTypes:{items:s.PropTypes.arrayOf(s.PropTypes.shape({id:s.PropTypes.string.isRequired,action:s.PropTypes.oneOfType([s.PropTypes.string,s.PropTypes.func]).isRequired,label:s.PropTypes.string.isRequired})).isRequired,active:s.PropTypes.string},render:function(){return s.createElement("div",{className:"search-navbar"},s.createElement("nav",{className:"navbar"},s.createElement("ul",{className:"navbar-nav"},this._renderItems())))},_renderItems:function(){for(var e,t,a=[],i=0,n=this.props.items.length;n>i;i++)e=this.props.items[i],t=r({active:this.props.active===e.id}),a.push(s.createElement("li",{key:e.id,className:t},"string"==typeof e.action?s.createElement("a",{href:this.props.items[i].action},e.label):s.createElement("a",{onClick:this._onItemClick.bind(this,e)},e.label)));return a},_onItemClick:function(e){e.action(e)}});t.exports=i},{classnames:"classnames",react:"react"}],206:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=e("../../common/TagList"),o=s.createClass({displayName:"Header",propTypes:{filter:s.PropTypes.string.isRequired,query:s.PropTypes.string.isRequired,tags:s.PropTypes.array.isRequired},render:function(){if("TAG"===this.props.filter){var e=[];return this.props.query.split(" ").map(function(t){e.push({LABEL:"#"+t,selected:!0})}),s.createElement("div",{className:"search-header"},s.createElement(n,{tags:e,selected:!0,min:1,showLabel:!0}),s.createElement(n,{tags:this.props.tags,query:this.props.query,showLabel:!0,selectable:!0}))}var t=i("Résultats de recherche pour %s",{sprintf:["« "+window.encodeHTMLEntities(this.props.query)+" »"]});return s.createElement("div",{className:"search-header"},s.createElement("h1",{className:"heading-1 ellipsis"},t))}});t.exports=o},{"../../../core/i18n":245,"../../common/TagList":129,react:"react"}],260:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("../core/i18n"),n=i.gettext,o=e("jquery"),l=e("../components/talk/LatestEpisodes"),c={template:"naboo/latest_episodes",data:[],count:0,duration:0,display:function(){try{return templating.load(c.template),Events.ready(Events.user.dataStoreReady,function(){0!==userData.data.FAVORITES_SHOWS.data.length?(c.data=c._buildEpisodes(userData.data.FAVORITES_SHOWS.data),o('#naboo_episodes_info > [data-target="duration"] > strong').text(getTotalDuration(c.duration)),o('#naboo_episodes_info > [data-target="nb-episodes"] > strong').text(userData.data.FAVORITES_SHOWS.data.length),o("#episodes_content h3").hide(),r.render(s.createElement(l,{list:c.data}),document.getElementById("episodes_content"),function(){naboo.afterLoad(!0)})):(o('#naboo_episodes_info > [data-target="duration"] > strong').text(getTotalDuration(0)),o('#naboo_episodes_info > [data-target="nb-episodes"] > strong').text(0),o("#episodes_content h3").text(n("Aucun podcast"))),Events.ready(Events.user.userReady,function(){o("#naboo_playlist_information_creator").html(encodeHTMLEntities(USER.BLOG_NAME))})}),o("#naboo_episodes_title").text(n("Derniers épisodes disponibles")),o("#naboo_episodes_image").replaceWith(thumbnails.draw({id:3,type:"episodes",cover_type:"misc",pic_id:"ab63361d54955f5f6494fd1b258b336a",play:0,cover_play:!1,cover_link:!1,border:!0,width:200,height:200,sent_to_mobile:!1,tracking:1,play_force:!1,zoom_on_cover:!0,context_menu_hide:!0,enable_preview:!1,overlay:!1})),naboo.afterLoad(!0),!0}catch(e){error.log(e)}},_buildEpisodes:function(e){for(var t,a=[],s=0;s<e.length;s+=1)t=c._addHeardData(e[s].LATEST_EPISODE.data[0]),c.duration+=parseInt(t.DURATION,10),a.push(t);return a},_addHeardData:function(e){var t=bookmark.getEpisodeBookmark(e.EPISODE_ID,e.DURATION);return e.IS_HEARD=t.IS_HEARD,e}};t.exports=c},{"../components/talk/LatestEpisodes":215,"../core/i18n":245,jquery:"jquery",react:"react","react-dom":"react-dom"}],215:[function(e,t,a){"use strict";var s=e("react"),r=e("@deezer/components/common/DataGrid"),i=s.createClass({displayName:"LatestEpisodes",propTypes:{list:s.PropTypes.object.isRequired},childContextTypes:{id:s.PropTypes.number,name:s.PropTypes.string},getChildContext:function(){return{id:Number(this.props.list[0].EPISODE_ID),name:"show_page"}},render:function(){return s.createElement(r,{type:"talkEpisodes",items:this.props.list,options:{header:!1,infiniteScroll:!1,toolbar:!1}})}});t.exports=i},{"@deezer/components/common/DataGrid":92,react:"react"}],259:[function(e,t,a){"use strict";var s,r=e("react"),i=e("react-dom"),n=e("@deezer/components/Page"),o={id:0,display:function(e){if(s=document.getElementById("naboo_content")){var t="object"==typeof e&&e.data&&e.data.sections?e.data.sections:[];i.render(r.createElement(n,{sections:t,type:"home"}),s,function(){naboo.afterLoad(!0)})}},leave:function(){s&&i.unmountComponentAtNode(s)}};t.exports=o},{"@deezer/components/Page":31,react:"react","react-dom":"react-dom"}],31:[function(e,t,a){"use strict";t.exports=e("./Page")},{"./Page":17}],17:[function(e,t,a){"use strict";var s=e("babel-runtime/helpers/object-without-properties")["default"],r=e("babel-runtime/helpers/extends")["default"],i=e("react"),n=e("./_elements/layouts/Highlight"),o=e("./_elements/layouts/DeeplinkList"),l=e("./_elements/layouts/List"),c=e("./_elements/layouts/Grid"),p=i.createClass({displayName:"Page",propTypes:{type:i.PropTypes.string.isRequired,sections:i.PropTypes.array},getDefaultProps:function(){return{sections:[]}},getInitialState:function(){return{sections:this.props.sections}},componentDidMount:function(){0===this.state.sections.length&&this._getSections()},render:function(){return i.createElement("div",{className:"home-container"},this._renderSections())},_renderSections:function(){for(var e=[],t=0,a=this.state.sections.length;a>t;t++){var n=this.state.sections[t],o=n.layout,l=s(n,["layout"]),c=this._getLayout(o);e.push(i.createElement(c,r({key:t},l)))}return e},_getLayout:function(e){var t={highlight:n,"deeplink-list":o,list:l,grid:c};if("undefined"==typeof t[e])throw new Error('Layout "'+e+'" cannot be found');return t[e]},_getSections:function(){api.call({method:"page.get",data:{PAGE:this.props.type,VERSION:"2.0",SUPPORT:{highlight:n.SUPPORTED_TYPES,"deeplink-list":o.SUPPORTED_TYPES,list:l.SUPPORTED_TYPES,grid:c.SUPPORTED_TYPES},OPTIONS:["deeplink_subscribeoffer"]},success:function(e){this.isMounted()&&this.setState({sections:e.sections})}.bind(this)})}});t.exports=p},{"./_elements/layouts/DeeplinkList":27,"./_elements/layouts/Grid":28,"./_elements/layouts/Highlight":29,"./_elements/layouts/List":30,"babel-runtime/helpers/extends":294,"babel-runtime/helpers/object-without-properties":297,react:"react"}],297:[function(e,t,a){"use strict";a["default"]=function(e,t){var a={};for(var s in e)t.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(e,s)&&(a[s]=e[s]);return a},a.__esModule=!0},{}],30:[function(e,t,a){(function(a){"use strict";var s=e("babel-runtime/helpers/define-property")["default"],r=e("babel-runtime/helpers/extends")["default"],i=e("react"),n=e("classnames"),o=e("../../navigate"),l=e("../../standardize"),c=e("../../Type"),p=e("../items/List"),d=a.live,u=i.createClass({displayName:"ListLayout",propTypes:{title:i.PropTypes.string,subtitle:i.PropTypes.string,separator:i.PropTypes.bool,target:i.PropTypes.string,items:i.PropTypes.array.isRequired,section_id:i.PropTypes.string.isRequired},statics:{SUPPORTED_TYPES:[c.Album,c.App,c.Artist,c.Playlist,c.Radio,c.Show,c.Track,c.User],LOW_ITEMS_LIMIT_PER_LINE:2,HIGH_ITEMS_LIMIT_PER_LINE:3},getInitialState:function(){return{itemsLimitPerLine:this._getItemsLimitPerLine()}},componentWillMount:function(){Events.subscribeOnce(Events.layout.adsBackground,this._checkItemsLimit,"header_flow"),Events.subscribe(Events.layout.resize,this._checkItemsLimit,"header_flow")},componentDidMount:function(){this._logDisplay(),this._checkItemsLimit()},render:function(){var e=this.props.items.length<=u.LOW_ITEMS_LIMIT_PER_LINE?this.props.items.length:this.props.items.length-this.props.items.length%this.state.itemsLimitPerLine,t=this.props.items.slice(0,e),a=s({"home-list":!0,clearfix:!0},"home-list-"+this.state.itemsLimitPerLine,!0);return i.createElement("div",{ref:"pageRecos",className:"home-tops"},this._renderTitle(),i.createElement("div",{className:n(a)},this._renderItems(t)))},_renderTitle:function(){if("undefined"==typeof this.props.title)return null;var e={};return"undefined"!=typeof this.props.target&&(e.onClick=o.bind(this)),i.createElement("div",r({className:"home-title"},e),i.createElement("h3",{className:"heading-3"},this.props.title),this._renderSubTitle())},_renderSubTitle:function(){return"undefined"==typeof this.props.subtitle?null:i.createElement("h4",{className:"heading-4-sub"},this.props.subtitle)},_renderItems:function(e){return e.map(this._renderItem)},_renderItem:function(e,t){if(-1===u.SUPPORTED_TYPES.indexOf(e.type))throw new Error('Items of type "'+e.type+'" are not handled by the List layout.');return i.createElement(p,r({key:t},l(e)))},_checkItemsLimit:function(){var e=this._getItemsLimitPerLine();e!==this.state.itemsLimitPerLine&&this.setState({itemsLimitPerLine:e})},_getItemsLimitPerLine:function(){if(this.refs&&this.refs.pageRecos)return this.refs.pageRecos.clientWidth<=1025?u.LOW_ITEMS_LIMIT_PER_LINE:u.HIGH_ITEMS_LIMIT_PER_LINE;var e=window.matchMedia||function(e){var t=window.styleMedia||window.media;return{matches:t?t.matchMedium(e||"all"):!0,media:e||"all"}};return e("(max-width: 1340px)").matches?u.LOW_ITEMS_LIMIT_PER_LINE:u.HIGH_ITEMS_LIMIT_PER_LINE},_logDisplay:function(){d.log.send("navigation",{event:"onDisplay",properties:{section:this.props.section_id}})}});t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../Type":18,"../../navigate":32,"../../standardize":33,"../items/List":26,"babel-runtime/helpers/define-property":293,"babel-runtime/helpers/extends":294,classnames:"classnames",react:"react"}],293:[function(e,t,a){"use strict";var s=e("babel-runtime/core-js/object/define-property")["default"];a["default"]=function(e,t,a){return t in e?s(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e},a.__esModule=!0},{"babel-runtime/core-js/object/define-property":287}],26:[function(e,t,a){"use strict";var s=e("react"),r=e("@deezer/components/common/Thumbnail"),i=e("@deezer/components/common/Badge"),n=e("../../navigate"),o=s.createClass({displayName:"ListItem",propTypes:{id:s.PropTypes.number,type:s.PropTypes.string.isRequired,pictures:s.PropTypes.arrayOf(s.PropTypes.shape({md5:s.PropTypes.string.isRequired,type:s.PropTypes.string.isRequired})).isRequired,play_button:s.PropTypes.bool,badge:s.PropTypes.number,title:s.PropTypes.string.isRequired,target:s.PropTypes.string,subtitle:s.PropTypes.string,caption:s.PropTypes.string,data:s.PropTypes.object,item_id:s.PropTypes.string.isRequired},getDefaultProps:function(){return{play_button:!1,weight:1,tags:[]}},render:function(){return s.createElement("div",{className:"home-list-item"},this._renderItem())},_renderItem:function(){return s.createElement("div",{className:"nano-card-item has-shadow"},s.createElement("div",{className:"nano-card-picture"},this._renderThumbnail()),s.createElement("div",{className:"nano-card-infos"},s.createElement("p",{className:"heading-3 ellipsis"},s.createElement(i,{counter:this.props.badge}),s.createElement("a",{onClick:n.bind(this)},this.props.title)),this._renderSubtitle(),this._renderCaption()))},_renderThumbnail:function(){return this.props.pictures instanceof Array==!1||0===this.props.pictures.length?null:s.createElement(r,{id:this.props.id,type:this.props.type,picture_type:this.props.pictures[0].type,md5:this.props.pictures[0].md5,multi_cover:!0,height:110,width:110,context:"home_"+this.props.type+("user"===this.props.type?"_radio":""),play:this.props.play_button,link:this.props.play_button===!1,radio:"radio"===this.props.type||"user"===this.props.type,zoom:!1,preview:!0,overlay:!1,target:this.props.target,onClick:n.bind(this)})},_renderSubtitle:function(){return"string"!=typeof this.props.subtitle?null:s.createElement("p",{className:"heading-2-sub ellipsis"},this.props.subtitle)},_renderCaption:function(){return"string"!=typeof this.props.caption?null:s.createElement("p",{className:"heading-4-sub ellipsis caption"},this.props.caption)}});t.exports=o},{"../../navigate":32,"@deezer/components/common/Badge":57,"@deezer/components/common/Thumbnail":130,react:"react"}],29:[function(e,t,a){(function(a){"use strict";var s=e("babel-runtime/helpers/extends")["default"],r=e("react"),i=e("../../navigate"),n=e("../../standardize"),o=e("../../Type"),l=e("../items/Highlight"),c=a.live,p=r.createClass({displayName:"HighlightLayout",propTypes:{title:r.PropTypes.string,subtitle:r.PropTypes.string,separator:r.PropTypes.bool,target:r.PropTypes.string,items:r.PropTypes.array.isRequired,section_id:r.PropTypes.string.isRequired},statics:{SUPPORTED_TYPES:[o.Generic,o.Album,o.Artist,o.Playlist,o.Radio,o.Show,o.Track,o.User]},componentDidMount:function(){this._logDisplay()},render:function(){return r.createElement("div",null,this._renderTitle(),this._renderItems())},_renderTitle:function(){if("undefined"==typeof this.props.title)return null;var e={};return"undefined"!=typeof this.props.target&&(e.onClick=i.bind(this)),r.createElement("div",s({className:"home-title"},e),r.createElement("h3",{className:"heading-3"},this.props.title),this._renderSubTitle())},_renderSubTitle:function(){return"undefined"==typeof this.props.subtitle?null:r.createElement("h4",{className:"heading-4-sub"},this.props.subtitle)},_renderItems:function(){return this.props.items.map(this._renderItem)},_renderItem:function(e,t){if(-1===p.SUPPORTED_TYPES.indexOf(e.type))throw new Error('Items of type "'+e.type+'" are not handled by the Highlight layout.');return r.createElement(l,s({key:t},n(e)))},_logDisplay:function(){c.log.send("navigation",{event:"onDisplay",properties:{section:this.props.section_id}})}});t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../Type":18,"../../navigate":32,"../../standardize":33,"../items/Highlight":25,"babel-runtime/helpers/extends":294,react:"react"}],25:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("./ProgressBar"),n=e("./Launcher"),o=e("./Player"),l=e("./Background"),c=e("@deezer/components/common/Thumbnail"),p=s.createClass({displayName:"Highlight",propTypes:{id:s.PropTypes.number,type:s.PropTypes.string,pictures:s.PropTypes.arrayOf(s.PropTypes.shape({md5:s.PropTypes.string.isRequired,type:s.PropTypes.string.isRequired})).isRequired,title:s.PropTypes.string,subtitle:s.PropTypes.string,target:s.PropTypes.string,play_button:s.PropTypes.bool,data:s.PropTypes.object},getDefaultProps:function(){return{pictures:[{md5:"",type:""}]}},getInitialState:function(){return{player_launched:!1,launcher_fade_active:!1,player_fade_active:!1,seek_position:0}},componentDidMount:function(){"user"===this.props.type&&(Events.subscribe(Events.player.tracklist_changed,this._onTrackListChanged,"header_flow"),dzPlayer.playerLoaded?this._checkFlowStatus():Events.subscribeOnce(Events.player.playerLoaded,this._checkFlowStatus,"header_flow"))},componentWillUnmount:function(){clearTimeout(this._switchTimeout),"user"===this.props.type&&Events.unsubscribeAll("header_flow")},render:function(){if("user"!==this.props.type)return s.createElement("div",{className:"home-flow home-highlight"},s.createElement(c,{id:this.props.id,md5:this.props.pictures[0].md5,type:this.props.type,picture_type:this.props.pictures[0].type,multi_cover:!0,width:1200,height:280,play:this.props.play_button,cover_play:this.props.play_button,play_force:!0,overlay:"generic"===this.props.type?!1:!0,overlay_force:this.props.title||this.props.play_button?!0:!1,preview:!1,radio:"radio"===this.props.type||"user"===this.props.type,context:"home_"+this.props.type+("user"===this.props.type?"_radio":""),blur:"generic"===this.props.type?0:3,target:"generic"===this.props.type?this.props.target:void 0}),s.createElement("div",{className:"flow-container flow-container-generic"},s.createElement("div",{className:"flow-content"},s.createElement("h1",{className:"heading-1 heading-inverse"},this.props.target?s.createElement("a",{className:"evt-click",href:this.props.target},this.props.title):this.props.title),s.createElement("h2",{className:"heading-2 heading-inverse"},this.props.subtitle))));var e=r({"flow-container":!0,active:this.state.player_fade_active}),t=r({"flow-container":!0,active:this.state.launcher_fade_active});return s.createElement("div",{className:"home-flow"},s.createElement(l,{pictures:this.props.pictures,type:this.props.type}),this.state.player_launched?s.createElement(i,null):"",s.createElement("div",{className:"flow-overlay"}),this.state.player_launched?s.createElement("div",{className:e},s.createElement(o,null)):s.createElement("div",{className:t},s.createElement(n,this.props)))},_onTrackListChanged:function(e,t){return"undefined"==typeof t||"set"===t.type&&!t.first?(this._checkFlowStatus(),!0):!1},_switchTimeout:null,_checkFlowStatus:function(){var e=dzPlayer.helper.isPlayingUserFlow();if(e){if(this.state.player_launched&&this.state.player_fade_active)return!1;if(!this.state.launcher_fade_active)return this._switchToPlayerNow(),!1;this._switchToPlayer()}else{if(!this.state.player_launched&&this.state.launcher_fade_active)return!1;this._switchToLauncher()}},_switchToLauncher:function(){this.setState({player_fade_active:!1},function(){this._switchTimeout=setTimeout(function(){this._loadLauncher()}.bind(this),400)})},_switchToPlayer:function(){this.setState({launcher_fade_active:!1},function(){this._switchTimeout=setTimeout(function(){this._loadPlayer()}.bind(this),600)})},_switchToPlayerNow:function(){this.setState({launcher_fade_active:!1},function(){this._loadPlayerNow()})},_loadLauncher:function(){this.setState({launcher_fade_active:!1},function(){this._switchTimeout=setTimeout(function(){this.setState({player_launched:!1,launcher_fade_active:!0})}.bind(this),600)})},_loadPlayer:function(){this.setState({player_fade_active:!1},function(){this._switchTimeout=setTimeout(function(){this.setState({player_launched:!0,player_fade_active:!0})}.bind(this),600)})},_loadPlayerNow:function(){this.setState({player_fade_active:!1},function(){this.setState({player_launched:!0,player_fade_active:!0})})}});t.exports=p},{"./Background":21,"./Launcher":22,"./Player":23,"./ProgressBar":24,"@deezer/components/common/Thumbnail":130,classnames:"classnames",react:"react"}],24:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=s.createClass({displayName:"ProgressBar",getInitialState:function(){return{position:this._calculatePosition(dzPlayer.getPosition())}},componentDidMount:function(){Events.subscribe(Events.player.position,this._setPlayerPosition,"home_flow")},shouldComponentUpdate:function(e,t){return t.position!==this.state.position},componentWillUnmount:function(){Events.unsubscribe(Events.player.position,this._setPlayerPosition)},render:function(){var e=r({"flow-progress-bar":!0,seek:USER.OPTIONS.ads_display===!1}),t={width:this.state.position+"%"};return s.createElement("div",{ref:"progressBar",role:"progressbar",className:e,onClick:this._seek},s.createElement("div",{className:"flow-progress-bar-overlay",style:t}))},_setPlayerPosition:function(e,t){this.setState({position:this._calculatePosition(t)})},_calculatePosition:function(e){return Math.round(1e4*e/dzPlayer.getCurrentSong("DURATION"))/100},_seek:function(e){if(!dzPlayer.control.canSeek())return void e.preventDefault();var t=this.refs.progressBar,a=(e.pageX-t.getBoundingClientRect().left+document.body.scrollLeft)/t.offsetWidth;dzPlayer.control.seek(a)}});t.exports=i},{classnames:"classnames",react:"react"}],23:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../../../../core/i18n"),n=i.gettext,o=e("../../../../../core/context_menu"),l=e("@deezer/components/common/Thumbnail"),c=e("@deezer/components/common/Favorite"),p=e("@deezer/components/common/Dislike"),d=e("@deezer/components/_mixins/notification"),u=s.createClass({displayName:"Player",mixins:[d],getInitialState:function(){return{pictures_index:0,player_type:"radio",radio_skip_blocked:!dzPlayer.skipRadioAllowed(),hasLyrics:dzPlayer.hasLyrics()}},componentWillMount:function(){this._preloaded_data=[dzPlayer.getCurrentSong(),dzPlayer.getNextSong()]},componentDidMount:function(){this._setOnair(),Events.resolve(Events.flow.playerDisplay),Events.subscribe(Events.player.displayCurrentSong,this._setPlayerState,"header_flow"),Events.subscribe(Events.player.changePlayerType,this._setPlayerTypeState,"header_flow")},componentWillUpdate:function(e,t){this.state.pictures_index!==t.pictures_index&&this._closeContextMenu()},componentDidUpdate:function(){this._setOnair()},componentWillUnmount:function(){Events.unsubscribe(Events.player.displayCurrentSong,this._setPlayerState),Events.unsubscribe(Events.player.changePlayerType,this._setPlayerTypeState)},render:function(){var e=[],t=[],a=[];this._preloaded_data.map(function(i,n){var o=this.state.pictures_index===n,c=i.SNG_ID+"_"+n,p=r({"flow-thumbnail":!0,active:o});e.push(s.createElement("div",{className:p,key:"cover_"+c},s.createElement(l,{id:USER.USER_ID,type:"user",picture_type:"cover",md5:i.ALB_PICTURE,play:!0,cover_play:!0,context:"home_user_radio",width:180,height:180,context_menu:i}))),t.push(s.createElement("span",{className:"flow-play-track ellipsis"+(o?" active":""),key:"title_"+c},i.SNG_TITLE)),a.push(s.createElement("span",{className:"flow-play-track ellipsis"+(o?" active":""),key:"artist_"+c},i.ART_NAME))}.bind(this));var i=this._preloaded_data[this.state.pictures_index],o=r({"evt-over evt-out":this.state.hasLyrics,invisible:!this.state.hasLyrics});return s.createElement("div",{className:"flow-content"},e,s.createElement("div",{className:"flow-play-info"},s.createElement("p",{className:"sticker sticker-flow"},n("FLOW")),s.createElement("p",{className:"heading-1 heading-inverse"},s.createElement("a",{className:"evt-click",href:"/album/"+i.ALB_ID},t)),s.createElement("p",{className:"heading-1-sub heading-inverse"},s.createElement("span",{className:"flow-by"},n("par")),s.createElement("a",{className:"evt-click",href:"/artist/"+i.ART_ID},a)),s.createElement("ul",{className:"flow-action-list clearfix"},s.createElement("li",{className:"flow-action"},s.createElement(p,{style:"heart_medium",tooltip:!0,elId:"flow-unlove",overlay:!1,id:i.SNG_ID,onClickCallback:this._onDislikeClick})),s.createElement("li",{className:"flow-action"},s.createElement(c,{type:"song",style:"heart_medium",overlay:!1,context:"flow_header",elId:"flow-love",tooltip:!0,id:i.SNG_ID,onClickCallback:this._onFavoriteClick})),s.createElement("li",{className:"flow-action"},s.createElement("a",{className:o,"data-tooltip":"1","data-tooltip-gravity":"s","data-tooltip-delay":"400",title:n("Afficher les paroles"),onClick:this._openLyrics,role:"button"},s.createElement("span",{className:"icon-52 icon-stack icon-stack-circle"},s.createElement("span",{className:"icon icon-lyrics"})))),s.createElement("li",{className:"flow-action next"},s.createElement("a",{className:"icon icon-24 icon-next",disabled:"ads"===this.state.player_type,role:"button",onClick:this._next})))))},_onDislikeClick:function(){this.displayNotification("dislike"),setTimeout(this._next,300)},_onFavoriteClick:function(e,t,a){a&&this.displayNotification("like")},_setPlayerTypeState:function(){this.setState({player_type:dzPlayer.getPlayerType()})},_setPlayerState:function(){if(!dzPlayer.helper.isPlayingUserFlow())return!1;if(dzPlayer.getCurrentSong().SNG_ID===this._preloaded_data[this.state.pictures_index].SNG_ID)return!1;var e={player_type:dzPlayer.getPlayerType()},t=this.state.pictures_index>=2?0:this.state.pictures_index+1,a=t>=2?0:t+1,s=dzPlayer.getNextSong()||{};this._preloaded_data[a]=s,e.pictures_index=t,e.radio_skip_blocked=!dzPlayer.skipRadioAllowed(),e.hasLyrics=dzPlayer.hasLyrics(),this.setState(e)},_setOnair:function(){window.setTimeout(function(){dzPlayer.isPlaying()&&onair.onPlay()},0)},_next:function(e){e&&e.stopPropagation&&e.stopPropagation(),this.state.radio_skip_blocked?notificationBar.display("flow_skip_push",{}):dzPlayer.control.nextSong()},_closeContextMenu:function(){o.close("home_user_radio")},_openLyrics:function(){Events.trigger(Events.menu.openPanel,"lyrics")}});t.exports=u},{"../../../../../core/context_menu":242,"../../../../../core/i18n":245,"@deezer/components/_mixins/notification":39,"@deezer/components/common/Dislike":115,"@deezer/components/common/Favorite":119,"@deezer/components/common/Thumbnail":130,classnames:"classnames",react:"react"}],115:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../core/i18n"),n=i.gettext,o=e("../../core/favorite"),l=s.createClass({displayName:"Dislike",propTypes:{id:s.PropTypes.string.isRequired,type:s.PropTypes.string,style:s.PropTypes.oneOf(["heart","heart_medium","heart_large"]),overlay:s.PropTypes.bool,tooltip:s.PropTypes.bool,tooltip_gravity:s.PropTypes.string,elId:s.PropTypes.string,onClickCallback:s.PropTypes.func},getDefaultProps:function(){return{type:"disliked_song",style:"heart",overlay:!0,tooltip:!1,tooltip_gravity:"s",elId:null,onClickCallback:function(){}}},getInitialState:function(){return{active:!1}},componentDidMount:function(){Events.subscribe(Events.user.addFavorite,this._onFavoriteToggle),Events.subscribe(Events.user.deleteFavorite,this._onFavoriteToggle)},componentWillReceiveProps:function(){this.setState({active:!1})},shouldComponentUpdate:function(e,t){return this.state.active!==t.active||this.props.id!==e.id},componentWillUnmount:function(){Events.unsubscribe(Events.user.addFavorite,this._onFavoriteToggle),Events.unsubscribe(Events.user.deleteFavorite,this._onFavoriteToggle)},render:function(){var e=r({action:"heart"===this.props.style,"evt-over evt-out":this.props.tooltip}),t=r({"icon-32":"heart"===this.props.style,"icon-52":"heart_medium"===this.props.style,"icon-64":"heart_large"===this.props.style,"icon-stack-hover":this.props.overlay,"icon-stack icon-stack-circle icon-stack-circle-striked":!0}),a=r({"icon icon-unlove":!0,active:this.state.active&&dzPlayer.skipRadioAllowed()}),i={};return this.props.tooltip&&(i={enabled:"1",gravity:this.props.tooltip_gravity,delay:"400",offset:2}),s.createElement("a",{className:e,id:this.props.elId,"data-tooltip":i.enabled,"data-tooltip-offset":i.offset,"data-tooltip-gravity":i.gravity,"data-tooltip-delay":i.delay,title:n("Ne plus me proposer ce titre"),onClick:this._onDislikeClick,role:"button"},s.createElement("span",{className:t},s.createElement("span",{className:a})))},_onFavoriteToggle:function(e,t){var a=Number(this.props.id),s=Number(t.SNG_ID);return a!==s||"disliked_song"!==t.type?!1:void this.setState({active:userData.isDisliked(a)})},_onDislikeClick:function(e){e.stopPropagation(),o.add({type:this.props.type,id:this.props.id}),this.props.onClickCallback()}});t.exports=l},{"../../core/favorite":243,"../../core/i18n":245,classnames:"classnames",react:"react"}],39:[function(e,t,a){"use strict";var s=e("../../core/i18n"),r=s.gettext,i={like:!0,dislike:!0},n={dislike_first:r("Flow ne vous proposera plus ce titre, promis."),dislike:r("Non merci Flow."),like_first:r("Ajouté aux Coups de cœur. Allez-y, continuez à ajouter, Flow apprend à vous connaître."),like:r("Ajouté aux Coups de cœur")},o={displayNotification:function(e){if(!i[e])return!1;var t="number"==typeof USER.SETTING.site["nb_flowplayer_"+e+"_notification"]?USER.SETTING.site["nb_flowplayer_"+e+"_notification"]:0;if(3>t){var a=n[e+(0===t?"_first":"")];window.notification.display(null,{message:a});var s={};s["nb_flowplayer_"+e+"_notification"]=t+1,userSetting.set({site:s})}}};t.exports=o},{"../../core/i18n":245}],22:[function(e,t,a){"use strict";var s=e("react"),r=s.createClass({displayName:"Launcher",propTypes:{id:s.PropTypes.number.isRequired,type:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,subtitle:s.PropTypes.string.isRequired,target:s.PropTypes.string},player_launched:!1,render:function(){return s.createElement("div",{className:"flow-content"},s.createElement("div",{className:"flow-btn",role:"button",onClick:this._onClickFlow},s.createElement("span",{className:"icon-52 icon-stack icon-stack-circle"},s.createElement("span",{className:"icon icon-play"}))),s.createElement("h1",{className:"heading-1 heading-inverse"},this.props.title),s.createElement("h2",{className:"heading-2 heading-inverse"},this.props.subtitle))},_onClickFlow:function(){return"user"!==this.props.type&&"string"==typeof this.props.target?void www.navigate(this.props.target):void(this.player_launched!==!0&&(this.player_launched=!0,dzPlayer.play({radio:!0,type:"user",id:this.props.id,context:{ID:this.props.id,TYPE:"home_user_radio"}}),tracking.track("flow_click",{type:"user",instance:"home"})))}});t.exports=r},{react:"react"}],21:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../../../../core/Blurred"),n=s.createClass({displayName:"Background",propTypes:{type:s.PropTypes.string,pictures:s.PropTypes.array},getInitialState:function(){var e=dzPlayer.helper.isPlayingUserFlow();return{pictures_index:e?this.props.pictures.length:0,player_launched:e,preloaded_pictures:this._getPreloadedPictures()}},componentDidMount:function(){this.props.pictures.length>0&&!this.state.player_launched&&this._setLoopPicturesInterval(),this._renderBlur(),"user"===this.props.type&&Events.subscribe(Events.player.play,this._setPlayerBackground,"header_flow")},componentDidUpdate:function(){this._renderBlur()},componentWillUnmount:function(){this._clearLoopPicturesInterval(),Events.unsubscribe(Events.player.play,this._setPlayerBackground)},render:function(){var e=this.state.preloaded_pictures.map(function(e,t){var a=r({"background-position":!0,active:this.state.pictures_index===t});return s.createElement("div",{key:e.md5+"_"+t,ref:e.md5+"_"+t,className:a})}.bind(this));return s.createElement("div",{className:"flow-cover"},e)},_renderBlur:function(){this.state.preloaded_pictures.map(function(e,t){var a=this.refs[e.md5+"_"+t];return new i(a).setUrl(window.SETTING_DOMAIN_IMG+"/"+e.type+"/"+e.md5+"/500x500.jpg").setBlurStrength(3).render()}.bind(this))},_background_loop_interval:0,_preloaded_pictures:[],_setPlayerBackground:function(){var e=dzPlayer.helper.isPlayingUserFlow();if(!this.state.player_launched&&!e)return!1;if(!this.state.player_launched&&e)return this._clearLoopPicturesInterval(),this._setBackgroundTransition(),!1;if(this.state.player_launched&&!e)return this._setBackgroundTransition(),this._setLoopPicturesInterval(),!1;var t=dzPlayer.getNextSong()||{},a=this.state.pictures_index>=this.state.preloaded_pictures.length-1?this.props.pictures.length:this.state.pictures_index+1,s=a>=this.state.preloaded_pictures.length-1?this.props.pictures.length:a+1;this._preloaded_pictures[s]={md5:t.ALB_PICTURE,type:"cover"},this.setState({pictures_index:a,preloaded_pictures:this._preloaded_pictures,player_launched:!0})},_setBackgroundTransition:function(){var e=dzPlayer.helper.isPlayingUserFlow();this.setState({player_launched:e,preloaded_pictures:e?this._getPreloadedPictures():this.state.preloaded_pictures},this._setBackgroundTransitionCallback)},_setBackgroundTransitionCallback:function(){var e=dzPlayer.helper.isPlayingUserFlow();window.setTimeout(function(){this.setState({pictures_index:e?this.props.pictures.length:0})}.bind(this),400)},_clearLoopPicturesInterval:function(){clearInterval(this._background_loop_interval)},_setLoopPicturesInterval:function(){this.props.pictures.length>0&&(this._clearLoopPicturesInterval(),this._background_loop_interval=window.setInterval(this._setLoopPicturesBackground,4e3))},_setLoopPicturesBackground:function(){var e=(this.state.pictures_index+1)%this.props.pictures.length;this.setState({pictures_index:e,player_launched:!1})},_getPreloadedPictures:function(){var e=this.props.pictures.slice();return dzPlayer.helper.isPlayingUserFlow()&&e.push({md5:dzPlayer.getCurrentSong().ALB_PICTURE,type:"cover"},{md5:dzPlayer.getNextSong().ALB_PICTURE,type:"cover"},{md5:"d41d8cd98f00b204e9800998ecf8427e",type:"cover"}),this._preloaded_pictures=e,e}});t.exports=n},{"../../../../../core/Blurred":237,classnames:"classnames",react:"react"}],28:[function(e,t,a){(function(a){"use strict";var s=e("babel-runtime/helpers/extends")["default"],r=e("react"),i=e("classnames"),n=e("../../navigate"),o=e("../../standardize"),l=e("../../Type"),c=e("../items/Grid"),p=a.live,d=r.createClass({displayName:"GridLayout",propTypes:{title:r.PropTypes.string,subtitle:r.PropTypes.string,separator:r.PropTypes.bool,target:r.PropTypes.string,items:r.PropTypes.array.isRequired,section_id:r.PropTypes.string.isRequired},statics:{SUPPORTED_TYPES:[l.Generic,l.Album,l.Artist,l.Playlist,l.Radio,l.Show,l.Track],MIN_NB_VISIBLE_ITEMS_LIMIT_PER_LINE:3},componentDidMount:function(){this._logDisplay()},render:function(){return r.createElement("div",{className:"home-mix"},this._renderTitle(),r.createElement("ul",{className:"thumbnail-grid"},this._renderItems()))},_renderTitle:function(){if("undefined"==typeof this.props.title)return null;var e={};return"undefined"!=typeof this.props.target&&(e.onClick=n.bind(this)),r.createElement("div",s({className:"home-title"},e),r.createElement("h3",{className:"heading-3"},this.props.title),this._renderSubTitle())},_renderSubTitle:function(){return"undefined"==typeof this.props.subtitle?null:r.createElement("h4",{className:"heading-4-sub"},this.props.subtitle)},_renderItems:function(){return this.props.items.map(this._renderItem)},_renderItem:function(e,t){if(-1===d.SUPPORTED_TYPES.indexOf(e.type))throw new Error('Items of type "'+e.type+'" are not handled by the Grid layout.');var a=this.props.items.length,s=i({"hide-lg":t>=d.MIN_NB_VISIBLE_ITEMS_LIMIT_PER_LINE&&t>=a-a%3,"hide-md":t>=d.MIN_NB_VISIBLE_ITEMS_LIMIT_PER_LINE&&t>=a-a%4,"hide-sm":t>=d.MIN_NB_VISIBLE_ITEMS_LIMIT_PER_LINE&&t>=a-a%5,"hide-xs":t>=d.MIN_NB_VISIBLE_ITEMS_LIMIT_PER_LINE&&t>=a-a%6});return r.createElement("li",{key:t,className:s},r.createElement(c,o(e)))},_logDisplay:function(){p.log.send("navigation",{event:"onDisplay",properties:{section:this.props.section_id}})}});t.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../Type":18,"../../navigate":32,"../../standardize":33,"../items/Grid":20,"babel-runtime/helpers/extends":294,classnames:"classnames",react:"react"}],20:[function(e,t,a){"use strict";var s=e("react"),r=e("@deezer/components/common/Thumbnail"),i=e("@deezer/components/common/TagList"),n=e("../../navigate"),o=s.createClass({displayName:"GridItem",propTypes:{id:s.PropTypes.number,type:s.PropTypes.string.isRequired,target:s.PropTypes.string,pictures:s.PropTypes.arrayOf(s.PropTypes.shape({md5:s.PropTypes.string.isRequired,type:s.PropTypes.string.isRequired})).isRequired,play_button:s.PropTypes.bool,title:s.PropTypes.string,caption:s.PropTypes.string,weight:s.PropTypes.number,data:s.PropTypes.object,tags:s.PropTypes.arrayOf(s.PropTypes.string),item_id:s.PropTypes.string.isRequired},getDefaultProps:function(){return{play_button:!1,weight:1,tags:[]}},render:function(){var e=[this._renderThumbnail()],t="string"==typeof this.props.caption||this.props.tags.length>0;return t&&e.push(s.createElement("div",{key:"infos",className:"thumbnail-infos"},this._renderInfos())),s.createElement("div",{className:"thumbnail-col"},e)},_renderThumbnail:function(){if(this.props.pictures instanceof Array==!1||0===this.props.pictures.length)return null;var e="generic"===this.props.type||"radio"===this.props.type&&1===this.props.id?void 0:this.props.data;return s.createElement("div",{key:"thumbnail",className:"thumbnail-wrapper"},s.createElement(r,{id:this.props.id,md5:this.props.pictures[0].md5,type:this.props.type,picture_type:this.props.pictures[0].type,multi_cover:!0,width:250,height:250,play:this.props.play_button,preview:!0,radio:"radio"===this.props.type||"user"===this.props.type,title:this.props.title,context_menu:e,context:"home_"+this.props.type+("user"===this.props.type?"_radio":""),overlay_force:this.props.title?!0:!1,target:this.props.target,onClick:n.bind(this)}))},_renderInfos:function(){var e="string"==typeof this.props.caption;if(e)return s.createElement("p",{className:"heading-2-sub"},this.props.caption);var t=this.props.tags.map(function(e){return{LABEL:e}});return s.createElement(i,{tags:t,type:"text",link:gatekeeper.isAllowed("search_tag")})}});t.exports=o},{"../../navigate":32,"@deezer/components/common/TagList":129,"@deezer/components/common/Thumbnail":130,react:"react"}],27:[function(e,t,a){(function(a){"use strict";var s=e("babel-runtime/helpers/extends")["default"],r=e("react"),i=e("../../navigate"),n=e("../../standardize"),o=e("../../Type"),l=e("../items/DeeplinkList"),c=a.live,p=r.createClass({displayName:"DeeplinkListLayout",propTypes:{title:r.PropTypes.string,subtitle:r.PropTypes.string,separator:r.PropTypes.bool,target:r.PropTypes.string,items:r.PropTypes.array.isRequired,section_id:r.PropTypes.string.isRequired},statics:{SUPPORTED_TYPES:[o.Generic,o.Deeplink]},componentDidMount:function(){this._logDisplay()},render:function(){return r.createElement("div",{className:"home-nav home-list home-list-"+this.props.items.length+" clearfix"},this._renderTitle(),r.createElement("div",null,this._renderItems()))},_renderTitle:function(){if("undefined"==typeof this.props.title)return null;var e={};return"undefined"!=typeof this.props.target&&(e.onClick=i.bind(this)),r.createElement("div",s({className:"home-title"},e),r.createElement("h3",{className:"heading-3"},this.props.title),this._renderSubTitle())},_renderSubTitle:function(){return"undefined"==typeof this.props.subtitle?null:r.createElement("h4",{className:"heading-4-sub"},this.props.subtitle)},_renderItems:function(){return this.props.items.map(this._renderItem)},_renderItem:function(e,t){if(-1===p.SUPPORTED_TYPES.indexOf(e.type))throw new Error('Items of type "'+e.type+'" are not handled by the DeeplinkList layout.');return r.createElement(l,s({key:t},n(e)))},_logDisplay:function(){c.log.send("navigation",{event:"onDisplay",properties:{section:this.props.section_id}})}});t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../Type":18,"../../navigate":32,"../../standardize":33,"../items/DeeplinkList":19,"babel-runtime/helpers/extends":294,react:"react"}],33:[function(e,t,a){"use strict";var s=e("babel-runtime/core-js/object/assign")["default"],r=function(e){e=s({},e);var t={album:"ALB_ID",app:"APP_ID",artist:"ART_ID",playlist:"PLAYLIST_ID",radio:"RADIO_ID",show:"SHOW_ID",track:"SNG_ID",user:"USER_ID"};return t[e.type]&&(e.id=Number(e.data[t[e.type]])),e};t.exports=r},{"babel-runtime/core-js/object/assign":285}],19:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../navigate"),n=s.createClass({displayName:"DeeplinkListItem",propTypes:{type:s.PropTypes.string.isRequired,target:s.PropTypes.string.isRequired,icon:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,item_id:s.PropTypes.string.isRequired},render:function(){var e=r({"icon icon-home":!0,"icon-top-playlist":"top"===this.props.icon,"icon-new-releases":"new_release"===this.props.icon,"icon-hear-this":"feed"===this.props.icon,"icon-mix":"mix"===this.props.icon,"icon-podcast":"show"===this.props.icon,"icon-user":"profile"===this.props.icon,"icon-download":"download"===this.props.icon,"icon-album":"album"===this.props.icon,"icon-playlist":"playlist"===this.props.icon,"icon-love":"favorite"===this.props.icon,"icon-app":"app"===this.props.icon,"icon-link":"default"===this.props.icon});return s.createElement("div",{className:"home-list-item"},s.createElement("div",{className:"nano-card-item has-shadow",onClick:i.bind(this)},s.createElement("span",{className:e}),s.createElement("span",{className:"heading-4"},this.props.title),s.createElement("span",{className:"icon icon-16 icon-arrow-right pull-right"})))}});t.exports=n},{"../../navigate":32,classnames:"classnames",react:"react"}],32:[function(e,t,a){(function(e){"use strict";var a=e.live,s=function(){return a.log.send("navigation",{event:"onClick",properties:{id:this.props.item_id,type:this.props.type}}),"string"==typeof this.props.target?/^\//.test(this.props.target)?void www.navigate(this.props.target):void(document.location=this.props.target):void 0};t.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(e,t,a){"use strict";var s={Generic:"generic",Deeplink:"deeplink",Album:"album",Artist:"artist",App:"app",Playlist:"playlist",Radio:"radio",Show:"show",Track:"track",User:"user",Native:"native"};t.exports=s},{}],258:[function(e,t,a){"use strict";var s=e("jquery"),r=e("../core/i18n"),i=r.gettext,n=r.ngettext,o={id:0,template:"naboo/feed",card_id:0,nb_card:10,unread:0,loadComplete:!1,initialized:!1,ads_position:0,non_displayed_cards:{},waveform_id:[],current_yscroll:0,current_play_sng_id:0,last_play_sng_id:0,total_cards_height:0,total_cards:0,on_scroll:!1,timeout_id:0,nb_scroll:1,current_separator_timestamp:0,first_week_separator_added:!1,first_day_separator_added:!1,storage:[],nb_cards_noads:0,nb_cards_noads_on_prepend:0,next_refresh_timeout_id:0,is_webview:!1,comment_height:{},comment_height_total:0,waveform_selector:["#content > .card-edito-track > .info > .info-down > .progress_bar","#content > .share-song > .info > .card-follow > .track > .info > .progress_bar","#content > .card-social > .info > .card-follow > .track > .info > .progress_bar","#content > .card-trending > .info > .info-down .progress_bar"].join(","),more_friend_selector:"#content > .card-social > .info .show-more-friends",comment_button_selector:"#content > .card > footer > .btn-comment",init:function(){try{return o.registerHelper(),o.initialized=!0,o.first_week_separator_added=!1,o.first_day_separator_added=!1,o.updateUnread(0),s(document).on("click",o.waveform_selector,function(e){var t=s(this).data(),a=s("#"+t.cardId),r=s((a.hasClass("share-song")?".card-follow ":"")+"figure > a",a);if(o.current_play_sng_id===t.id){if(0===dzPlayer.position||o.current_play_sng_id!==dzPlayer.getCurrentSong("SNG_ID"))return r.trigger("click"),!0;var i=(e.pageX-s(this).offset().left)/s(this).width();dzPlayer.control.seek(i)}else r.trigger("click")}),s(document).on("click",o.more_friend_selector,function(e){e.preventDefault();var t=s(this).parent().parent();s(".hide",t).removeClass("hide"),s(".btn",t).hide()}),s(document).on("click",o.comment_button_selector,function(){var e=s(this),t=e.data(),a=e.parent().next(),r=a.outerHeight()+e.offset().top+e.parent().outerHeight();a.commentbox({type:t.type,nb:10,start:4,element_id:t.elementId,content_id:t.trackingId,infinite_scroll:!1,publish_on_enter:!0,adjust_onscroll:!0,display:!1,counter:e,addCallback:o.addToStorageComment,displayCallback:o.displayCommentCallback,template:"feed"}),!a.is(":visible")&&r>client_height&&s("#page_content").animate({scrollTop:o.current_yscroll+r-client_height},"slow"),a.finish().slideToggle(function(){o.displayCommentCallback(t.trackingId)})}),"undefined"!=typeof live&&o.is_webview===!0&&0!==USER.USER_ID&&(live.addInternalChannel(USER.USER_ID+"_"+USER.USER_ID+"_STREAM"),live.addInternalChannel("-1_"+USER.USER_ID+"_USERFEED_"+USER.USER_ID)),o.initEventsSubscribe(),!0}catch(e){error.log(e)}},initEventsSubscribe:function(){try{var e=s("body > .page-wrapper > .page-header").height(),t=o.current_feed_window_bottom=client_height-e;Events.subscribe(Events.layout.resize,function(){t=client_height-e},"feed"),Events.subscribe(Events.player.playerLoaded,function(){o.current_play_sng_id=dzPlayer.getCurrentSong("SNG_ID")},"feed"),Events.subscribe(Events.layout.scroll,function(e,a){0!==a.yscroll&&(o.current_yscroll=a.yscroll),o.current_feed_window_bottom=a.yscroll+t,o.timeout_id>0||(o.timeout_id=setTimeout(function(){o.timeout_id=0;var e=o.current_yscroll-a.yscroll;Math.abs(e)>1500||o.logDisplayedCard()},1e3))},"feed"),Events.subscribe(Events.player.play,function(){0!==o.current_play_sng_id&&jQuery.inArray(o.current_play_sng_id,o.waveform_id)>-1&&s(".waveform_"+o.current_play_sng_id,"#content").css("width","0%"),o.current_play_sng_id=dzPlayer.getCurrentSong("SNG_ID"),o.current_play_sng_duration=dzPlayer.getCurrentSong("DURATION")},"feed"),Events.subscribe(Events.player.position,function(e,t){jQuery.inArray(o.current_play_sng_id,o.waveform_id)>-1&&o.current_play_sng_id===dzPlayer.getCurrentSong("SNG_ID")&&o.setWaveformPosition(o.current_play_sng_id,t)},"feed")}catch(a){error.log(a)}},display:function(){try{o.initialized||o.init();var e=["song","album","artist","playlist","radio","show","episode"];o.is_webview||e.push("promo");var t=function(){api.call("musicfeed.getList",{last_card_id:o.card_id,nb:o.nb_card,filter_types:e},o.draw,{api_called:!0})};return o.on_scroll?t():(templating.load(o.template),o.is_webview===!1&&naboo.afterLoad(!0),o.card_id=0,o.total_cards=0,o.ads_position=0,o.nb_cards_noads=0,ads.feed_ads_position=0,o.current_separator_timestamp=0,o.loadComplete=!1,o.storage.length>0&&(t=function(){o.draw(o.storage,!1)}),o.is_webview===!0?o.drawWebviewFlowHeader(t):t()),!0}catch(a){error.log(a)}},displayNextCard:function(){try{var e="feed"!==www.getCurrentPath()&&o.is_webview===!1?o.addToStorage:o.draw;api.call("musicfeed.getList",{last_card_id:0,nb:1},e,{api_called:!0,prepend_data:!0})}catch(t){error.log(t)}},addToStorage:function(e){try{if("undefined"!=typeof e.data&&e.count>0){var t=e.data[0];o.storage.unshift(t),o.updateUnread(),"undefined"!=typeof e.next_refresh&&o.setNextRefresh(e.next_refresh)}}catch(a){error.log(a)}},addToStorageComment:function(e,t){try{for(var a in o.storage)if(o.storage.hasOwnProperty(a)&&o.storage[a].CARD_ID===e){delete t.DISPLAY,o.storage[a].COMMENTS.data.unshift(t),o.storage[a].COMMENTS.count++,o.storage[a].COMMENTS.total++;break}}catch(s){error.log(s)}},displayCommentCallback:function(e){try{o.comment_height[e]=0;var t=s("#"+e+" > .comments");t.is(":visible")&&(o.comment_height[e]=t.height()),o.comment_height_total=0;for(var a in o.comment_height)o.comment_height.hasOwnProperty(a)&&(o.comment_height_total+=o.comment_height[a])}catch(r){error.log(r)}},setNextRefresh:function(e){try{var t=1e3*e||2147483647;t=t>=2147483647?2147483647:t,o.next_refresh_timeout_id>0&&clearTimeout(o.next_refresh_timeout_id),o.next_refresh_timeout_id=setTimeout(function(){o.displayNextCard()},t)}catch(a){error.log(a)}},updateUnread:function(e){try{o.unread="undefined"==typeof e?o.unread+1:e,0===o.unread?s("#feed_counter").text("").hide():s("#feed_counter").text(o.unread).fadeIn()}catch(t){error.log(t)}},drawWebviewFlowHeader:function(e){try{var t=Handlebars.templates.webview_feed_flow,a=t({USER_ID:USER.USER_ID,USER_PICTURE:USER.USER_PICTURE,TITLE:i("Bonjour %s !",{sprintf:[USER.BLOG_NAME]})});s("#content").append(a).find('[data-target="flow"]').replaceWith(button_multi_state.draw({id:USER.USER_ID,action:"play",type:"user",radio:!0,wording:"full",color:"primary",color_equalizer:"inverse",play_context:"feed_user_radio",tracking:1,tracking_tag:"flow_click",tracking_params:"{'type': 'flow', 'instance': 'feed'}"})),"function"==typeof e&&e()}catch(r){error.log(r)}},draw:function(e,t){try{var a,r,i="",n=t.api_called||!1,l=t.prepend_data||!1;if(n){if("undefined"!=typeof e.end&&(o.loadComplete=!0),"undefined"!=typeof e.next_refresh&&(o.card_id<=0||l)&&o.setNextRefresh(e.next_refresh),a=e.data,o.storage=o.storage.concat(a),null===a||a.length<=0)return!1}else a=e;for(var c=a.length,p=0;c>p;p++)if(r="","undefined"!=typeof advertising&&USER.OPTIONS.ads_display&&(l&&o.nb_cards_noads_on_prepend%5===0||0!==o.total_cards&&o.nb_cards_noads%5===0)&&"undefined"!=typeof Handlebars.templates.feed_ads&&(r=o.drawAdsCard()),"PROMO"===a[p].TYPE&&(a[p].data.img_small=a[p].data.img370x300||a[p].data.img730x300,a[p].data.img_big=a[p].data.img578x300||a[p].data.img1028x300,a[p].data.img_drive=a[p].data.img302x244||a[p].data.img1028x300),"undefined"!=typeof a[p]&&null!==a[p]&&""!==a[p]&&"undefined"!=typeof a[p].typ&&("undefined"!=typeof Handlebars.templates[a[p].TEMPLATE]||"undefined"!=typeof Handlebars.templates["webview_"+a[p].TEMPLATE])){if(a[p].USER_PICTURE=USER.USER_PICTURE,a[p].USER_ID=USER.USER_ID,"undefined"!=typeof a[p].COMMENTS&&a[p].COMMENTS.count>0)for(var d=a[p].COMMENTS.count,u=0;d>u;u++){var h=a[p].COMMENTS.data[u];h.TYPE=a[p].TYPE.toLowerCase(),h.ELEMENT_ID=h.USER_ID===USER.USER_ID?o.getIdFromType(a[p].TYPE,a[p].DATA):!1,h.COMMENT=s("<div/>").html(h.COMMENT).text()}l?(i+=o.drawCard(a[p])+r,o.nb_cards_noads_on_prepend+=1):(i+=r+o.drawCard(a[p]),o.card_id=a[p].CARD_ID,o.nb_cards_noads+=1),n&&(o.non_displayed_cards[a[p].CARD_ID]={}),o.total_cards++}if(l){var m=s(i);m.hide();var _=s("#content > .divider:eq(0)");_.after(m),m.fadeIn("slow")}else s("#content").append(i),s("#page_content").scrollTop(o.current_yscroll),o.activeScroll(),o.on_scroll=!1,o.nb_card=10;if(Events.trigger(Events.navigation.page_updated),jQuery.inArray(o.current_play_sng_id,o.waveform_id)>-1&&dzPlayer.getCurrentSong("SNG_ID")===o.current_play_sng_id&&o.setWaveformPosition(o.current_play_sng_id,dzPlayer.position),calculeTime(),n){var y,g;for(var f in o.non_displayed_cards)o.non_displayed_cards.hasOwnProperty(f)&&(y=s("#"+f),g=s("aside > span > figure",y).height(),y.length>0&&(o.non_displayed_cards[f]={t:y.position().top+20-o.comment_height_total,h:g}));0===o.current_yscroll&&o.logDisplayedCard()}}catch(b){error.log(b)}},drawCard:function(e){try{var t="",a=o.is_webview===!0?"webview_"+e.TEMPLATE:e.TEMPLATE,s=Handlebars.templates[a];return("snge"===e.typ||"sngf"===e.typ||"sngt"===e.typ||"sngs"===e.typ)&&("undefined"!=typeof e.DATA.FALLBACK&&(e.DATA=e.DATA.FALLBACK),-1===jQuery.inArray(e.DATA.SNG_ID,o.waveform_id)&&o.waveform_id.push(e.DATA.SNG_ID),thumbnails.current_song_id===e.DATA.SNG_ID&&(o.current_play_sng_id=dzPlayer.getCurrentSong("SNG_ID"),o.current_play_sng_duration=dzPlayer.getCurrentSong("DURATION"))),t+=o.drawSeparator(e.TIMESTAMP),t+=s(e)}catch(r){error.log(r)}},drawAdsCard:function(){try{var e="",t=Handlebars.templates.feed_ads;return e+=t({ads_position:o.ads_position}),o.ads_position++,advertising.call("multiple_feed",o.ads_position),e}catch(a){error.log(a)}},drawSeparator:function(e){try{var t="",a=o.is_webview===!0?"webview_feed_separator":"feed_separator",s="undefined"!=typeof Handlebars.templates[a]?Handlebars.templates[a]:"";if("undefined"==typeof e||""===e||0>e)return t;var r=localTimeStamp()-e;if(518400>=r)if(86400>r&&o.first_day_separator_added===!1&&(o.first_day_separator_added=!0,t=s({date:i("Recommandé pour vous aujourd'hui")})),r>=86400&&172800>=r){var n=Math.floor(r/86400);n!==Math.floor(o.current_separator_timestamp/86400)&&(o.current_separator_timestamp=r,t=s({date:getAgoTime(r)}))}else r>172800&&o.first_week_separator_added===!1&&(o.first_week_separator_added=!0,t=s({date:i("Il y a quelques jours")}));else if(r>518400&&2592e3>=r){var l=Math.round(r/604800);l!==Math.round(o.current_separator_timestamp/604800)&&(o.current_separator_timestamp=r,t=s({date:getAgoTime(r)}))}else{var c=Math.round(e/2592e3),p=new Date(1e3*e);if(Math.round(r/2592e3)>12){var d=Math.round(e/31536e3);d!==Math.round(o.current_separator_timestamp/31536e3)&&(o.current_separator_timestamp=e,t=s({date:p.getFullYear()}))}else if(c!==Math.round(o.current_separator_timestamp/2592e3)){var u=c>1?getShortMonthName((parseInt(p.getMonth(),10)+1).toString())+" "+p.getFullYear():getAgoTime(r);o.current_separator_timestamp=e,t=s({date:u})}}return t}catch(h){error.log(h)}},setWaveformPosition:function(e,t){try{var a=100*t/o.current_play_sng_duration;s(".waveform_"+e,"#content").css("width",a+"%")}catch(r){error.log(r)}},activeScroll:function(){try{infinite_scroll.disable(),o.loadComplete||(Events.subscribeOnce(Events.layout.infiniteScroll,function(){o.on_scroll=!0,o.nb_scroll+=1,o.display()},"feed"),infinite_scroll.active(s("#content")))}catch(e){error.log(e)}},flushCache:function(){o.storage=[],o.current_yscroll=0},tracking:function(e,t,a){try{return o.is_webview===!1&&"function"==typeof a&&(a(),a=null),api.call("musicfeed.log",{action:e,params:{card_id:t,dev:{v:STATIC_VERSION,t:o.is_webview===!0?"6":"0"}}},a),!0}catch(s){error.log(s)}},leave:function(){try{return s(document).off("click",o.waveform_selector),s(document).off("click",o.more_friend_selector),s(document).off("click",o.comment_button_selector),s(document).off("keypress keydown keyup"),Events.unsubscribeAll("header_flow"),!0}catch(e){error.log(e)}},logDisplayedCard:function(){try{for(var e in o.non_displayed_cards)if(o.non_displayed_cards.hasOwnProperty(e)){var t=o.non_displayed_cards[e].t+o.comment_height_total,a=o.non_displayed_cards[e].h,s=t+Math.round(a/2);o.current_yscroll<t&&o.current_feed_window_bottom>s&&(o.tracking("display",e),delete o.non_displayed_cards[e])}return!0}catch(r){error.log(r)}},getIdFromType:function(e,t){try{return"undefined"==typeof e||"undefined"==typeof t?!1:"ALBUM"===e?t.ALB_ID:"PLAYLIST"===e?t.PLAYLIST_ID:!0}catch(a){error.log(a)}},registerHelper:function(){try{return Handlebars.registerHelper("sticker",function(e,t,a){if("undefined"==typeof e||"undefined"==typeof t)return!1;var s=new Date(e).getFullYear(),r=t.match(/\d{4}/);return r=null!==r?Number(r[0]):s,r===s&&dateToTimestamp(CURRENT_DATE)-dateToTimestamp(e)<=2678400?a.fn():a.inverse()}),Handlebars.registerHelper("formatDate",function(e){return"undefined"==typeof e?!1:formatDate(e,"/")}),Handlebars.registerHelper("textSizeLimit",function(e,t){return"undefined"==typeof e||"undefined"==typeof t||isNaN(t)?!1:e.length>t?e.substr(0,t)+"...":e}),Handlebars.registerHelper("favorite_status",function(e){var t=e.hash.id+("song"===e.hash.type?"_0":"");return userData.isFavorite(e.hash.type,t)?e.fn():e.inverse()}),Handlebars.registerHelper("artistsList",function(e,t){if(!e)return!1;if(!e.ARTISTS||!e.ARTISTS.length)return t.fn(e);for(var a,r=e.ARTISTS,i=[],n=[],o=0,l=r.length;l>o;o++)a=r[o],"0"!==a.ROLE_ID&&"5"!==a.ROLE_ID||-1!==s.inArray(a.ART_ID,i)||(i.push(a.ART_ID),n.push(t.fn(a)));return n.join(", ")}),Handlebars.registerHelper("tracksList",function(e,t){if("undefined"==typeof e||"undefined"==typeof t.hash.length)return!1;for(var a=e.length,s=t.hash.length,r="",i=0,n=0;a>n;n++)if(right.checkSongAvailable(e[n])===right.READABLE){if(e[n].track_index=n,r+=t.fn(e[n]),i>=s-1)return r;i++}return r}),Handlebars.registerHelper("friendsList",function(e,t){if("undefined"==typeof e||"undefined"==typeof t.hash.length)return!1;for(var a,s=e.length,r=3>=s?e.length:2,o=15,l=[],c="",p=0;r>p;p++)2!==s&&3!==s||p+1!==r?l.push(t.fn(e[p])):c=" "+i("et")+" "+t.fn(e[p]);if(1===s)a=i("a écouté ce titre.");else if(s>1&&4>s)a=i("ont écouté ce titre.");else{var d,u,h=Math.round(s-r);s>o?(d='<a class="link-primary show-more-friends">',u="</a>"):(d="<strong>",u="</strong>"),a=n("et %s%s autre%s de vos amis ont écouté ce titre.","et %s%s autres%s de vos amis ont écouté ce titre.",{sprintf:[d,h,u],count:h})}return l.join(", ")+c+" "+a}),Handlebars.registerHelper("enum",function(e,t){if("undefined"==typeof e)return!1;for(var a,s=t.hash.length&&t.hash.length<=e.length?t.hash.length:e.length,r="",i=0;s>i;i++)null!==e[i]&&(a=e[i],r=r+t.fn(a)+(i>=s-1?".":", "));var n=("alba"===this.typ||"albr"===this.typ||"albe"===this.typ)&&this.DISCOGRAPHY.total>s,o=("plse"===this.typ||"plsa"===this.typ)&&this.PLAYLIST_ARTISTS.total>s;return n||o?r.substring(0,r.length-1):r}),!0}catch(e){error.log(e)}}};Events.subscribe(Events.live.events,function(e,t){return 0===t.length?!1:"undefined"!=typeof t[0].ACTION&&"MUSICFEED_NEW"!==t[0].ACTION?!1:void("feed"!==www.getCurrentPath()&&o.is_webview===!1?o.updateUnread():o.displayNextCard())}),t.exports=o},{"../core/i18n":245,jquery:"jquery"}],257:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("jquery"),n=e("../core/i18n"),o=n.ngettext,l=e("../components/common/grid/Grid"),c={type:"",element_id:0,nb:20,start:0,data:[],loadComplete:!1,rendering:!1,display:function(e){try{if(c.rendering)return;c.rendering=!0,c.type=e.type,c.element_id=e.id,"undefined"!=typeof e.start&&(c.start=e.start);var t,a={start:c.start,nb:c.nb,country_name:!0};switch(c.type){case"playlist":t="playlist.getFans",a.playlist_id=c.element_id;break;case"artist":t="artist.getFans",a.art_id=c.element_id;break;case"album":t="album.getFans",a.alb_id=c.element_id}api.call(t,a,c._displayCallback)}catch(s){c.rendering=!1,error.log(s)}},destroy:function(){c.start=0,c.data=[];var e=document.getElementById("naboo_fan_list");e&&r.unmountComponentAtNode(e)},onDisplay:function(){this._reload()},_displayCallback:function(e){try{var t=document.getElementById("naboo_fan_list");if(!t)return;c.loadComplete=e.total<=parseInt(c.start+c.nb,10),c.data=c.data.concat(e.data);var a={data:c.data,type:"user",context:"artist_page",tab:"fan_tab",options:["name","follow"]};r.render(s.createElement(l,a),t,function(){c._activateListeners(),c.rendering=!1});var n=i("#naboo_fan_title");if(e.count>0){if(0===c.start){n.show();var p=window[c.type].data.NB_FAN;n.html(o("%s Fan","%s Fans",{count:p,sprintf:[breakUpThousands(p)]}))}}else n.hide();return Events.trigger(Events.navigation.tab_displayed,{type:c.type,id:c.element_id}),!0}catch(d){error.log(d)}},_reload:function(){c.start=0,c.data=[],c.display({id:c.element_id,type:c.type})},_activateListeners:function(){c.loadComplete?infinite_scroll.disable():(Events.subscribeOnce(Events.layout.infiniteScroll,function(){infinite_scroll.disable(),c.display({id:c.element_id,type:c.type,start:c.start+c.nb})},"fan"),infinite_scroll.active()),Events.subscribeOnce(Events.user.addFavorite,function(e,t){t.id&&Number(t.id)===Number(c.element_id)&&this._reload()}.bind(this),"fan"),Events.subscribeOnce(Events.user.deleteFavorite,function(e,t){t.id&&Number(t.id)===Number(c.element_id)&&this._reload()}.bind(this),"fan")}};t.exports=c},{"../components/common/grid/Grid":134,"../core/i18n":245,jquery:"jquery",react:"react","react-dom":"react-dom"}],256:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("jquery"),n=e("../components/common/grid/Grid"),o=e("@deezer/components/common/GenreList/GenreList"),l={initialized:!1,template:"naboo/explore",tab:"genres",default_genre:0,genre_id:0,grid:!1,pagination:{start:0,nb:20,max:500},loading:!1,data:[],init:function(){try{if(l.initialized)return!1;templating.load(l.template),l.genre_id=storage.isset("explore_genre")?storage.get("explore_genre"):l.genre_id;var e=document.getElementById("page_explore_genres");return e&&r.render(s.createElement(o,{onSelect:l.onChangeGenre,selectedId:Number(l.genre_id)}),e),l.pagination.start=0,l.initialized=!0,!0}catch(t){error.log(t)}},display:function(e){try{return l.init(),l.onPageChanged(e),!0}catch(t){error.log(t)}},onPageChanged:function(e){var t=e.id||l.genre_id;l.load(t,null,!0)},load:function(e,t){try{if(l.loading===!0)return!1;l.loading=!0;var a=l.genre_id;l.genre_id=Number(e),t="undefined"!=typeof t&&t?i.extend(l.pagination,t):i.extend({},l.pagination),a!==e&&(t=i.extend(l.pagination,t,{start:0}));var s="/explore";0!==e&&(s+="/"+l.tab+"/"+e),www.setCurrentPath(s,!0),api.call("deezer.pageExplore",{USER_ID:USER.USER_ID,COUNTRY:COUNTRY,FILTER:e,START:t.start,NB:t.nb},l.loadCallback)}catch(r){error.log(r)}},loadCallback:function(e){try{return l.loading=!1,0===l.pagination.start&&(l.pagination.max=e.ITEMS.total),storage.set("explore_genre",l.genre_id),l.renderGenres(e),naboo.afterLoad(0===l.pagination.start),!0}catch(t){error.log(t)}},renderGenres:function(e){try{return("undefined"==typeof e.ITEMS||"undefined"==typeof e.ITEMS.data||e.ITEMS.count<=0)&&infinite_scroll.disable(),l.renderGenresReleases(e.ITEMS),l.rendered=!0,Events.trigger(Events.navigation.page_updated),!0}catch(t){error.log(t)}},renderGenresReleases:function(e){try{var t=document.getElementById("explore_last_releases_grid");if(!t||"undefined"==typeof e||"undefined"==typeof e.data)return!1;l.data.length?l.data=l.data.concat(e.data):l.data=e.data;var a={data:l.data,context:"explore_releases_album",options:["type","name","artist","release_date","favorite","sticker","play_link"]};return r.render(s.createElement(n,a),t,l.activeInfiniteScroll),!0}catch(i){error.log(i)}},activeInfiniteScroll:function(){return l.pagination.start+l.pagination.nb>=l.pagination.max?(infinite_scroll.disable(),!1):(Events.subscribeOnce(Events.layout.infiniteScroll,function(){infinite_scroll.disable(),l.load(l.genre_id,{start:l.pagination.start+l.pagination.nb,nb:l.pagination.nb})},"explore"),void infinite_scroll.active())},onChangeGenre:function(e){try{return l.data=[],l.start=0,Number(e.GENRE_ID)===Number(l.genre_id)?!1:(l.load(e.GENRE_ID),tracking.track("explore_genres_select_click",{genre_id:e.GENRE_ID,genre_name:addslashes(e.GENRE_NAME)}),!0)}catch(t){error.log(t)}},leave:function(){l.data=[],l.initialized=!1;var e=document.getElementById("explore_last_releases_grid"),t=document.getElementById("page_explore_genres");e&&r.unmountComponentAtNode(e),t&&r.unmountComponentAtNode(t)}};t.exports=l},{"../components/common/grid/Grid":134,"@deezer/components/common/GenreList/GenreList":121,jquery:"jquery",react:"react","react-dom":"react-dom"}],121:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/genre"),i=e("@deezer/components/common/DropDown"),n=s.createClass({displayName:"GenreList",propTypes:{onSelect:s.PropTypes.func.isRequired,type:s.PropTypes.number,selectedId:s.PropTypes.number,withoutGenreAll:s.PropTypes.bool},getDefaultProps:function(){return{selectedId:0,type:r.FILTER_MUSIC,withoutGenreAll:!1}},getInitialState:function(){return Events.subscribe(Events.genre.loaded,this._onGenreLoaded),{genreList:r.getList(this.props.type),selectedId:this.props.selectedId}},componentWillUnmount:function(){Events.unsubscribe(Events.genre.loaded,this._onGenreLoaded)},render:function(){if(0===this.state.genreList.length)return null;var e=this.state.genreList.map(function(e,t){return this.props.withoutGenreAll&&0===e.GENRE_ID?null:s.createElement(i.Item,{key:t,label:e.GENRE_NAME},s.createElement("a",{onClick:this._onSelect.bind(this,e),href:"#"},e.GENRE_NAME))}.bind(this));return s.createElement("div",{className:"toolbar-group pull-right"},s.createElement("div",{className:"btn-group"},s.createElement(i,{selected:this._getSelected()},e)))},_onSelect:function(e,t){t.preventDefault(),this.setState({selectedId:Number(e.GENRE_ID)}),this.props.onSelect(e)},_onGenreLoaded:function(e,t){this.setState({genreList:t.genre})},_defaut:0,_getSelected:function(){if("function"==typeof this.state.genreList.findIndex){var e=this.state.genreList.findIndex(this._predicate,this);return-1===e?this._default:e}for(var t=0,a=this.state.genreList.length;a>t;t++)if(this._predicate(this.state.genreList[t]))return t;return this._default},_predicate:function(e){return this.state.selectedId===e.GENRE_ID}});t.exports=n},{"../../../core/genre":244,"@deezer/components/common/DropDown":118,react:"react"}],244:[function(e,t,a){"use strict";function s(e){return isNaN(e)&&(e=n),api.call({method:"deezer.getGenres",data:{FILTER:e},success:function(t){p[e]=t,c[e]=!0,Events.trigger(Events.genre.loaded,{genre:t})}}),[]}function r(e){return c[e]?!0:!1}function i(e){return r(e)?p[e]:s(e)}var n=1,o=4,l=8,c={},p={};t.exports={FILTER_MUSIC:n,FILTER_TALK:o,FILTER_MOODS:l,getList:i}},{}],255:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("@deezer/components/common/Discography"),n={initialized:!1,loadComplete:!1,pagination:{start:0,nb:15,max:500},sort:"type",art_id:0,data:[],init:function(){try{return n.initialized?!0:(n.initialized=!0,n.pagination.start=0,n.data=[],!0)}catch(e){error.log(e)}},display:function(e){try{return n.init(),n.art_id=e.art_id,"undefined"!=typeof e.page&&(n.page=e.page),"undefined"!=typeof e.start&&(n.pagination.start=e.start),0===n.pagination.start&&(n.loadComplete=!1),n.sort!==e.sort&&(n.data=[],n.pagination.start=0,n.sort=e.sort),"object"==typeof e.data?(n.displayCallback(e.data),!0):(api.call({method:"album.getDiscography",data:{art_id:n.art_id,start:n.pagination.start,nb:n.pagination.nb,sort:n.sort,filter_role_id:[0,1,5]},success:n.displayCallback}),!0)}catch(t){error.log(t)}},displayCallback:function(e){try{if("undefined"==typeof e||"undefined"==typeof e.data)return infinite_scroll.disable(),!1;if(0===n.pagination.start&&(n.pagination.max=e.total,0===n.pagination.max))return Events.trigger(Events.navigation.tab_displayed,{id:n.art_id,type:"discography"}),!1;if(0===n.data.length?n.data=e.data:n.data=n.data.concat(e.data),n.container=document.getElementById("discography_artist"),n.container){var t={data:n.data,format:"small",onSort:n.onSortLoad,total:n.pagination.max,tracking:"artist"===n.page};r.render(s.createElement(i,t),n.container,n.activeInfiniteScroll)}return Events.trigger(Events.navigation.tab_displayed,{id:n.art_id,type:"discography"}),!0}catch(a){error.log(a)}},onSortLoad:function(e){Events.unsubscribeAll("discography"),n.display({art_id:n.art_id,start:n.pagination.start+n.pagination.nb,nb:n.pagination.nb,sort:e})},activeInfiniteScroll:function(){return n.pagination.start+n.pagination.nb>=n.pagination.max?(infinite_scroll.disable(),!1):(Events.subscribeOnce(Events.layout.infiniteScroll,function(){infinite_scroll.disable(),n.display({art_id:n.art_id,start:n.pagination.start+n.pagination.nb,nb:n.pagination.nb,sort:n.sort})},"discography"),void infinite_scroll.active())},destroy:function(){Events.unsubscribeAll("discography"),n.container&&r.unmountComponentAtNode(n.container),n.pagination.start=0,n.data=[]}};t.exports=n},{"@deezer/components/common/Discography":114,react:"react","react-dom":"react-dom"}],254:[function(e,t,a){"use strict";var s=e("react"),r=e("react-dom"),i=e("jquery"),n=e("../core/i18n"),o=n.gettext,l=n.ngettext,c=e("../components/common/List"),p=e("../components/common/Discography"),d=e("../components/common/DataGrid"),u=e("../components/common/Thumbnail"),h={id:0,template:"catalog/artist",data:[],type:"",DISPLAY_SMALL:"small",DISPLAY_BIG:"big",minWidth:1200,display:function(e){return"string"!=typeof e.art_id?!1:(h.id=h.art_id=parseInt(e.art_id,10),"object"==typeof e.data?void Events.ready(Events.user.initialized,function(){h.displayCallback(e.data)}):(api.call("deezer.pageArtist",{art_id:h.id,lang:SETTING_LANG},h.displayCallback),!0))},displayCallback:function(e){templating.load(h.template),h.data=e,h.data.NB_FAN=e.DATA.NB_FAN,h.type=window.getClientWidth()>h.minWidth?h.DISPLAY_BIG:h.DISPLAY_SMALL,h.displayCatalogMessage();var t={discography:{selected:!0,args:{art_id:h.id,data:h.data.ALBUMS,page:"artist"}},top_track:{disabled:"undefined"==typeof h.data.TOP||!h.data.TOP.count,args:{type:"artist_top",id:h.id}},related_playlist:{disabled:!("undefined"!=typeof h.data.RELATED_PLAYLIST&&h.data.RELATED_PLAYLIST.count||"undefined"!==h.data.SELECTED_PLAYLIST&&h.data.SELECTED_PLAYLIST.count),args:{type:"artist",id:h.id}},related:{disabled:"undefined"==typeof h.data.RELATED_ARTISTS||!h.data.RELATED_ARTISTS.count,args:{art_id:h.id}},comment:{args:{type:"artist",id:h.id}},biography:{disabled:h.data.BIO===!1||""===h.data.BIO.BIO}},a=i("#page_naboo_artist");i('[data-target="favorite"]',a).html(button_multi_state.draw({action:"favorite",type:"artist",id:h.id,elId:"add_to_library"})),i('[data-target="share"]',a).attr("onClick","sharebox.load(2, "+h.id+"); return false;"),i('[data-target="fans"]',a).append(l("Fan","Fans",{count:e.DATA.NB_FAN})).children("strong").text(breakUpThousands(e.DATA.NB_FAN)),h.data.SMARTRADIO===!1?i('[data-target="radio"]',a).remove():i('[data-target="radio"]',a).html(button_multi_state.draw({action:"play",type:"artist",radio:!0,id:h.id,color:"primary",color_equalizer:"inverse",wording:"full",play_context:"artist_smartradio",tracking:!0,tracking_tag:"artist_page_click",tracking_params:"{'type': 'mix'}"})),""!==h.data.BIO.BIO&&h.drawBiographyContent(),i('[data-target="artist_name"]',a).text(h.data.DATA.ART_NAME);var n=i('[data-target="banner"]',a),o={backgroundImage:"url("+SETTING_DOMAIN_IMG+(1===h.data.LAST_ALBUM.count?"/cover/"+h.data.LAST_ALBUM.data[0].ALB_PICTURE:"/misc/3222e780ece735f85ee9555eaa84e623")+"/250x1200-0000-80-0-0.jpg)",backgroundPosition:"center",backgroundColor:"#000"};if("undefined"!=typeof h.data.DATA.DATA&&"undefined"!=typeof h.data.DATA.DATA.ART_BANNER&&""!==h.data.DATA.DATA.ART_BANNER)o.backgroundImage="url("+SETTING_DOMAIN_IMG+"/artist/"+h.data.DATA.DATA.ART_BANNER+"/230x1800.jpg)",o.backgroundPosition=h.data.DATA.DATA.ART_BANNER_ALIGN,o.backgroundColor=h.data.DATA.DATA.ART_BANNER_BGCOLOR,"string"==typeof h.data.DATA.DATA.ART_BANNER_LINK&&""!==h.data.DATA.DATA.ART_BANNER_LINK&&(o.cursor="pointer",n.attr("onClick",'window.open("'+h.data.DATA.DATA.ART_BANNER_LINK+'")'));else{var c=document.getElementById("naboo_artist_image");c&&r.render(s.createElement(u,{id:h.id,type:"artist",width:140,height:180,width_img:250,height_img:320,cover_link:!1,bordered:!0,context_menu:h.data.DATA,md5:h.data.DATA.ART_PICTURE}),c)}return n.css(o),"undefined"!=typeof h.data.DATA.STATUS&&""!==h.data.DATA.STATUS.status?i('[data-target="status"]',a).text('"'+h.data.DATA.STATUS.status+'"'):i('[data-target="status"]',a).remove(),h.drawSocialNetwork(a),Events.subscribeOnce(Events.gigs.display,function(e,t){t.display?i('[data-target="ontour"]',a).show().on("click",function(){window.gigs.goToEvents(h.id,"artist_page")}):(i('[data-target="ontour"]',a).remove(),0===i('[data-target="social"]',a).children().length&&i('[data-target="social"]',a).remove())},"artist"),Events.subscribe(Events.layout.adsBackground,function(e,t){"show"===t.display&&h.type===h.DISPLAY_BIG&&h.toggleDisplay()},"artist"),Events.subscribe(Events.layout.resize,function(e,t){t.client_width<=h.minWidth&&h.type===h.DISPLAY_BIG?h.toggleDisplay():t.client_width>h.minWidth&&h.type===h.DISPLAY_SMALL&&h.toggleDisplay()},"artist"),Events.subscribe(Events.user.addFavorite,h.updateNbFan,"artist"),Events.subscribe(Events.user.deleteFavorite,h.updateNbFan,"artist"),h.drawTops(a),tabs.init(i("#naboo_artist_second"),t),naboo.afterLoad(!0),!0},toggleDisplay:function(){h.type=h.type===h.DISPLAY_BIG?h.DISPLAY_SMALL:h.DISPLAY_BIG,h.drawTops(i("#page_naboo_artist"))},displayCatalogMessage:function(){return"undefined"!=typeof h.data.DATA.DATA&&h.data.DATA.DATA.DISABLE_CATALOG?(i("#naboo_discography_disable_catalog").show(),!0):void i("#naboo_discography_disable_catalog").hide()},drawTops:function(e){var t=h.type===h.DISPLAY_BIG?"":"_responsive_ads";return 0===h.data.TOP.total?(i('[data-target="top-track"]',e).remove(),i('[data-target="playlist"]',e).remove(),i('[data-target="artist"]',e).remove(),i('[data-target="exclu-track"]',e).remove(),h.drawLastRelease(e),!1):(h.drawTopTrack(e),h.drawTopPlaylist(e,t),h.drawTopRelated(e,t),h.data.RELATED_ARTISTS.count||h.data.SELECTED_PLAYLIST.count||i(".visible-ads-full",e).remove(),void h.drawLastRelease(e))},drawTopTrack:function(e){var t=document.getElementById("top_track_datagrid");"object"==typeof h.data.TOP&&h.data.TOP.count>0&&t?r.render(s.createElement(d,{type:"topArtist",id:h.id,context:"artist_top",items:h.data.TOP.data}),t):i('[data-target="top-track"]',e).remove(),h.data.TOP.count<6&&i('[data-target="top-track-view-more"]',e).remove()},drawTopPlaylist:function(e,t){var a=h.data.SELECTED_PLAYLIST.data.concat(h.data.RELATED_PLAYLIST.data),n=document.getElementById("related_playlist"+t);if(a.length>0&&n){i('[data-target="playlist"] > h4 > .label',e).text(l("Playlist","Playlists",{count:a.length}));var o={data:a.slice(0,3),type:"playlist",display_fan:!0,display_creator:!1,display_track:!0,display_add:!0,context:"artist_similar_playlist"};r.render(s.createElement(c,o),n)}else i('[data-target="playlist"]',e).remove();a.length<3&&i('[data-target="playlist-view-more"]',e).remove()},drawTopRelated:function(e,t){var a=document.getElementById("related_artist"+t);if(h.data.RELATED_ARTISTS.count>0&&a){i('[data-target="artist"] > h4 > .label',e).text(l("Artiste similaire","Artistes similaires",{count:h.data.RELATED_ARTISTS.count}));var n=h.data.RELATED_ARTISTS.data,o=0;if(h.data.LAST_ALBUM.count>0){var p=h.data.LAST_ALBUM.data[0].SONGS.total;5>p&&(o=3),p>=5&&7>=p&&(o=4),8===p&&(o=5)}"_responsive_ads"===t&&(o=3);var d={data:0===o?n:n.slice(0,o),type:"artist",display_add:!0,thumbnail_rounded:!0};r.render(s.createElement(c,d),a)}else i('[data-target="artist"]',e).remove();h.data.RELATED_ARTISTS.count<3&&i('[data-target="artist-view-more"]',e).remove()},drawLastRelease:function(e){var t,a=[];h.data.LAST_ALBUM.count>0?(i('[data-target="last-release"] > h4 > .label',e).text(o("Dernière sortie")),a=h.data.LAST_ALBUM.data,t=h.data.LAST_ALBUM.data[0].SONGS.count,5>t?i(".content-bottom").addClass("xsmall"):i(".content-bottom").removeClass("xsmall"),t>=5&&7>=t?i(".content-bottom").addClass("small"):i(".content-bottom").removeClass("small"),8===t?i(".content-bottom").addClass("medium"):i(".content-bottom").removeClass("medium")):0===h.data.TOP.count&&i('[data-target="last-release"] > h4',e).empty();var n={data:a,limit:9,heading:!1,tracking:!0,context:"last_release",producerLine:t>4,addFavorite:t>4},l=document.getElementById("last_release");l&&r.render(s.createElement(p,n),l)},drawBiographyContent:function(){try{i("#tab_biography_content .naboo_artist_biography_content_photo img").attr("src",SETTING_DOMAIN_IMG+"/artist/"+h.data.DATA.ART_PICTURE+"/200x200-000000-80-0-0.jpg"),"undefined"!=typeof h.data.BIO.RESUME_FULL?i("#tab_biography_content .naboo_artist_biography_content_message").html("<b>"+h.data.BIO.RESUME_FULL+"</b><br/>"+h.data.BIO.BIO):i("#tab_biography_content .naboo_artist_biography_content_message").html(h.data.BIO.BIO)}catch(e){error.log(e)}},drawSocialNetwork:function(e){try{"undefined"!=typeof h.data.DATA.FACEBOOK&&"http"===h.data.DATA.FACEBOOK.substr(0,4)?i('[data-target="facebook"]',e).attr("href",h.data.DATA.FACEBOOK):i('[data-target="facebook"]',e).remove(),"undefined"!=typeof h.data.DATA.TWITTER&&"http"===h.data.DATA.TWITTER.substr(0,4)?i('[data-target="twitter"]',e).attr("href",h.data.DATA.TWITTER):i('[data-target="twitter"]',e).remove()}catch(t){error.log(t)}},getLiveFeed:function(){return"1_0_ARTISTFEED_"+h.id},updateNbFan:function(e,t){return Number(t.id)!==Number(h.data.DATA.ART_ID)?!1:("USER.addFavorite"===e.namespace?h.data.NB_FAN+=1:h.data.NB_FAN-=1,void i('.artist-headings [data-target="fans"]').html(l("%s Fan","%s Fans",{count:h.data.NB_FAN,sprintf:["<strong>"+breakUpThousands(h.data.NB_FAN)+"</strong>"]})))},onOpenTab:function(e){i("#page_content").scrollTop(0),tabs.display(e),tracking.track("artist_page_click",{type:e})},goToAlbum:function(){www.navigate("/album/"+h.data.LAST_ALBUM.data[0].ALB_ID),tracking.track("artist_page_click",{type:"last_release"})},leave:function(){i("#tab_discography_content").hide();var e=["related_playlist","related_artist","top_track_datagrid","last_release","discography_artist","related_playlist_responsive_ads","related_artist_responsive_ads"];e.map(function(e){var t=document.getElementById(e);t&&r.unmountComponentAtNode(t)})}};t.exports=h},{"../components/common/DataGrid":92,"../components/common/Discography":114,"../components/common/List":125,"../components/common/Thumbnail":130,"../core/i18n":245,jquery:"jquery",react:"react","react-dom":"react-dom"}],125:[function(e,t,a){"use strict";var s=e("react"),r=e("./list_items/Playlist"),i=e("./list_items/Artist"),n=e("./list_items/Album"),o=e("./list_items/Track"),l=s.createClass({displayName:"List",propTypes:{data:s.PropTypes.array.isRequired,type:s.PropTypes.string.isRequired,context:s.PropTypes.string,display_favorite:s.PropTypes.bool,display_creator:s.PropTypes.bool,display_add:s.PropTypes.bool,display_track:s.PropTypes.bool,display_fan:s.PropTypes.bool,thumbnail_rounded:s.PropTypes.bool},getDefaultProps:function(){return{display_favorite:!0,display_creator:!0,display_add:!1,display_track:!0,display_fan:!1,context:"",thumbnail_rounded:!1}},render:function(){return s.createElement("ul",{className:"nano-card-list"},this.props.data.map(function(e){switch(this.props.type){case"playlist":return s.createElement(r,{data:e,key:"playlist_"+e.PLAYLIST_ID,display_creator:this.props.display_creator,display_favorite:this.props.display_favorite,display_add:this.props.display_add,display_fan:this.props.display_fan,display_track:this.props.display_track,context:this.props.context});case"artist":return s.createElement(i,{data:e,key:"artist_"+e.ART_ID,display_favorite:this.props.display_favorite,display_add:this.props.display_add,context:this.props.context,thumbnail_rounded:this.props.thumbnail_rounded});case"album":return s.createElement(n,{data:e,key:"album_"+e.ALB_ID,display_favorite:this.props.display_favorite,display_add:this.props.display_add,context:this.props.context});case"track":return s.createElement(o,{data:e,key:"track_"+e.SNG_ID,display_favorite:this.props.display_favorite,display_add:this.props.display_add,context:this.props.context});default:return null}}.bind(this)))}});t.exports=l},{"./list_items/Album":142,"./list_items/Artist":144,"./list_items/Playlist":147,"./list_items/Track":149,react:"react"}],149:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../../core/i18n"),n=i.gettext,o=e("../../../core/context_menu"),l=e("../../_mixins/tracking"),c=e("../Thumbnail"),p=e("../Favorite"),d=s.createClass({displayName:"Track",propTypes:{id:s.PropTypes.number,display_favorite:s.PropTypes.bool,display_add:s.PropTypes.bool,display_drag:s.PropTypes.bool,data:s.PropTypes.object,index:s.PropTypes.number,selectable:s.PropTypes.bool,context:s.PropTypes.string,share_context:s.PropTypes.string,is_radio:s.PropTypes.bool,show_play:s.PropTypes.bool,play_index:s.PropTypes.number,play_data:s.PropTypes.array,enabled:s.PropTypes.bool,onClick:s.PropTypes.func,onSelect:s.PropTypes.func},contextTypes:{panel_name:s.PropTypes.string},mixins:[l],getDefaultProps:function(){return{display_favorite:!0,display_drag:!1,display_add:!1,data:null,index:null,selectable:!1,context:"",is_radio:!1,show_play:!0,play_data:[],onSelect:function(){}}},getInitialState:function(){return{selected:!1}},shouldComponentUpdate:function(e,t){return t.selected!==this.state.selected||e.data.SNG_ID!==this.props.data.SNG_ID||e.play_index!==this.props.play_index},deselect:function(){this.setState({selected:!1})},getTrackingParams:function(){return{type:"track",id:this.props.data.SNG_ID,index:this.props.index}},render:function(){var e=r({"nano-card-item":!0,checked:this.state.selected,hide:this.props.is_radio&&this.props.index>this.props.play_index}),t="undefined"!=typeof this.props.data.LYRICS_ID&&0!==this.props.data.LYRICS_ID;return s.createElement("li",{key:"track"+this.props.data.SNG_ID,className:e,onClick:this._onSelect},s.createElement("div",{className:"nano-card-picture"},s.createElement(c,{type:"track",height:56,width:56,id:Number(this.props.data.SNG_ID),md5:this.props.data.ALB_PICTURE,play:this.props.show_play,preview:!0,play_index:"queuelist"===this.context.panel_name?this.props.index:null,play_data:this.props.play_data,context:this.props.context,zoom:!1,enabled:this.props.enabled,overlay:!1})),s.createElement("div",{className:"nano-card-options"},this._renderAdd(),t?s.createElement("a",{className:"icon icon-lyrics",onClick:this._onLyricsClick,role:"button"}):"",this._renderFavorite(),this._renderDrag()),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/album/"+this.props.data.ALB_ID,"data-instance":"track_name"},this.props.data.SNG_TITLE+("string"==typeof this.props.data.VERSION&&""!==this.props.data.VERSION?" "+this.props.data.VERSION:""))),s.createElement("div",{className:"heading-4-sub ellipsis"},n("par")," ",this._renderArtistName())))},_renderArtistName:function(){return this.props.data.ARTISTS?this.props.data.ARTISTS.map(function(e,t){return 0===Number(e.ROLE_ID)||5===Number(e.ROLE_ID)?[t>0?", ":"",s.createElement("a",{href:"/artist/"+e.ART_ID,"data-instance":"artist_name"},e.ART_NAME)]:void 0}):s.createElement("a",{href:"/artist/"+this.props.data.ART_ID,"data-instance":"artist_name"},this.props.data.ART_NAME)},_renderFavorite:function(){return this.props.display_favorite?s.createElement(p,{type:"song",id:this.props.data.SNG_ID,context:this.context.panel_name}):void 0},_renderDrag:function(){return this.props.display_drag?s.createElement("span",{className:"draggable"}):void 0},_renderAdd:function(){return this.props.display_add?s.createElement("a",{className:"option-hide",onClick:this._onAdd},s.createElement("span",{className:"icon icon-options"})):void 0},_onAdd:function(e){e.preventDefault(),e.stopPropagation(),o.open({target:e.currentTarget,id:this.props.data.SNG_ID,type:"song",context:this.context.panel_name,listen_context:{TYPE:this.props.context,ID:this.props.data.SNG_ID},data:{SONG:this.props.data,INDEX:this.props.index},share_context:this.props.share_context,position:"right"})},_onSelect:function(e){e.preventDefault(),this.tracking("panel_click",e.currentTarget),"function"==typeof this.props.onClick&&this.props.onClick(e,this.props.data,this.props.index);var t=dom.dataset(e.target,"instance");if(null!==t&&dom.dataset(e.currentTarget,"instance",t),this.props.selectable&&"DIV"===e.target.tagName)return void this.setState({selected:!this.state.selected},function(){this.props.onSelect()}.bind(this));if("undefined"!=typeof t&&"play"!==t||"queuelist"!==this.context.panel_name){var a=e.target.getAttribute("href");null===a&&(a="/album/"+this.props.data.ALB_ID),loadBox(a)}},_onLyricsClick:function(e){if(e.preventDefault(),e.stopPropagation(),"queue_list"===this.props.context)Events.subscribeOnce(Events.player.displayCurrentSong,function(){Events.trigger(Events.menu.togglePanel,"lyrics")}),dzPlayer.playTrackAtIndex(this.props.index);else{Events.subscribeOnce(Events.player.tracklist_changed,function(){dzPlayer.control.nextSong(),Events.trigger(Events.menu.togglePanel,"lyrics")});var t={type:"track",id:this.props.id,radio:!1,context:{ID:this.props.id,TYPE:this.props.context},data:[this.props.data]};"radio"!==dzPlayer.getPlayerType()&&(t.addNext=!0),dzPlayer.play(t)}}});t.exports=d},{"../../../core/context_menu":242,"../../../core/i18n":245,"../../_mixins/tracking":45,"../Favorite":119,"../Thumbnail":130,classnames:"classnames",react:"react"}],147:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=r.ngettext,o=e("../../../core/context_menu"),l=e("../../_mixins/tracking"),c=e("../Badge"),p=e("../Thumbnail"),d=e("../Favorite"),u=s.createClass({displayName:"Playlist",propTypes:{data:s.PropTypes.object,display_favorite:s.PropTypes.bool,display_creator:s.PropTypes.bool,display_add:s.PropTypes.bool,display_fan:s.PropTypes.bool,display_track:s.PropTypes.bool,context:s.PropTypes.string,index:s.PropTypes.number,onClick:s.PropTypes.func},contextTypes:{panel_name:s.PropTypes.string},mixins:[l],getDefaultProps:function(){return{display_favorite:!0,display_creator:!0,display_add:!0,display_track:!0,display_fan:!1,context:""}},shouldComponentUpdate:function(e){return e.data.PLAYLIST_ID!==this.props.data.PLAYLIST_ID||e.data.NB_SONG!==this.props.data.NB_SONG||e.data.UNSEEN_TRACK_COUNT!==this.props.data.UNSEEN_TRACK_COUNT},getTrackingParams:function(){return{type:"playlist",id:this.props.data.PLAYLIST_ID}},render:function(){return s.createElement("li",{key:"playlist"+this.props.data.PLAYLIST_ID,className:"nano-card-item",onClick:this._onSelect,"data-index":this.props.index},s.createElement("div",{className:"nano-card-picture"},s.createElement(p,{id:Number(this.props.data.PLAYLIST_ID),type:"playlist",md5:this.props.data.PLAYLIST_PICTURE,picture_type:this.props.data.PICTURE_TYPE,height:56,width:56,play:!0,preview:!0,play_link:!1,cover_play:!0,context:this.props.context,overlay:!1})),s.createElement("div",{className:"nano-card-options"},this._renderAdd(),this._renderFavorite()),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement(c,{counter:this.props.data.UNSEEN_TRACK_COUNT}),s.createElement("a",{href:"/playlist/"+this.props.data.PLAYLIST_ID,"data-instance":"playlist_name"},this.props.data.TITLE)),this._renderInfo()))},_renderFavorite:function(){return this.props.display_favorite?s.createElement(d,{type:"playlist",id:this.props.data.PLAYLIST_ID,context:this.context.panel_name}):void 0},_renderAdd:function(){return this.props.display_add?s.createElement("a",{className:"option-hide",onClick:this._onAdd},s.createElement("span",{className:"icon icon-options"})):void 0},_renderInfo:function(){var e=Number(this.props.data.PARENT_USER_ID),t=e!==USER.USER_ID&&this.props.display_creator,a=this.props.display_fan&&this.props.data.NB_FAN>0,r=this.props.display_track,o=[];return t&&o.push(""),r&&o.push(window.breakUpThousands(this.props.data.NB_SONG)+" "+n("titre","titres",{count:this.props.data.NB_SONG})),a&&o.push(window.breakUpThousands(this.props.data.NB_FAN)+" "+n("fan","fans",{count:this.props.data.NB_FAN})),s.createElement("div",{className:"heading-4-sub ellipsis"},t?i("par")+" ":"",t?s.createElement("a",{href:"/profile/"+e,"data-instance":"user_name"},this.props.data.PARENT_USERNAME):"",o.join(" - "))},_onSelect:function(e){e.preventDefault(),this.tracking("panel_click",e.currentTarget),"function"==typeof this.props.onClick&&this.props.onClick(e,this.props.data,this.props.index);var t=e.target.getAttribute("href");null===t&&(t="/playlist/"+this.props.data.PLAYLIST_ID);var a=dom.dataset(e.target,"instance");"undefined"!=typeof a&&dom.dataset(e.currentTarget,"instance",a),loadBox(t)},_onAdd:function(e){e.preventDefault(),e.stopPropagation(),o.open({target:e.currentTarget,id:this.props.data.PLAYLIST_ID,type:"playlist",data:this.props.data,position:"right",context:this.context.panel_name,listen_context:{TYPE:this.props.context,ID:this.props.data.PLAYLIST_ID}})}});t.exports=u},{"../../../core/context_menu":242,"../../../core/i18n":245,"../../_mixins/tracking":45,"../Badge":57,"../Favorite":119,"../Thumbnail":130,react:"react"}],57:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("react-addons-pure-render-mixin"),n=s.createClass({displayName:"Badge",propTypes:{counter:s.PropTypes.number,type:s.PropTypes.oneOf(["danger","info"])},mixins:[i],getDefaultProps:function(){return{counter:0,type:"info"}},render:function(){if(0===this.props.counter)return!1;var e={badge:!0};e["badge-"+this.props.type]=!0;var t=r(e);return s.createElement("span",{className:t},this.props.counter<100?this.props.counter:"99+")}});t.exports=n},{classnames:"classnames",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],144:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.ngettext,n=e("../../../core/context_menu"),o=e("../../_mixins/tracking"),l=e("../Thumbnail"),c=e("../Favorite"),p=s.createClass({displayName:"Artist",propTypes:{data:s.PropTypes.object,display_favorite:s.PropTypes.bool,display_add:s.PropTypes.bool,context:s.PropTypes.string,index:s.PropTypes.number,thumbnail_rounded:s.PropTypes.bool,onClick:s.PropTypes.func},contextTypes:{panel_name:s.PropTypes.string},mixins:[o],getDefaultProps:function(){return{display_favorite:!0,index:null,thumbnail_rounded:!1}},shouldComponentUpdate:function(e){return e.data.ART_ID!==this.props.data.ART_ID||e.data.NB_FAN!==this.props.data.NB_FAN},getTrackingParams:function(){return{type:"artist",id:this.props.data.ART_ID,index:this.props.index}},render:function(){var e=breakUpThousands(this.props.data.NB_FAN)+" "+i("fan","fans",{count:this.props.data.NB_FAN});return s.createElement("li",{key:"artist"+this.props.data.ART_ID,className:"nano-card-item",onClick:this._onSelect},s.createElement("div",{className:"nano-card-picture"},s.createElement(l,{type:"artist",md5:this.props.data.ART_PICTURE,height:56,width:56,rounded:this.props.thumbnail_rounded,play_link:!0,id:Number(this.props.data.ART_ID),overlay:!1})),s.createElement("div",{className:"nano-card-options"},this._renderAdd(),this._renderFavorite()),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/artist/"+this.props.data.ART_ID},this.props.data.ART_NAME)),s.createElement("div",{className:"heading-4-sub ellipsis"},e)))},_renderFavorite:function(){return this.props.display_favorite?s.createElement(c,{type:"artist",id:this.props.data.ART_ID,context:this.context.panel_name}):void 0},_renderAdd:function(){return this.props.display_add?s.createElement("a",{className:"option-hide",onClick:this._onAdd},s.createElement("span",{className:"icon icon-options"})):void 0},_onSelect:function(e){e.preventDefault(),this.tracking("panel_click",e.currentTarget),"function"==typeof this.props.onClick&&this.props.onClick(e,this.props.data,this.props.index),loadBox("/artist/"+this.props.data.ART_ID)},_onAdd:function(e){e.preventDefault(),e.stopPropagation(),n.open({target:e.currentTarget,id:this.props.data.ART_ID,type:"artist",data:this.props.data,position:"right",context:this.context.panel_name,listen_context:{TYPE:this.props.context,ID:this.props.data.ART_ID}})}});t.exports=p},{"../../../core/context_menu":242,"../../../core/i18n":245,"../../_mixins/tracking":45,"../Favorite":119,"../Thumbnail":130,react:"react"}],142:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../core/i18n"),i=r.gettext,n=e("../../../core/context_menu"),o=e("../../_mixins/tracking"),l=e("../Thumbnail"),c=e("../Favorite"),p=s.createClass({displayName:"Album",propTypes:{data:s.PropTypes.object,display_favorite:s.PropTypes.bool,display_add:s.PropTypes.bool,context:s.PropTypes.string,index:s.PropTypes.number,onClick:s.PropTypes.func},contextTypes:{panel_name:s.PropTypes.string},mixins:[o],getDefaultProps:function(){return{display_favorite:!0,display_add:!1,context:"",index:null}},shouldComponentUpdate:function(e){return e.data.ALB_ID!==this.props.data.ALB_ID},getTrackingParams:function(){return{type:"album",id:this.props.data.ALB_ID}},render:function(){return s.createElement("li",{key:"album"+this.props.data.ALB_ID,className:"nano-card-item",onClick:this._onSelect,"data-index":this.props.index},s.createElement("div",{className:"nano-card-picture"},s.createElement(l,{id:Number(this.props.data.ALB_ID),type:"album",md5:this.props.data.ALB_PICTURE,height:56,width:56,play:!0,preview:!0,play_link:!0,context:this.props.context,overlay:!1})),s.createElement("div",{className:"nano-card-options"},this._renderAdd(),this._renderFavorite()),s.createElement("div",{className:"nano-card-infos"},s.createElement("div",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/album/"+this.props.data.ALB_ID,"data-instance":"album_name"},this.props.data.ALB_TITLE)),s.createElement("div",{className:"heading-4-sub ellipsis"},i("par")," ",this._renderArtistName())))},_renderArtistName:function(){return this.props.data.ARTISTS?this.props.data.ARTISTS.map(function(e,t){return 0===Number(e.ROLE_ID)||5===Number(e.ROLE_ID)?[t>0?", ":"",s.createElement("a",{href:"/artist/"+e.ART_ID,"data-instance":"artist_name"},e.ART_NAME)]:void 0}):s.createElement("a",{href:"/artist/"+this.props.data.ART_ID,"data-instance":"artist_name"},this.props.data.ART_NAME)},_renderFavorite:function(){return this.props.display_favorite?s.createElement(c,{type:"album",id:this.props.data.ALB_ID,context:this.context.panel_name}):void 0},_renderAdd:function(){return this.props.display_add?s.createElement("a",{className:"option-hide",onClick:this._onAdd},s.createElement("span",{className:"icon icon-options"})):void 0},_onSelect:function(e){e.preventDefault(),this.tracking("panel_click",e.currentTarget),"function"==typeof this.props.onClick&&this.props.onClick(e,this.props.data,this.props.index);var t=e.target.getAttribute("href");null===t&&(t="/album/"+this.props.data.ALB_ID);var a=dom.dataset(e.target,"instance");"undefined"!=typeof a&&dom.dataset(e.currentTarget,"instance",a),loadBox(t)},_onAdd:function(e){e.preventDefault(),e.stopPropagation(),n.open({target:e.currentTarget,id:this.props.data.ALB_ID,type:"album",data:this.props.data,position:"right",context:this.context.panel_name,listen_context:{TYPE:this.props.context,ID:this.props.data.ALB_ID}})}});t.exports=p},{"../../../core/context_menu":242,"../../../core/i18n":245,"../../_mixins/tracking":45,"../Favorite":119,"../Thumbnail":130,react:"react"}],114:[function(e,t,a){"use strict";t.exports=e("./Discography")},{"./Discography":111}],111:[function(e,t,a){"use strict";var s=e("react"),r=e("./_elements/Album"),i=e("@deezer/components/common/grid/Grid"),n=e("./_elements/Sorter"),o=e("@deezer/components/_mixins/sort"),l=e("@deezer/components/_mixins/tracking"),c=e("classnames"),p=e("../../../core/i18n"),d=p.gettext,u=s.createClass({displayName:"Discography",propTypes:{data:s.PropTypes.array.isRequired,onSort:s.PropTypes.func,limitSong:s.PropTypes.number,total:s.PropTypes.number,heading:s.PropTypes.bool,sorter:s.PropTypes.bool,sortBy:s.PropTypes.string,producerLine:s.PropTypes.bool,addFavorite:s.PropTypes.bool,format:s.PropTypes.oneOf(["big","small"]),tracking:s.PropTypes.bool,context:s.PropTypes.string},mixins:[o,l],getDefaultProps:function(){return{onSort:function(){},limitSong:10,total:0,heading:!0,sorter:!0,sortBy:"type",format:"big",tracking:!1}},getInitialState:function(){return{format:this.props.format,sortBy:this.props.sortBy}},render:function(){if(!this.props.data.length)return this._renderPlaceholder();var e=this.props.data;return this._isAllDataLoaded()&&(e=this.sort(this.props.data,this._getSortKey())),"big"===this.state.format?this._renderDiscographyBig(e):this._renderDiscographySmall(e)},_renderDiscographyBig:function(e){var t,a="";return s.createElement("div",{className:"catalog-tab-discography"},e.map(function(e,i){var n=[];return t=0===Number(e.ROLE_ID)?e.TYPE:4,t!==a&&"type"===this.state.sortBy?(a=t,n.push(this._renderHeading(i,t))):0===i&&n.push(this._renderHeading(0)),n.push(s.createElement(r,{key:e.ALB_ID+"_"+i,id:Number(e.ALB_ID),data:e,songs:e.SONGS.data.slice(0,this.props.limitSong||e.SONGS.total),limit:this.props.limitSong,total:e.SONGS.total,index:i,tracking:this.props.tracking,context:this.props.context,producerLine:this.props.producerLine,addFavorite:this.props.addFavorite})),n}.bind(this)))},_renderDiscographySmall:function(e){var t=["name","artist","release_date","favorite","play_link"];if("type"===this.state.sortBy){var a="",r="",n={0:[],1:[],2:[],3:[],4:[]};return s.createElement("div",{className:"catalog-tab-discography"},e.map(function(e,o){return r=0===Number(e.ROLE_ID)?e.TYPE:4,r!==a?(a=r,n[r].push(e),[this._renderHeading(o,r),s.createElement(i,{key:"grid_"+r,data:n[r],options:t,context:"artist_discography",tracking:this.props.tracking})]):void n[r].push(e)}.bind(this)))}return s.createElement("div",{className:"catalog-tab-discography"},this._renderHeading(0),s.createElement(i,{data:e,options:t,context:"artist_discography",tracking:this.props.tracking}))},_renderHeading:function(e,t){return this.props.heading?s.createElement("div",{className:"heading"},s.createElement("div",{className:"cell cell-title"},s.createElement("h4",{className:"heading-3"},this._getTypeName(t))),s.createElement("div",{className:"cell cell-line"},s.createElement("div",{className:"line"})),this._renderSorter(e),this._renderSwitch(e)):void 0},_renderSorter:function(e){return e>0?null:this.props.sorter===!1?null:s.createElement("div",{className:"cell cell-sort"},s.createElement(n,{onSort:this._onSort,sortType:this.state.sortBy}))},_renderSwitch:function(e){if(e>0)return null;var t=c({"btn btn-default":!0,active:"big"===this.state.format}),a=c({"btn btn-default":!0,active:"small"===this.state.format});return s.createElement("div",{className:"cell cell-view"},s.createElement("span",{className:"btn-group"},s.createElement("button",{className:a,type:"button","data-view":"thumbnail",onClick:this._switchFormat.bind(this,"small")},s.createElement("span",{className:"icon icon-mosaic"})),s.createElement("button",{className:t,type:"button","data-view":"card",onClick:this._switchFormat.bind(this,"big")},s.createElement("span",{className:"icon icon-list"}))))},_renderPlaceholder:function(){return s.createElement("div",{className:"placeholder-container"},s.createElement("div",{className:"placeholders-img nocontent"}),s.createElement("div",{className:"placeholders-title"},d("Aucun album n'est actuellement disponible.")))},_onSort:function(e,t){this._isAllDataLoaded()||this.props.onSort(e),this.setState({sortBy:e}),this.props.tracking&&this.tracking("discography_click",t.currentTarget)},_isAllDataLoaded:function(){return this.props.total===this.props.data.length},_getSortKey:function(){var e={type:"ALB_TYPE",name:"ALB_TITLE",release:"RELEASE_DATE",top:"ALB_RANK"};return e[this.state.sortBy]},_getTypeName:function(e){var t=[d("Singles"),d("Albums"),d("Splits"),d("EPs"),d("Apparaît dans")],a=Number(e);return t[a]?t[a]:d("Discographie")},_switchFormat:function(e,t){this.setState({format:e}),this.props.tracking&&this.tracking("discography_click",t.currentTarget)}});t.exports=u},{"../../../core/i18n":245,"./_elements/Album":112,"./_elements/Sorter":113,"@deezer/components/_mixins/sort":43,"@deezer/components/_mixins/tracking":45,"@deezer/components/common/grid/Grid":134,classnames:"classnames",react:"react"}],134:[function(e,t,a){"use strict";var s=e("babel-runtime/helpers/extends")["default"],r=e("react"),i=e("./_elements/Artist"),n=e("./_elements/Album"),o=e("./_elements/Playlist"),l=e("./_elements/Radio"),c=e("./_elements/Show"),p=e("./_elements/User"),d=e("./_elements/Song"),u=e("../../../core/i18n"),h=u.gettext,m=r.createClass({displayName:"Grid",propTypes:{data:r.PropTypes.array.isRequired,type:r.PropTypes.string,context:r.PropTypes.string,tab:r.PropTypes.string,options:r.PropTypes.array,tracking:r.PropTypes.bool,highlight:r.PropTypes.oneOfType([r.PropTypes.oneOf([!1]),r.PropTypes.number])},getDefaultProps:function(){return{data:[],type:"unknown",context:"",page:"",options:[],tracking:!1,highlight:!1}},render:function(){return this.props.data.length?r.createElement("ul",{className:"thumbnail-grid"},this.props.data.map(function(e,t){var a="unknown"===this.props.type?e.__TYPE__:this.props.type,u={data:e,options:this.props.options,context:this.props.context,index:t,tracking:this.props.tracking,highlight:this.props.highlight!==!1&&this.props.highlight===t?!0:!1};switch(a){case"artist":return r.createElement(i,s({key:e.ART_ID+"-"+t},u));case"album":return r.createElement(n,s({key:e.ALB_ID+"-"+t},u));case"playlist":return r.createElement(o,s({key:e.PLAYLIST_ID+"-"+t},u));case"radio":return r.createElement(l,s({key:e.RADIO_ID+"-"+t},u));case"show":return r.createElement(c,s({key:e.SHOW_ID+"-"+t},u));case"user":return r.createElement(p,s({key:e.USER_ID+"-"+t},u));case"song":return r.createElement(d,s({key:e.SNG_ID+"-"+t},u,{track_list:this.props.data,track_index:t}));default:return null}}.bind(this))):this._renderPlaceholder()},_renderPlaceholder:function(){var e="nocontent",t=h("Aucun résultat.");return"related_artists"===this.props.tab&&(e="recommendation",t=h("Aucun artiste similaire n'est disponible")),"related_playlists"===this.props.tab&&(e="recommendation",t=h("Aucune playlist n'est disponible.")),"fan_tab"===this.props.tab&&(e="recommendation",t=h("Aucun fan actuellement")),"explore_page"===this.props.context&&(t=h("Nous n'avons pas trouvé de musique pour ce genre. Essayez d'en sélectionner un autre.")),r.createElement("div",null,r.createElement("div",{className:"placeholders-img "+e}),r.createElement("div",{className:"placeholders-title"},t))}});t.exports=m},{"../../../core/i18n":245,"./_elements/Album":135,"./_elements/Artist":136,"./_elements/Playlist":137,"./_elements/Radio":138,"./_elements/Show":139,"./_elements/Song":140,"./_elements/User":141,"babel-runtime/helpers/extends":294,react:"react"}],141:[function(e,t,a){"use strict";var s=e("react"),r=e("../../Thumbnail"),i=e("../../StatesButton"),n=s.createClass({displayName:"User",propTypes:{data:s.PropTypes.object.isRequired,context:s.PropTypes.string.isRequired,options:s.PropTypes.array},getDefaultProps:function(){return{data:null,context:"artist_page",options:[]}},render:function(){return s.createElement("li",{key:"user_"+this.props.data.USER_ID,"data-search":this._getRewritingName(this.props.data.BLOG_NAME)},s.createElement("div",{className:"thumbnail-col"},s.createElement("div",{className:"thumbnail-wrapper"},s.createElement(r,{id:Number(this.props.data.USER_ID),type:this.props.data.__TYPE__,width:250,height:250,picture_type:"user",context:this.props.context,md5:this.props.data.USER_PICTURE})),this.props.options.length>0?this._renderCaption():null))},_renderCaption:function(){return s.createElement("article",{className:"thumbnail-caption"},this.props.options.indexOf("name")>-1?this._renderName():null,this.props.options.indexOf("follow")>-1?this._renderFollow():null);},_renderName:function(){return s.createElement("h4",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/profile/"+this.props.data.USER_ID,className:"evt-click",title:this.props.data.BLOG_NAME},this.props.data.BLOG_NAME))},_renderFollow:function(){return s.createElement("p",{className:"thumbnail-button"},s.createElement(i,{id:Number(this.props.data.USER_ID),disabled:Number(this.props.data.USER_ID)===window.USER.USER_ID,type:"friend",size:"block",wording_type:"full"}))},_getRewritingName:function(e){return window.rewriting(e).toLowerCase()}});t.exports=n},{"../../StatesButton":127,"../../Thumbnail":130,react:"react"}],140:[function(e,t,a){"use strict";var s=e("react"),r=e("../../Thumbnail"),i=e("../../StatesButton"),n=e("../../../../core/i18n"),o=n.gettext,l=s.createClass({displayName:"Song",propTypes:{data:s.PropTypes.object.isRequired,context:s.PropTypes.string.isRequired,options:s.PropTypes.array,track_list:s.PropTypes.array,track_index:s.PropTypes.number},getDefaultProps:function(){return{data:null,track_list:[],track_index:0,context:"track_page",options:[]}},render:function(){return s.createElement("li",{key:"track_"+this.props.data.SNG_ID,"data-search":this._getRewritingName(this.props.data.SONG_TITLE)},s.createElement("div",{className:"thumbnail-col"},s.createElement("div",{className:"thumbnail-wrapper"},s.createElement(r,{id:Number(this.props.data.SNG_ID),type:"track",width:250,height:250,picture_type:"cover",play:!0,play_data:this.props.track_list,play_index:this.props.track_index,preview:!0,play_link:this.props.options.indexOf("play_link")>-1,context:this.props.context,md5:this.props.data.ALB_PICTURE,sticker:this.props.options.indexOf("sticker")>-1,release_date:this.props.data.PHYSICAL_RELEASE_DATE,context_menu:this.props.data})),this._renderCaption()))},_renderCaption:function(){return this.props.options.length>0?s.createElement("article",{className:"thumbnail-caption"},this._renderType(),this._renderName(),this._renderArtist(),this._renderReleaseDate(),this._renderFavorite()):void 0},_renderType:function(){return this.props.options.indexOf("type")>-1?s.createElement("h4",{className:"sticker sticker-gray sticker-small"},s.createElement("span",null,this.props.data.ALB_TYPE)):void 0},_renderName:function(){return this.props.options.indexOf("name")>-1?s.createElement("h4",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/album/"+this.props.data.ALB_ID,className:"evt-click",title:this.props.data.ALB_TITLE},this.props.data.SNG_TITLE)):void 0},_renderArtist:function(){return this.props.options.indexOf("artist")>-1&&this.props.data.ART_NAME?s.createElement("h5",{className:"heading-4-sub ellipsis"},s.createElement("span",{key:"artistLabel"},o("par")+" "),s.createElement("a",{key:"artistLink",href:"/artist/"+this.props.data.ART_ID,className:"evt-click",title:this.props.data.ART_NAME},this.props.data.ART_NAME)):void 0},_renderFavorite:function(){return this.props.options.indexOf("favorite")>-1?s.createElement("p",{className:"thumbnail-button"},s.createElement(i,{id:Number(this.props.data.ALB_ID),type:"track",size:"block"})):void 0},_renderReleaseDate:function(){return this.props.options.indexOf("release_date")>-1?s.createElement("h5",{className:"heading-5 release"},o("Sorti le")," ",formatDate(this.props.data.PHYSICAL_RELEASE_DATE)):void 0},_getRewritingName:function(e){return window.rewriting(e).toLowerCase()}});t.exports=l},{"../../../../core/i18n":245,"../../StatesButton":127,"../../Thumbnail":130,react:"react"}],139:[function(e,t,a){"use strict";var s=e("react"),r=e("../../Thumbnail"),i=e("../../StatesButton"),n=s.createClass({displayName:"Show",propTypes:{data:s.PropTypes.object.isRequired,context:s.PropTypes.string.isRequired,options:s.PropTypes.array},getDefaultProps:function(){return{data:null,context:"show_page",options:[]}},render:function(){return s.createElement("li",{"data-search":this._getRewritingName(this.props.data.SHOW_NAME)},s.createElement("div",{className:"thumbnail-col"},s.createElement("div",{className:"thumbnail-wrapper"},s.createElement(r,{id:Number(this.props.data.SHOW_ID),type:"show",picture_type:"talk",width:250,height:250,play:!0,play_link:this.props.options.indexOf("play_link")>-1,context:this.props.context,md5:this.props.data.SHOW_ART_MD5,context_menu:this.props.data})),this._renderCaption()))},_renderCaption:function(){return this.props.options.length>0?s.createElement("article",{className:"thumbnail-caption"},this._renderTitle(),this._renderName(),this._renderFavorite()):void 0},_renderTitle:function(){return this.props.options.indexOf("title")>-1?s.createElement("h4",{className:"heading-4"},this.props.data.TITLE):void 0},_renderName:function(){return this.props.options.indexOf("name")>-1?s.createElement("h5",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/show/"+this.props.data.SHOW_ID,className:"evt-click",title:this.props.data.SHOW_NAME},this.props.data.SHOW_NAME)):void 0},_renderFavorite:function(){return this.props.options.indexOf("favorite")>-1?s.createElement("p",{className:"thumbnail-button"},s.createElement(i,{id:Number(this.props.data.SHOW_ID),type:"show",size:"block"})):void 0},_getRewritingName:function(e){return window.rewriting(e).toLowerCase()}});t.exports=n},{"../../StatesButton":127,"../../Thumbnail":130,react:"react"}],138:[function(e,t,a){"use strict";var s=e("react"),r=e("../../Thumbnail"),i=s.createClass({displayName:"Radio",propTypes:{data:s.PropTypes.object.isRequired,context:s.PropTypes.string.isRequired,options:s.PropTypes.array},getDefautProps:function(){return{data:null,context:"",options:[]}},render:function(){return s.createElement("li",null,s.createElement("div",{className:"thumbnail-col"},s.createElement("div",{className:"thumbnail-wrapper"},s.createElement(r,{id:Number(this.props.data.RADIO_ID),md5:this.props.data.RADIO_PICTURE,type:"radio",width:250,height:250,play:!0,cover_link:!1,overlay_force:!0,radio:!0,title:this.props.data.TITLE,context_menu:this.props.data,context:this.props.context}))),this._renderCaption())},_renderCaption:function(){return this.props.options.length>0?s.createElement("article",{className:"thumbnail-caption"},this._renderName()):void 0},_renderName:function(){return this.props.options.indexOf("name")>-1?s.createElement("h4",{className:"heading-4"},this.props.data.TITLE):void 0}});t.exports=i},{"../../Thumbnail":130,react:"react"}],137:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../Thumbnail"),n=e("../../StatesButton"),o=e("../../../../core/i18n"),l=o.gettext,c=o.ngettext,p=s.createClass({displayName:"Playlist",propTypes:{data:s.PropTypes.object.isRequired,context:s.PropTypes.string.isRequired,options:s.PropTypes.array,highlight:s.PropTypes.bool},getDefaultProps:function(){return{data:null,context:"playlist_page",options:[],highlight:!1}},render:function(){var e=r({"thumbnail-highlight":this.props.highlight});return s.createElement("li",{key:"playlist_"+this.props.data.PLAYLIST_ID,"data-type":this._getPlaylistType(),className:e},s.createElement("div",{className:"thumbnail-col"},s.createElement("div",{className:"thumbnail-wrapper"},s.createElement(i,{id:Number(this.props.data.PLAYLIST_ID),type:"playlist",width:250,height:250,picture_type:this.props.data.PICTURE_TYPE,play:!0,play_link:this.props.options.indexOf("play_link")>-1,preview:!0,context:this.props.context,md5:this.props.data.PLAYLIST_PICTURE,private_status:Number(this.props.data.STATUS),multi_cover:!0,context_menu:this.props.data,duplicate_picture:this.props.highlight})),this._renderCaption()))},_renderCaption:function(){return this.props.options.length>0?s.createElement("article",{className:"thumbnail-caption"},this._renderName(),this._renderCreator(),this._renderNumber(),this._renderStatus(),this._renderFavorite()):void 0},_renderName:function(){return this.props.options.indexOf("name")>-1?s.createElement("h4",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/playlist/"+this.props.data.PLAYLIST_ID,className:"evt-click",title:this.props.data.TITLE},this._renderIcon()," "+this.props.data.TITLE)):void 0},_renderIcon:function(){return userData.isFavorite("playlist",this.props.data.PLAYLIST_ID)&&userData.getUnseenTrackCount(this.props.data.PLAYLIST_ID)>0?s.createElement("span",{className:"badge badge-info"},userData.getUnseenTrackCount(this.props.data.PLAYLIST_ID)):s.createElement("span",{className:"icon icon-"+this._getPlaylistType()})},_renderCreator:function(){return this.props.options.indexOf("creator")>-1?s.createElement("h5",{className:"heading-4-sub ellipsis"},l("par")+" ",s.createElement("a",{href:"/profile/"+this.props.data.PARENT_USER_ID,className:"evt-click",title:this.props.data.PARENT_USERNAME},this.props.data.PARENT_USERNAME)):void 0},_renderNumber:function(){var e=this.props.options.indexOf("fans")>-1&&this.props.data.NB_FAN>0,t=this.props.options.indexOf("tracks")>-1;return e||t?s.createElement("h5",{className:"heading-5-sub ellipsis"},t?window.breakUpThousands(this.props.data.NB_SONG)+" "+c("titre","titres",{count:this.props.data.NB_SONG}):"",t&&e?" - ":"",e?window.breakUpThousands(this.props.data.NB_FAN)+" "+c("fan","fans",{count:this.props.data.NB_FAN}):""):void 0},_renderFavorite:function(){return this.props.options.indexOf("favorite")>-1?s.createElement("p",{className:"thumbnail-button"},s.createElement(n,{id:Number(this.props.data.PLAYLIST_ID),type:"playlist",size:"block"})):void 0},_renderStatus:function(){if(this.props.options.indexOf("status")>-1){var e=[];return(0===this.props.data.STATUS||2===this.props.data.STATUS)&&e.push(l("Publique")),(1===this.props.data.STATUS||3===this.props.data.STATUS)&&e.push(l("Privée")),(2===this.props.data.STATUS||3===this.props.data.STATUS)&&e.push(l("Collaborative")),s.createElement("h5",{className:"heading-4-sub ellipsis"},e.join(" · ")||" ")}},_getPlaylistType:function(){return Number(this.props.data.PARENT_USER_ID)===window.profile.id?"playlist":2===this.props.data.STATUS?"playlist-collaborative":"playlist-favorite"}});t.exports=p},{"../../../../core/i18n":245,"../../StatesButton":127,"../../Thumbnail":130,classnames:"classnames",react:"react"}],136:[function(e,t,a){"use strict";var s=e("react"),r=e("../../Thumbnail"),i=e("../../StatesButton"),n=e("../../../../core/i18n"),o=n.ngettext,l=s.createClass({displayName:"Artist",propTypes:{data:s.PropTypes.object.isRequired,context:s.PropTypes.string.isRequired,options:s.PropTypes.array},getDefaultProps:function(){return{data:null,context:"artist_page",options:[]}},render:function(){return s.createElement("li",{key:"artist_"+this.props.data.ART_ID,"data-search":this._getRewritingName(this.props.data.ART_NAME)},s.createElement("div",{className:"thumbnail-col"},s.createElement("div",{className:"thumbnail-wrapper"},s.createElement(r,{id:Number(this.props.data.ART_ID),smartradio:this.props.data.SMARTRADIO,type:"artist",width:250,height:250,picture_type:"artist",context:this.props.context,md5:this.props.data.ART_PICTURE,context_menu:this.props.data})),this._renderCaption()))},_renderCaption:function(){return this.props.options.length>0?s.createElement("article",{className:"thumbnail-caption"},this._renderName(),this._renderFans(),this._renderFavorite()):void 0},_renderName:function(){return this.props.options.indexOf("name")>-1?s.createElement("h4",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/artist/"+this.props.data.ART_ID,className:"evt-click",title:this.props.data.ART_NAME},this.props.data.ART_NAME)):void 0},_renderFans:function(){return this.props.options.indexOf("fans")>-1?s.createElement("h5",{className:"heading-4-sub ellipsis"},this.props.data.NB_FAN?window.breakUpThousands(this.props.data.NB_FAN)+" "+o("fan","fans",{count:this.props.data.NB_FAN}):" "):void 0},_renderFavorite:function(){return this.props.options.indexOf("favorite")>-1?s.createElement("p",{className:"thumbnail-button"},s.createElement(i,{id:Number(this.props.data.ART_ID),type:"artist",size:"block"})):void 0},_getRewritingName:function(e){return window.rewriting(e).toLowerCase()}});t.exports=l},{"../../../../core/i18n":245,"../../StatesButton":127,"../../Thumbnail":130,react:"react"}],135:[function(e,t,a){"use strict";var s=e("react"),r=e("@deezer/components/_mixins/tracking"),i=e("@deezer/components/common/Thumbnail"),n=e("@deezer/components/common/StatesButton"),o=e("../../../../core/i18n"),l=o.gettext,c=s.createClass({displayName:"Album",propTypes:{data:s.PropTypes.object.isRequired,context:s.PropTypes.string.isRequired,index:s.PropTypes.number,options:s.PropTypes.array,tracking:s.PropTypes.bool},mixins:[r],getDefaultProps:function(){return{data:null,context:"album_page",index:0,options:[],tracking:!1}},getTrackingParams:function(){return{type:"thumbnail"}},render:function(){return s.createElement("li",{key:"album_"+this.props.data.ALB_ID,"data-search":this._getRewritingName(this.props.data.ART_NAME)+" "+this._getRewritingName(this.props.data.ALB_TITLE)},s.createElement("div",{className:"thumbnail-col"},s.createElement("div",{className:"thumbnail-wrapper"},s.createElement(i,{id:Number(this.props.data.ALB_ID),type:"album",width:250,height:250,picture_type:"cover",play:!0,preview:!0,play_link:this.props.options.indexOf("play_link")>-1,context:this.props.context,md5:this.props.data.ALB_PICTURE,sticker:this.props.options.indexOf("sticker")>-1,release_date:this.props.data.PHYSICAL_RELEASE_DATE,context_menu:this.props.data})),this._renderCaption()))},_renderCaption:function(){return this.props.options.length>0?s.createElement("article",{className:"thumbnail-caption"},this._renderType(),this._renderName(),this._renderArtist(),this._renderReleaseDate(),this._renderFavorite()):void 0},_renderType:function(){return this.props.options.indexOf("type")>-1?s.createElement("h4",{className:"sticker sticker-gray sticker-small"},s.createElement("span",null,this.props.data.ALB_TYPE)):void 0},_renderName:function(){return this.props.options.indexOf("name")>-1?s.createElement("h4",{className:"heading-4 ellipsis"},s.createElement("a",{href:"/album/"+this.props.data.ALB_ID,"data-position":this.props.index,onClick:this._onLink,title:this.props.data.ALB_TITLE},this.props.data.ALB_TITLE)):void 0},_renderArtist:function(){if(this.props.options.indexOf("artist")>-1&&this.props.data.ART_NAME){var e=[];return this.props.data.ARTISTS?this.props.data.ARTISTS.map(function(t,a){(0===Number(t.ROLE_ID)||5===Number(t.ROLE_ID))&&e.push(a>0?", ":"",s.createElement("a",{key:"artist_"+a,href:"/artist/"+t.ART_ID,onClick:this._onLink,title:t.ART_NAME},t.ART_NAME))}.bind(this)):e.push(s.createElement("a",{key:"artistLink",href:"/artist/"+this.props.data.ART_ID,onClick:this._onLink,title:this.props.data.ART_NAME},this.props.data.ART_NAME)),s.createElement("h5",{className:"heading-4-sub ellipsis"},s.createElement("span",{key:"artistLabel"},l("par")+" "),e)}},_renderFavorite:function(){return this.props.options.indexOf("favorite")>-1?s.createElement("p",{className:"thumbnail-button"},s.createElement(n,{id:Number(this.props.data.ALB_ID),type:"album",size:"block"})):void 0},_renderReleaseDate:function(){return this.props.options.indexOf("release_date")>-1?s.createElement("h5",{className:"heading-5 release"},l("Sorti le")," ",formatDate(this.props.data.PHYSICAL_RELEASE_DATE)):void 0},_onLink:function(e){e.preventDefault(),www.navigate(e.currentTarget.getAttribute("href")),this.props.tracking&&this.tracking("discography_click",e.currentTarget)},_getRewritingName:function(e){return window.rewriting(e).toLowerCase()}});t.exports=c},{"../../../../core/i18n":245,"@deezer/components/_mixins/tracking":45,"@deezer/components/common/StatesButton":127,"@deezer/components/common/Thumbnail":130,react:"react"}],113:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=e("../../../../core/i18n"),n=e("@deezer/components/common/DropDown"),o=s.createClass({displayName:"Sorter",propTypes:{onSort:s.PropTypes.func.isRequired,sortType:s.PropTypes.string},mixins:[r],render:function(){var e=this._items.map(function(e,t){return s.createElement(n.Item,{key:t,label:e.label},s.createElement("a",{onClick:this._onSort.bind(this,e.type),href:"#","data-sort":e.type},e.label))}.bind(this));return s.createElement(n,{selected:this._getSelected()},e)},_onSort:function(e,t){t.preventDefault(),this.props.onSort(e,t)},_items:[{label:i.gettext("Type"),type:"type"},{label:i.gettext("A - Z"),type:"name"},{label:i.gettext("Date de sortie"),type:"release"},{label:i.gettext("Les plus écoutés"),type:"top"}],_default:0,_getSelected:function(){if("function"==typeof this._items.findIndex){var e=this._items.findIndex(this._predicate,this);return-1===e?this._default:e}for(var t=0,a=this._items.length;a>t;t++)if(this._predicate(this._items[t]))return t;return this._default},_predicate:function(e){return this.props.sortType===e.type}});t.exports=o},{"../../../../core/i18n":245,"@deezer/components/common/DropDown":118,react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],112:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../core/i18n"),i=e("@deezer/components/_mixins/tracking"),n=e("@deezer/components/common/Thumbnail"),o=e("@deezer/components/common/StatesButton"),l=e("@deezer/components/common/DataGrid"),c=s.createClass({displayName:"Album",propTypes:{id:s.PropTypes.number.isRequired,data:s.PropTypes.object.isRequired,songs:s.PropTypes.array.isRequired,producerLine:s.PropTypes.bool,addFavorite:s.PropTypes.bool,limit:s.PropTypes.number,total:s.PropTypes.number,index:s.PropTypes.number,tracking:s.PropTypes.bool,context:s.PropTypes.string},childContextTypes:{id:s.PropTypes.number,name:s.PropTypes.string.isRequired},mixins:[i],getDefaultProps:function(){return{limit:10,total:0,index:0,tracking:!1,context:"card",producerLine:!0,addFavorite:!0}},getChildContext:function(){return{id:this.props.id,name:"artist_discography"}},getTrackingParams:function(){return{type:this.props.context}},render:function(){return s.createElement("div",{className:"catalog-tab-box album-row"},s.createElement("div",{className:"album-thumbnail"},this._renderThumbnail(),this._renderProducerLine()),s.createElement("div",{className:"album-infos"},this._renderTitle(),this._renderReleaseDate(),this._renderDatagrid(),this._renderViewMore()))},_renderThumbnail:function(){return s.createElement("div",{className:"thumbnail-container"},s.createElement(n,{id:Number(this.props.data.ALB_ID),type:"album",width:200,height:200,picture_type:"cover",md5:this.props.data.ALB_PICTURE,bordered:!0,play:!0,play_link:!0,play_force:!0,preview:!0,context:"artist_discography",context_menu:this.props.data}),this.props.addFavorite?s.createElement(o,{id:Number(this.props.data.ALB_ID),type:"album",size:"block"}):null)},_renderProducerLine:function(){return this.props.producerLine?s.createElement("div",{className:"album-legal"},this.props.data.PRODUCER_LINE):void 0},_renderTitle:function(){return s.createElement("h2",{className:"heading-2 ellipsis"},s.createElement("a",{href:"/album/"+this.props.data.ALB_ID,onClick:this._onLink,"data-position":this.props.index},this.props.data.ALB_TITLE))},_renderReleaseDate:function(){return s.createElement("div",{className:"album-release"},formatDate(this.props.data.PHYSICAL_RELEASE_DATE))},_renderDatagrid:function(){return s.createElement(l,{type:"discographyArtist",items:this.props.songs})},_renderViewMore:function(){return this.props.limit<this.props.total?s.createElement("div",{className:"view-more-container"},s.createElement("button",{className:"btn btn-block btn-view-more",href:"/album/"+this.props.data.ALB_ID,onClick:this._onLink,"data-position":this.props.index,type:"button"},s.createElement("span",{className:"label ellipsis"},r.gettext("Accéder à la fiche album complète (%s titres)",{sprintf:[this.props.total]})))):void 0},_onLink:function(e){e.preventDefault(),www.navigate(e.currentTarget.getAttribute("href")),this.props.tracking&&this.tracking("discography_click",e.currentTarget)}});t.exports=c},{"../../../../core/i18n":245,"@deezer/components/_mixins/tracking":45,"@deezer/components/common/DataGrid":92,"@deezer/components/common/StatesButton":127,"@deezer/components/common/Thumbnail":130,react:"react"}],92:[function(e,t,a){"use strict";var s=e("./DataGrid");s.FullPage=e("./FullPage"),t.exports=s},{"./DataGrid":60,"./FullPage":61}],61:[function(e,t,a){"use strict";var s=e("react"),r=e("./DataGrid"),i=e("./utils"),n=i.getContextName,o=40,l=2e3,c=s.createClass({displayName:"DataGridFullPage",propTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),type:s.PropTypes.string.isRequired,items:s.PropTypes.array.isRequired,itemsTotal:s.PropTypes.number,context:s.PropTypes.string},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),name:s.PropTypes.string},childContextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),name:s.PropTypes.string.isRequired},getInitialState:function(){return this._itemsSize=Math.max(this.props.items.length,o),this._itemsTotal=this.props.itemsTotal||l,{id:this.props.id||this.context&&this.context.id,context:this.props.context||this.context&&this.context.name||n(this.props.type)}},getChildContext:function(){return{id:this.state.id,name:this.state.context}},componentDidMount:function(){Events.subscribeOnce(Events.layout.infiniteScroll,this._loadMore),Events.subscribe(Events.datagrid.allTracksSelected,this._loadAll),infinite_scroll.active()},componentWillUnmount:function(){Events.unsubscribe(Events.datagrid.allTracksSelected,this._loadAll)},render:function(){return s.createElement(r,{ref:"datagrid",type:this.props.type,items:this.props.items,onSort:this._loadAll,onFilter:this._loadAll})},_isLoadingAll:!1,_loadMore:function(){if(this.isMounted()&&(infinite_scroll.disable(),!(null!==this._itemsTotal&&this._itemsSize>=this._itemsTotal))){var e=this._getRequestArgs(this.props.type,o),t=e.method,a=e.parameters;api.call({method:t,data:a,success:this._update})}},_loadAll:function(e,t){if(t="function"==typeof e?e:t,t=t||function(){},null!==this._itemsTotal&&this._itemsSize>=this._itemsTotal)return void window.setZeroTimeout(t);if(!this._isLoadingAll){infinite_scroll.disable();var a=this._getRequestArgs(this.props.type,l),s=a.method,r=a.parameters;this._isLoadingAll=!0,api.call({method:s,data:r,success:function(e){this.isMounted()&&(e=e.SONGS||e,this._itemsSize=e.total,this._itemsTotal=e.total,this.refs.datagrid.addItems(e.data),t())}.bind(this)})}},_update:function(e){e=e.SONGS||e,this.isMounted()&&0!==e.count&&(this._itemsSize=this._itemsSize+o,this._itemsTotal=e.total,this.refs.datagrid.addItems(e.data),Events.subscribeOnce(Events.layout.infiniteScroll,this._loadMore),infinite_scroll.active())},_getRequestArgs:function(e,t){var a,s;switch(e){case"loved":a="favorite_song.getList",s={user_id:this.state.id,start:this._itemsSize,nb:t};break;case"history":a="user.getSongsHistory",s={start:this._itemsSize,nb:t};break;case"personal_song":a="personal_song.getList",s={start:this._itemsSize,nb:t};break;case"search":a="search.music",s={query:this.context.id,filter:"ALL",output:"TRACK",start:this._itemsSize,nb:t};break;case"playlist":case"personalPlaylist":a="deezer.pagePlaylist",s={playlist_id:this.state.id,lang:SETTING_LANG,start:this._itemsSize,nb:t,header:!1,tags:!1};break;case"downloads":a="store.getList",s={start:this._itemsSize,nb:t,order:7};break;case"artistTopTracks":a="artist.getTopTrack",s={art_id:this.state.id,start:this._itemsSize,nb:t};break;default:throw new Error('Items of type "'+e+'" are not handled by the DataGrid.FullPage component.')}return{method:a,parameters:s}}});t.exports=c},{"./DataGrid":60,"./utils":110,react:"react"}],60:[function(e,t,a){"use strict";var s=e("babel-runtime/core-js/object/assign")["default"],r=e("react"),i=e("react-dom"),n=e("classnames"),o=e("../../../core/i18n"),l=o.gettext,c=e("../../../models/track"),p=e("@deezer/components/common/Infinite"),d=e("./_elements/ColGroup"),u=e("./_elements/Toolbar"),h=e("./_elements/Header"),m=e("./_elements/Line"),_=e("./_elements/DragImage"),y=e("./_elements/cells"),g=e("./store"),f=e("./utils"),b=f.getContextName,v=f.isItemAvailable,E=f.getItemId,T=f.getItem,S=f.getContributor,A=f.getSort,P=f.setSort,N=f.getItemUniqId,I=[];for(var k in y)y.hasOwnProperty(k)&&"undefined"!=typeof y[k].filter&&I.push(y[k].filter);var x=r.createClass({displayName:"Datagrid",propTypes:{type:r.PropTypes.oneOf(["personalPlaylist","playlist","history","loved","favorite","search","personal_song","downloads","album","discography","topArtist","talkShow","talkEpisodes","discographyArtist","artistTopTracks","talkShow","talkEpisodes"]).isRequired,items:r.PropTypes.array.isRequired,id:r.PropTypes.number,context:r.PropTypes.string,options:r.PropTypes.shape({add:r.PropTypes.bool,cdNumber:r.PropTypes.bool,changeOrder:r.PropTypes.bool,cells:r.PropTypes.arrayOf(r.PropTypes.oneOf(["Unseen","Love","Play","Title","Actions","Artist","Album","Duration","Popularity","Download","AddDate","ListenDate","Checkbox","EpisodeTitle"])),editMp3:r.PropTypes.bool,fallback:r.PropTypes.bool,fanOnly:r.PropTypes.bool,filter:r.PropTypes.bool,header:r.PropTypes.bool,infiniteScroll:r.PropTypes.bool,lyrics:r.PropTypes.bool,multiArtist:r.PropTypes.bool,toolbar:r.PropTypes.oneOf([!1,"top","bottom"]),playAll:r.PropTypes.bool,remove:r.PropTypes.bool,reverseBackground:r.PropTypes.bool,selectAll:r.PropTypes.bool,share:r.PropTypes.bool,trackNumber:r.PropTypes.bool,trackIndex:r.PropTypes.bool,video:r.PropTypes.bool}),scrollingContainer:r.PropTypes.object,onSort:r.PropTypes.func,onFilter:r.PropTypes.func},contextTypes:{id:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]),name:r.PropTypes.string},childContextTypes:{id:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string]),name:r.PropTypes.string,store:r.PropTypes.object},getDefaultProps:function(){return{id:0}},getInitialState:function(){var e=c.hydrate(this.props.items),t=e.map(function(e){return E(T(e))});this._store=(new g).fill(t);var a=A(this.context.id,this.props.type),s=a.cell,r=a.order;return{id:this.props.id||this.context&&this.context.id,type:this.props.type,items:e,context:this.props.context||this.context&&this.context.name||b(this.props.type),options:this._getOptions(this.props.options,this.props.type),sortCell:s,sortOrder:r,filter:"",dragItems:null,dragDivider:null,displayedContributors:this._store.getDisplayedContributors()}},getChildContext:function(){return{id:this.state.id,name:this.state.context,store:this._store}},componentWillMount:function(){this._filteredItems=this._filterItems(this.state.items,this.state.filter),this._filteredItems=this._sortItems(this._filteredItems,this.state.sortCell,this.state.sortOrder)},componentDidMount:function(){this._store.onChange(this._updateContributors),Events.subscribe(Events.user.addFavorite,this._onAddFavorite),Events.subscribe(Events.user.deleteFavorite,this._onRemoveFavorite),Events.subscribe(Events.user.addPersonalSong,this._onAddPersonalSong),Events.subscribe(Events.user.updatePersonalSong,this._onUpdatePersonalSong),Events.subscribe(Events.playlist.addSong,this._onAddSong),Events.subscribe(Events.playlist.removeSong,this._onRemoveSong),this.state.options.infiniteScroll===!0&&this.forceUpdate()},componentWillReceiveProps:function(e){var t=c.hydrate(e.items),a=t.map(function(e){return E(T(e))});this._store.fill(a),this.setState({id:e.id,type:e.type,items:t,context:e.context,options:this._getOptions(e.options,e.type),displayedContributors:this._store.getDisplayedContributors()})},componentWillUpdate:function(e,t){this._filteredItems=this._filterItems(t.items,t.filter),this._filteredItems=this._sortItems(this._filteredItems,t.sortCell,t.sortOrder),t.options.infiniteScroll===!0&&(this.fillerHeight=this._getFillerHeight(e.scrollingContainer))},componentWillUnmount:function(){this._store.offChange(this._updateContributors),Events.unsubscribe(Events.user.addFavorite,this._onAddFavorite),Events.unsubscribe(Events.user.deleteFavorite,this._onRemoveFavorite),Events.unsubscribe(Events.user.sendPersonalSong,this._onSendPersonalSong),Events.unsubscribe(Events.user.progressPersonalSong,this._onProgressPersonalSong),Events.unsubscribe(Events.user.addPersonalSong,this._onAddPersonalSong),Events.unsubscribe(Events.user.updatePersonalSong,this._onUpdatePersonalSong),Events.unsubscribe(Events.playlist.addSong,this._onAddSong),Events.unsubscribe(Events.playlist.removeSong,this._onRemoveSong)},presets:e("./presets"),defaultOptions:{add:!1,availableOnly:!1,cdNumber:!1,changeOrder:!1,cells:["Love","Play","Title","Artist","Album","Duration"],download:!1,editMp3:!1,fallback:!1,fanOnly:!1,filter:!1,header:!1,infiniteScroll:!1,lyrics:!1,multiArtist:!1,offline:!1,playAll:!1,playlistAssistant:!1,remove:!1,replace:!1,reverseBackground:!1,selectAll:!1,share:!1,sorter:!1,toolbar:"top",trackNumber:!1,trackIndex:!1,video:!1},toolbarHeight:48,headerHeight:30,itemsHeight:30,fillerHeight:0,addItems:function(e){e=Array.isArray(e)?e:[e];var t=function(t){if(this.isMounted()&&("number"!=typeof t.count||t.count===e.length)){t=t.data||t,e=c.hydrate(t),e=this.state.items.concat(e);var a=e.map(function(e){return E(T(e))});this._store.fill(a),this.setState({items:e}),Events.trigger(Events.datagrid.addedItems,{items:e})}}.bind(this);return"number"==typeof e[0]?(e=e.map(function(e){return[e,0]}),void api.call({method:"song.getListAllData",data:{sng_ids:e},success:t})):void t(e)},removeItems:function(e){e=Array.isArray(e)?e:[e],e=e.map(function(e){return Number(Array.isArray(e)?e[0]:e)}),e=this.state.items.filter(function(t){return-1===e.indexOf(Number(t.SNG_ID))}),this.setState({items:e})},updateItem:function(e,t){for(var a=this.state.items.slice(0),r=0,i=a.length;i>r;r++)if(Number(a[r].SNG_ID)===e){a[r]=s({},a[r],t);break}this.setState({items:c.hydrate(a)},this._forceListUpdate)},render:function(){var e=n({datagrid:!0,"datagrid-alt":this.state.options.reverseBackground});return r.createElement("div",{ref:"datagrid",className:e},this._renderToolbar(this._filteredItems,"top"),r.createElement("table",{className:"datagrid-table"},r.createElement(d,{cells:y,options:this.state.options}),this._renderHeader(),this._renderBody(this._filteredItems)),this._renderToolbar(this._filteredItems,"bottom"),this._renderPlaylistAssistant(),this._renderDragImage())},_renderToolbar:function(e,t){return t!==this.state.options.toolbar?null:r.createElement(u,{type:this.state.type,items:e,options:this.state.options,onFilter:this._onFilter,filter:this.state.filter,sortOrder:this.state.sortOrder,sortCell:this.state.sortCell,onSort:this._onSort})},_renderHeader:function(){return this.state.options.header?r.createElement(h,{cells:y,options:this.state.options,sortOrder:this.state.sortOrder,sortCell:this.state.sortCell,onSort:this._onSort}):null},_renderBody:function(e){return this.state.options.infiniteScroll===!1?r.createElement("tbody",null,this._renderLines(e)):r.createElement(p,{ref:"list",containerType:"tbody",spacerType:"tr",elementHeight:this.itemsHeight,scrollingContainer:this.props.scrollingContainer},this._renderLines(e))},_renderLines:function(e){var t,a,s,i,n,o,l,c=[];this.state.options.changeOrder&&null===this.state.sortCell&&(s=!0,n=this._drop,o=this._dragOver,l=this._dragEnd);for(var p=0,d=e.length;d>p;++p)t=T(e[p]),a=E(t),(this.state.options.availableOnly!==!0||v(e[p])!==!1)&&(this.state.dragDivider&&this.state.dragDivider[0]===a&&"before"===this.state.dragDivider[1]&&c.push(r.createElement("tr",{key:"divider",className:"divider"})),this.state.options.changeOrder&&null===this.state.sortCell&&(i=this._dragStart.bind(this,t)),c.push(r.createElement(m,{type:this.state.type,items:e,item:e[p],filter:this.state.filter,sortCell:this.state.sortCell,sortOrder:this.state.sortOrder,options:this.state.options,index:p,draggable:s,onDragStart:i,onDrop:n,onDragOver:o,onDragEnd:l,key:N(e[p])})),-1!==this.state.displayedContributors.indexOf(a)&&c.push(r.createElement("tr",{key:"item-contributors-"+a,className:"contributors"},this._renderContributorsLine(t))),this.state.dragDivider&&this.state.dragDivider[0]===a&&"after"===this.state.dragDivider[1]&&c.push(r.createElement("tr",{key:"divider",className:"divider"})));return this.state.options.infiniteScroll===!1?c:(this.fillerHeight>0&&c.push(r.createElement("tr",{key:"filler",style:{height:this.fillerHeight}})),c)},_renderContributorsLine:function(e){var t=[],a=S(e.SNG_CONTRIBUTORS,"author"),s=S(e.SNG_CONTRIBUTORS,"composer"),i=S(e.SNG_CONTRIBUTORS,"misc");""!==a&&t.push(l("Auteur :")+" "+a),""!==s&&t.push(l("Compositeur :")+" "+s),""!==i&&t.push(l("Autres contributeurs :")+" "+i),t=t.join(" / ");var n=this.state.options.cells.length+2,o=this.state.options.cells.indexOf("Title")+1,c=n-o;return[r.createElement("td",{key:"spacer",colSpan:o}),r.createElement("td",{key:"contributors",colSpan:c},r.createElement("div",{className:"wrapper"},t))]},_renderDragImage:function(){return r.createElement(_,{ref:"dragImage",items:this.state.dragItems})},_renderPlaylistAssistant:function(){return this.state.options.playlistAssistant===!1||0!==this.state.items.length?null:r.createElement("button",{className:"btn empty-datagrid-add-track",type:"button",onClick:this._onPlaylistAssistantClick},r.createElement("span",{className:"btn btn-primary btn-icon"},r.createElement("span",{className:"icon icon-add"})),r.createElement("span",{className:"label"},l("Me suggérer des titres")))},_onSort:function(e,t){if(null===e||"undefined"!=typeof y[e]&&"function"==typeof y[e].sort){var a=this._updateSort.bind(this,e,t);return"function"==typeof this.props.onSort?void this.props.onSort(a):void window.setZeroTimeout(a)}},_onFilter:function(e){var t=this._updateFilter.bind(this,e);return"function"==typeof this.props.onFilter?void this.props.onFilter(t):void window.setZeroTimeout(t)},_onAddSong:function(e,t){if(this.state.id===Number(t.playlist_id)&&"personalPlaylist"===this.props.type){var a=t.song.map(function(e){return Number(Array.isArray(e)?e[0]:e)});this.addItems(a)}},_onRemoveSong:function(e,t){this.state.id===Number(t.playlist_id)&&-1!==["personalPlaylist","personal_song"].indexOf(this.props.type)&&this.removeItems(t.song)},_onAddFavorite:function(e,t){this.state.id===window.USER.USER_ID&&"loved"===this.props.type&&this.addItems(Number(t.id))},_onRemoveFavorite:function(e,t){this.state.id===window.USER.USER_ID&&"loved"===this.props.type&&this.removeItems(Number(t.id))},_onAddPersonalSong:function(e,t){this.state.id===window.USER.USER_ID&&"personal_song"===this.props.type&&this.addItems(Number(t))},_onUpdatePersonalSong:function(e,t){this.state.id===window.USER.USER_ID&&"personal_song"===this.props.type&&this.updateItem(t.id,t.item)},_onSendPersonalSong:function(e,t){var a=new Date;a=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDay(),this.addItems({SNG_ID:-t[0],DURATION:0,USER_ID:window.USER.USER_ID,FILESIZE:t[0],FILESIZE_MP3_MISC:t[0],ART_ID:0,ART_NAME:l("En cours"),ALB_ID:0,SNG_TITLE:t[1],ALB_TITLE:"",TYPE:1,RIGHTS:{STREAM_ADS:a,STREAM_SUB:a},FAN_ONLY:0,__TYPE__:"song"})},_onProgressPersonalSong:function(e,t){return t[2]>=100?void this.removeItems(-t[0]):void this.updateItem(-t[0],{ART_NAME:l("En cours")+" ("+t[2]+"%)"})},_onPlaylistAssistantClick:function(){modal.open("/lightbox/playlist_assistant?type=add_song&playlist_id="+this.context.id)},_filteredItems:[],_dragDebounce:0,_updateContributors:function(e){"contributors"===e&&this.setState({displayedContributors:this._store.getDisplayedContributors()})},_forceListUpdate:function(){"undefined"!=typeof this.refs&&"undefined"!=typeof this.refs.list&&this.refs.list.forceUpdate()},_getOptions:function(e,t){e=e||{};var a,s,r={};for(var i in this.defaultOptions)this.defaultOptions.hasOwnProperty(i)&&(a=e[i],s=this.presets[t]&&this.presets[t][i],"undefined"!=typeof a?r[i]=a:"undefined"!=typeof s?r[i]=s:r[i]=this.defaultOptions[i]);return r},_updateSort:function(e,t){"undefined"==typeof t&&(t=this.state.sortCell===e&&"asc"===this.state.sortOrder?"desc":"asc"),P(this.context.id,this.state.type,{cell:e,order:t}),(this.state.sortOrder!==t||this.state.sortCell!==e)&&this.setState({sortOrder:t,sortCell:e},this._forceListUpdate)},_updateFilter:function(e){this.state.filter!==e&&this.setState({filter:e},this._forceListUpdate)},_sortItems:function(e,t,a){return"undefined"==typeof y[t]||"function"!=typeof y[t].sort?e:(e=e.slice(),e.sort(y[t].sort),"asc"===a?e:e.reverse())},_filterItems:function(e,t){return""===t?e:e.filter(function(e){return I.some(function(a){return a(t,e)})})},_getFillerHeight:function(e){var t=(e||document.querySelector(".page-scroll")||document.body).offsetHeight,a=this.refs.datagrid.getBoundingClientRect().top,s=this.toolbarHeight+this.headerHeight+this._filteredItems.length*this.itemsHeight;return Math.max(0,t-a-s)},_dragStart:function(e,t){var a,s=[];this._store.select(E(e));for(var r=0,n=this.state.items.length;n>r;r++)a=E(T(this.state.items[r])),this._store.isSelected(a)&&s.push(this.state.items[r]);this.setState({dragItems:s}),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",""),"setDragImage"in t.dataTransfer&&t.dataTransfer.setDragImage(i.findDOMNode(this.refs.dragImage),-10,-10)},_drop:function(){var e,t,a=this.state.items.slice(0);for(e=0,t=this.state.dragItems.length;t>e;e++){var s=this._getIndexes(this.state.dragItems[e],this.state.dragDivider);this._moveItem(a,s.src,s.dest)}var r=[];for(e=0,t=a.length;t>e;e++)r.push(E(a[e]));switch(this.props.type){case"personalPlaylist":api.call("playlist.updateOrder",{playlist_id:this.context.id,position:"0",order:r});break;case"loved":api.call("favorite_song.updateOrder",{position:"0",order:r})}this.setState({items:a},this._forceListUpdate),this._cleanAfterDrag()},_dragEnd:function(){this._cleanAfterDrag()},_dragOver:function(e){e.preventDefault();var t=Date.now();if(!(t-this._dragDebounce<150)){this._dragDebounce=t;var a=Number(e.currentTarget.getAttribute("data-key")),s=e.currentTarget.getBoundingClientRect(),r=e.clientY-s.top<this.itemsHeight/2?"before":"after";this.state.dragDivider&&a===this.state.dragDivider[0]&&r===this.state.dragDivider[1]||this.setState({dragDivider:[a,r]},this._forceListUpdate)}},_cleanAfterDrag:function(){if(null!==this.state.dragDivider){var e,t,a;for(e=0,t=this.state.items.length;t>e;e++)a=E(this.state.items[e]),this._store.unselect(a);this.setState({dragItems:null,dragDivider:null},this._forceListUpdate)}},_getIndexes:function(e,t){var a,s,r,i,n,o=E(e),l=t[0],c=t[1];for(a=0,s=this.state.items.length;s>a&&(r=E(this.state.items[a]),o===r&&(i=a),l===r&&(n=a),!i||!n);a++);return n>i&&"before"===c?n-=1:i>n&&"after"===c&&(n+=1),{src:i,dest:n}},_moveItem:function(e,t,a){var s,r=e[t];if(a>t)for(s=t;a>s;s++)e[s]=e[s+1];else for(s=t;s>a;s--)e[s]=e[s-1];e[a]=r}});t.exports=x},{"../../../core/i18n":245,"../../../models/track":252,"./_elements/ColGroup":62,"./_elements/DragImage":63,"./_elements/Header":64,"./_elements/Line":65,"./_elements/Toolbar":73,"./_elements/cells":91,"./presets":100,"./store":109,"./utils":110,"@deezer/components/common/Infinite":123,"babel-runtime/core-js/object/assign":285,classnames:"classnames",react:"react","react-dom":"react-dom"}],123:[function(e,t,a){"use strict";t.exports=e("./infinite")},{"./infinite":124}],124:[function(e,t,a){"use strict";var s=e("react"),r=function(e,t){return"undefined"!=typeof e[t]&&("number"!=typeof e[t]||e[t]%1!==0||e[t]<1)?new Error("Warning: "+t+" must be a positive integer."):void 0},i=function(e,t,a){return"undefined"==typeof e[t]?new Error("Warning: Required prop `"+t+"` was not specified in `"+a+"`."):r(e,t,a)},n=s.createClass({displayName:"Infinite",propTypes:{batchSize:r,containerType:s.PropTypes.string,containerClassName:s.PropTypes.string,spacerType:s.PropTypes.string.isRequired,elementHeight:i,scrollingContainer:s.PropTypes.object,bufferSize:r,stateTTL:r,children:s.PropTypes.array},getDefaultProps:function(){return{containerType:"div",spacerType:"div",stateTTL:150}},getInitialState:function(){var e=this.props.scrollingContainer||document.querySelector(".page-scroll")||document.body,t=e.offsetHeight,a=this.props.batchSize||t/2,s=this.props.bufferSize||t;return{start:0,end:Math.ceil((a+s)/this.props.elementHeight),numberOfChildren:this.props.children.length,containerHeight:t,batchSize:a,isScrolling:!1,bufferSize:s,scrollingContainer:e}},componentDidMount:function(){this.state.scrollingContainer.addEventListener("scroll",this._onScroll,!1)},componentWillReceiveProps:function(e){var t=e.scrollingContainer||this.state.scrollingContainer,a=t.offsetHeight;this.setState({numberOfChildren:e.children.length,containerHeight:a,batchSize:e.batchSize||Math.ceil(a/2),bufferSize:e.bufferSize||a,scrollingContainer:t},this._updateState)},shouldComponentUpdate:function(e,t){return this.state.start!==t.start||this.state.end!==t.end||this.state.numberOfChildren!==t.numberOfChildren||this.state.containerHeight!==t.containerHeight||this.state.isScrolling!==t.isScrolling||this.state.numberOfChildren>0&&this.props.children[this.state.numberOfChildren-1].key!==e.children[this.state.numberOfChildren-1].key},componentWillUnmount:function(){this.state.scrollingContainer.removeEventListener("scroll",this._onScroll,!1)},render:function(){var e=this.props.children.slice(this.state.start,this.state.end);return s.createElement(this.props.containerType,{style:{pointerEvents:this.state.isScrolling?"none":"auto"},className:this.props.containerClassName},this._renderTopSpacer(),e,this._renderBottomSpacer())},_renderTopSpacer:function(){return s.createElement(this.props.spacerType,{key:"topSpacer",style:{height:this.state.start*this.props.elementHeight}})},_renderBottomSpacer:function(){return s.createElement(this.props.spacerType,{key:"bottomSpacer",style:{height:Math.max(0,(this.state.numberOfChildren-this.state.end)*this.props.elementHeight)}})},_onScroll:function(){this.scrollingTimeout&&clearTimeout(this.scrollingTimeout),this._updateState(!0),this.scrollingTimeout=setTimeout(this._updateStateFinal,this.props.stateTTL)},_updateState:function(e){var t=this.state.scrollingContainer.scrollTop,a=Math.floor(t/this.state.batchSize),s=this.state.batchSize*a,r=s+this.state.batchSize,i=Math.floor(Math.max(0,s-this.state.bufferSize)/this.props.elementHeight),n=Math.ceil(Math.min(this.props.elementHeight*this.state.numberOfChildren,r+this.state.bufferSize)/this.props.elementHeight);this.setState({start:i,end:n,isScrolling:Boolean(e)})},_updateStateFinal:function(){this.setState({isScrolling:!1})}});t.exports=n},{react:"react"}],109:[function(e,t,a){"use strict";var s=e("../../../core/Store"),r=function(){return new s({items:{},defaultSelection:!1,fill:function(e){for(var t=[],a=0,s=e.length;s>a;a++)t[e[a]]=this.items[e[a]]||{selected:this.defaultSelection,displayContributors:!1};return this.items=t,this.emitChange(),this},reset:function(){return this.defaultSelection=!1,this.items={},this.emitChange(),this},setDefaultSelection:function(e){return this.defaultSelection=e,this},selectAll:function(){for(var e in this.items)this.items.hasOwnProperty(e)&&(this.items[e].selected=!0);return this.emitChange("selection"),this},unselectAll:function(){for(var e in this.items)this.items.hasOwnProperty(e)&&(this.items[e].selected=!1);return this.emitChange("selection"),this},toggleSelection:function(e){return"undefined"==typeof this.items[e]?this:(this.items[e].selected=!this.items[e].selected,this.emitChange("selection"),this)},select:function(e){return"undefined"==typeof this.items[e]?this:(this.items[e].selected=!0,this.emitChange("selection"),this)},unselect:function(e){return"undefined"==typeof this.items[e]?this:(this.items[e].selected=!1,this.emitChange("selection"),this)},isSelected:function(e){return this.items[e]&&this.items[e].selected},hasOneSelected:function(){for(var e in this.items)if(this.items.hasOwnProperty(e)&&this.items[e].selected===!0)return!0;return!1},toggleContributors:function(e){if("undefined"==typeof this.items[e])return this;var t=this.items[e].displayContributors;return this.hideAllContributors(),t===!1&&(this.items[e].displayContributors=!0),this.emitChange("contributors"),this},displayContributors:function(e){return"undefined"==typeof this.items[e]?this:(this.items[e].displayContributors=!0,this.emitChange("contributors"),this)},hideContributors:function(e){return"undefined"==typeof this.items[e]?this:(this.items[e].displayContributors=!1,this.emitChange("contributors"),this)},hasDisplayedContributors:function(e){return this.items[e]&&this.items[e].displayContributors},getDisplayedContributors:function(){var e=[];for(var t in this.items)this.items.hasOwnProperty(t)&&this.items[t].displayContributors&&e.push(Number(t));return e},hideAllContributors:function(){for(var e in this.items)this.items.hasOwnProperty(e)&&(this.items[e].displayContributors=!1);return this.emitChange("contributors"),this}})};t.exports=r},{"../../../core/Store":240}],240:[function(e,t,a){"use strict";var s=e("./util"),r=e("./EventDispatcher"),i=function(e){this.uniq_id=s.uniqid(),this.parent={},this.callbacks={},this.eventDispatcher=new r,this.emitChange=function(e){this.eventDispatcher.trigger(e)}.bind(this),this.onChange=function(e){this.eventDispatcher.subscribe(e)}.bind(this),this.offChange=function(e){this.eventDispatcher.unSubscribe(e)}.bind(this);for(var t in e)e.hasOwnProperty(t)&&(this.hasOwnProperty(t)&&(this.parent[t]=this[t]),this[t]=e[t])};t.exports=i},{"./EventDispatcher":239,"./util":250}],239:[function(e,t,a){"use strict";var s=e("./util"),r=function(){this.uniq_id=s.uniqid(),this.callbacks={},this.subscribe=function(e){e.uniq_id=s.uniqid(),this.callbacks[e.uniq_id]=e}.bind(this),this.unSubscribe=function(e){if(!e.hasOwnProperty("uniq_id"))return!1;var t=e.uniq_id;return"undefined"==typeof this.callbacks[t]?!1:void delete this.callbacks[t]}.bind(this),this.trigger=function(e){for(var t in this.callbacks)this.callbacks.hasOwnProperty(t)&&this.callbacks[t](e)}.bind(this)};t.exports=r},{"./util":250}],100:[function(e,t,a){"use strict";t.exports={album:e("./album"),discography:e("./discography"),favorite:e("./favorite"),history:e("./history"),personal_song:e("./personal_song"),loved:e("./loved"),personalPlaylist:e("./personalPlaylist"),playlist:e("./playlist"),downloads:e("./downloads"),search:e("./search"),talkShow:e("./talkShow"),talkEpisodes:e("./talkEpisodes"),topArtist:e("./topArtist"),discographyArtist:e("./discographyArtist"),artistTopTracks:e("./artistTopTracks")}},{"./album":93,"./artistTopTracks":94,"./discography":95,"./discographyArtist":96,"./downloads":97,"./favorite":98,"./history":99,"./loved":101,"./personalPlaylist":102,"./personal_song":103,"./playlist":104,"./search":105,"./talkEpisodes":106,"./talkShow":107,"./topArtist":108}],108:[function(e,t,a){arguments[4][96][0].apply(a,arguments)},{dup:96}],107:[function(e,t,a){t.exports={cells:["Play","EpisodeHeard","EpisodeTitle","EpisodeInformation","EpisodeDuration","EpisodeReleaseDate"],playAll:!0,share:!0}},{}],106:[function(e,t,a){t.exports={cells:["Play","EpisodeHeard","EpisodeTitle","EpisodeInformation","EpisodeDuration","EpisodeReleaseDate"],playAll:!0}},{}],105:[function(e,t,a){t.exports={add:!0,cells:["Love","Play","Title","Artist","Album","Duration","Popularity","Checkbox"],header:!0,infiniteScroll:!0,lyrics:!0,selectAll:!0,share:!0,toolbar:"top",video:!0}},{}],104:[function(e,t,a){t.exports={add:!0,availableOnly:!0,cells:["Love","Play","Title","Artist","Album","Duration","Popularity","Checkbox"],fanOnly:!0,filter:!0,header:!0,infiniteScroll:!0,lyrics:!0,offline:!0,playAll:!0,selectAll:!0,share:!0,sorter:!0,video:!0}},{}],103:[function(e,t,a){t.exports={add:!0,checkbox:!0,cells:["Love","Play","Title","Artist","Album","Duration","Checkbox"],editMp3:!0,filter:!0,header:!0,infiniteScroll:!0,lyrics:!0,playAll:!0,remove:!0,selectAll:!0,share:!0,video:!0}},{}],102:[function(e,t,a){t.exports={add:!0,changeOrder:!0,cells:["Love","Play","Title","Artist","Album","Duration","AddDate","Checkbox"],editMp3:!0,fanOnly:!0,filter:!0,header:!0,infiniteScroll:!0,lyrics:!0,offline:!0,playAll:!0,remove:!0,replace:!0,selectAll:!0,share:!0,sorter:!0,video:!0,playlistAssistant:!0}},{}],101:[function(e,t,a){t.exports={add:!0,changeOrder:!0,cells:["Love","Play","Title","Artist","Album","Duration","AddDate","Checkbox"],fanOnly:!0,filter:!0,header:!0,infiniteScroll:!0,lyrics:!0,playAll:!0,remove:!0,replace:!0,selectAll:!0,share:!0,sorter:!0,video:!0}},{}],99:[function(e,t,a){t.exports={add:!0,cells:["Love","Play","Title","Artist","Album","Duration","Checkbox"],fanOnly:!0,filter:!0,header:!0,infiniteScroll:!0,listenDate:!0,lyrics:!0,playAll:!0,selectAll:!0,share:!0,video:!0}},{}],98:[function(e,t,a){t.exports={add:!0,cells:["Love","Play","Title","Artist","Album","Duration","AddDate","Checkbox"],fanOnly:!0,filter:!0,header:!0,infiniteScroll:!0,lyrics:!0,playAll:!0,selectAll:!0,share:!0,sorter:!0,video:!0}},{}],97:[function(e,t,a){t.exports={add:!0,checkbox:!0,cells:["Love","Play","Title","Artist","Album","Duration","Download","Checkbox"],download:!0,filter:!0,header:!0,infiniteScroll:!0,lyrics:!0,playAll:!0,selectAll:!0,video:!0}},{}],96:[function(e,t,a){t.exports={add:!0,cells:["Love","Play","Title","Duration"],fanOnly:!0,lyrics:!0,reverseBackground:!0,toolbar:!1,share:!0,trackIndex:!0,video:!0}},{}],95:[function(e,t,a){t.exports={add:!0,cells:["Love","Play","Title","Artist","Album","Duration","Popularity","Checkbox"],fallback:!0,lyrics:!0,multiArtist:!0,toolbar:"bottom",playAll:!0,selectAll:!0,share:!0,trackNumber:!0,video:!0}},{}],94:[function(e,t,a){t.exports={add:!0,cells:["Love","Play","Title","Artist","Album","Popularity","Duration","Checkbox"],header:!0,playAll:!0,fanOnly:!0,lyrics:!0,download:!1,share:!0,trackIndex:!0,video:!0,filter:!0,selectAll:!0}},{}],93:[function(e,t,a){t.exports={add:!0,cdNumber:!0,cells:["Love","Play","Title","Artist","Album","Duration","Popularity","Checkbox"],fallback:!0,lyrics:!0,multiArtist:!0,playAll:!0,selectAll:!0,share:!0,trackNumber:!0,video:!0}},{}],73:[function(e,t,a){"use strict";t.exports=e("./Toolbar")},{"./Toolbar":72}],72:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=e("./PlayButton"),n=e("./OfflineButton"),o=e("./PlaylistAssistant"),l=e("./Actions"),c=e("./Filter"),p=e("./Sorter"),d=s.createClass({displayName:"Toolbar",propTypes:{type:s.PropTypes.string.isRequired,items:s.PropTypes.array.isRequired,options:s.PropTypes.object.isRequired,onFilter:s.PropTypes.func.isRequired,onSort:s.PropTypes.func.isRequired,filter:s.PropTypes.string,sortOrder:s.PropTypes.string,sortCell:s.PropTypes.string},mixins:[r],render:function(){return s.createElement("div",{className:"datagrid-toolbar",id:"naboo_datagrid_options"},this._renderPlay(),this._renderOffline(),this._renderPlaylistAssistant(),this._renderActions(),this._renderFilter(),this._renderSorter())},_renderPlay:function(){return this.props.options.playAll===!1?null:s.createElement(i,{type:this.props.type,items:""!==this.props.filter||null!==this.props.sortCell?this.props.items:void 0})},_renderOffline:function(){return this.props.options.offline===!1?null:s.createElement(n,{type:this.props.type,items:this.props.items})},_renderPlaylistAssistant:function(){return this.props.options.playlistAssistant===!1?null:s.createElement(o,{type:this.props.type,items:this.props.items})},_renderActions:function(){return s.createElement(l,{type:this.props.type,items:this.props.items,add:this.props.options.add,download:this.props.options.download,remove:this.props.options.remove})},_renderFilter:function(){return this.props.options.filter===!1?null:s.createElement(c,{type:this.props.type,onFilter:this.props.onFilter})},_renderSorter:function(){return this.props.options.sorter===!1?null:s.createElement(p,{onSort:this.props.onSort,sortOrder:this.props.sortOrder,sortCell:this.props.sortCell})}});t.exports=d},{"./Actions":66,"./Filter":67,"./OfflineButton":68,"./PlayButton":69,"./PlaylistAssistant":70,"./Sorter":71,react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],71:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=e("../../../../../core/i18n"),n=i.gettext,o=e("@deezer/components/common/DropDown"),l=s.createClass({displayName:"Sorter",propTypes:{onSort:s.PropTypes.func.isRequired,sortOrder:s.PropTypes.string,sortCell:s.PropTypes.string},mixins:[r],render:function(){var e=this._items.map(function(e,t){return s.createElement(o.Item,{key:t,label:e.label},s.createElement("a",{onClick:this._onSort.bind(this,e.cell,e.order),href:"#"},e.label))}.bind(this));return s.createElement("div",{className:"toolbar-group pull-right"},s.createElement("div",{className:"btn-group"},s.createElement(o,{selected:this._getSelected()},e)))},_onSort:function(e,t,a){a.preventDefault(),this.props.onSort(e,t)},_items:[{label:n("Ajoutés récemment"),cell:"AddDate",order:"desc"},{label:n("A - Z (titre)"),cell:"Title",order:"asc"},{label:n("A - Z (artiste)"),cell:"Artist",order:"asc"},{label:n("A - Z (album)"),cell:"Album",order:"asc"},{label:n("Manuel"),cell:null,order:"asc"}],_default:4,_getSelected:function(){if("function"==typeof this._items.findIndex){var e=this._items.findIndex(this._predicate,this);return-1===e?this._default:e}for(var t=0,a=this._items.length;a>t;t++)if(this._predicate(this._items[t]))return t;return this._default},_predicate:function(e){return this.props.sortOrder===e.order&&this.props.sortCell===e.cell}});t.exports=l},{"../../../../../core/i18n":245,"@deezer/components/common/DropDown":118,react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],70:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=e("../../../../../core/i18n"),n=i.gettext,o=e("../../../../../core/modal"),l=s.createClass({displayName:"PlaylistAssistant",contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]).isRequired},mixins:[r],render:function(){return s.createElement("div",{className:"toolbar-group"},s.createElement("button",{onClick:this._onPlaylistAssistantClick,className:"btn btn-primary",id:"naboo_datagrid_add_track",type:"button"},s.createElement("span",{className:"icon icon-add"}),s.createElement("span",{className:"label"},n("Me suggérer des titres"))))},_onPlaylistAssistantClick:function(){o.open("/lightbox/playlist_assistant?type=add_song&playlist_id="+this.context.id)}});t.exports=l},{"../../../../../core/i18n":245,"../../../../../core/modal":247,react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],69:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=e("@deezer/components/common/StatesButton"),n=s.createClass({displayName:"PlayButton",propTypes:{type:s.PropTypes.string.isRequired,items:s.PropTypes.array},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),name:s.PropTypes.string.isRequired},mixins:[r],render:function(){return s.createElement("div",{className:"toolbar-group"},s.createElement(i,{id:Number(this.context.id),type:"personalPlaylist"===this.props.type?"playlist":this.props.type,items:this.props.items,action:"play",wording_type:"full",play_context:this.context.name}))}});t.exports=n},{"@deezer/components/common/StatesButton":127,react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],127:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("../../core/favorite"),n=s.createClass({displayName:"StatesButton",propTypes:{id:s.PropTypes.number.isRequired,type:s.PropTypes.oneOf(["show","artist","album","playlist","radio","friend","talkEpisodes","loved","history","personal_song","downloads","topArtist","discographyArtist","artistTopTracks"]).isRequired,action:s.PropTypes.oneOf(["favorite","play"]).isRequired,items:s.PropTypes.array,wording_type:s.PropTypes.oneOf(["standard","full"]),play_context:s.PropTypes.string,size:s.PropTypes.oneOf(["","block"]),disabled:s.PropTypes.bool},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),name:s.PropTypes.string},childContextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),name:s.PropTypes.string},getDefaultProps:function(){return{id:0,type:"",action:"favorite",wording_type:"standard",play_context:"",size:"",disabled:!1}},getInitialState:function(){return this._getStateFromStore()},getChildContext:function(){return{id:this.state.id,name:this.state.context}},componentDidMount:function(){this._handleEvents("subscribe"),Events.ready(Events.user.userReady,function(){this.isMounted()&&this.setState(this._getStateFromStore())}.bind(this))},shouldComponentUpdate:function(e,t){return this.props.id!==e.id||this.props.disabled!==e.disabled||this.state.status!==t.status||this.state.active!==t.active},componentWillUnmount:function(){this._handleEvents("unsubscribe")},render:function(){var e={"btn btn-action-default btn-default":!0,active:this.state.active,paused:!this.state.active&&"play"===this.props.action&&"resume"===this.state.status};return e["btn-"+this.props.action]=!0,e["btn-"+this.props.size]=this.props.size,e=r(e),s.createElement("button",{className:e,type:"button",onClick:this._handleClick,disabled:this.props.disabled},s.createElement("div",{className:"action action-"+this.state.status},this._renderContent()))},_renderContent:function(){var e={label:!0},t=r(e),a={icon:!0};a["icon-"+this._getIcon(this.state.status)]=!0;var i=s.createElement("span",{key:"active_icon",className:r(a)},this._getAnimatedIcon());delete a["icon-"+this._getIcon(this.state.status)];var n=this.state.status;"resume"!==n&&(n=this.state.active?"hover":"default"),a["icon-"+this._getIcon(n)]=!0;var o=s.createElement("span",{key:"hover_icon",className:r(a)}),l=[i,s.createElement("span",{key:"active_label",className:t},this._getWording(this.state.status))],c=[o,s.createElement("span",{key:"hover_label",className:t},this._getWording(n))];return s.createElement("div",null,s.createElement("div",{className:"active"},l),s.createElement("div",{className:"hover"},c))},_onFavoriteStatusChange:function(e,t){if("undefined"==typeof t||this.props.type!==t.type||Number(this.props.id)!==Number(t.id))return!1;var a=userData.isFavorite(this.props.type,this.props.id);this.setState({status:a?"active":"default",active:a})},_onPlayStatusChange:function(e,t){return this.state.active||t?this._hasSameContext()?void this.setState({status:this.state.active&&t===!1?"resume":"active",active:t}):(this.setState({status:"default",active:!1}),!0):!1},_onPlayClick:function(){return this._hasSameContext()?(dzPlayer.control.togglePause(),!0):void dzPlayer.play({type:this.props.type,id:this.props.id,data:this.props.items,context:{TYPE:this.props.play_context,ID:this.props.id}})},_onFavoriteClick:function(){i.action(null,{id:this.props.id,type:this.props.type})},_handleEvents:function(e){for(var t=this._type[this.props.action].events_subscription,a=t.length,s=0;a>s;s++)Events[e](t[s].event_name,this[t[s].event_callback])},_handleClick:function(){this.props.disabled||this[this._type[this.props.action].onclick]()},_type:{play:{events_subscription:[{event_name:Events.player.playing,event_callback:"_onPlayStatusChange"}],icon_mapping:{"default":"play-circle",active:" equalizer equalizer-dark equalizer-16",hover:"pause-circle",resume:"play-circle"},onclick:"_onPlayClick"},favorite:{events_subscription:[{event_name:Events.user.addFavorite,event_callback:"_onFavoriteStatusChange"},{event_name:Events.user.deleteFavorite,event_callback:"_onFavoriteStatusChange"}],icon_mapping:{"default":"love",active:"love",hover:"cancel",default_friend:"add",active_friend:"check",hover_friend:"cancel"},onclick:"_onFavoriteClick"}},_hasSameContext:function(){var e=dzPlayer.getContext();return null!==e&&e.TYPE===this.context.name&&e.ID===this.context.id},_getIcon:function(e){var t="friend"===this.props.type?"_friend":"";return this._type[this.props.action].icon_mapping[e+t]},_getAnimatedIcon:function(){return"play"!==this.props.action||"active"!==this.state.status?null:[s.createElement("span",{key:"equalizer_bar_1",className:"equalizer-bar equalizer-bar-1"}),s.createElement("span",{key:"equalizer_bar_2",className:"equalizer-bar equalizer-bar-2"}),s.createElement("span",{key:"equalizer_bar_3",className:"equalizer-bar equalizer-bar-3"})]},_getWording:function(e){return"none"===this.props.wording_type?"":button_multi_state.trad[this.props.wording_type][e+"_"+this.props.action+"_"+this.props.type]?button_multi_state.trad[this.props.wording_type][e+"_"+this.props.action+"_"+this.props.type]:button_multi_state.trad[this.props.wording_type][e+"_"+this.props.action]?button_multi_state.trad[this.props.wording_type][e+"_"+this.props.action]:button_multi_state.trad[this.props.wording_type][e]},_getStateFromStore:function(){var e="default";return"favorite"===this.props.action&&userData.isFavorite(this.props.type,this.props.id)&&(e="active"),"play"===this.props.action&&this._hasSameContext()&&(e=dzPlayer.isPaused()?"resume":dzPlayer.isPlaying()?"active":"default"),{status:e,active:"active"===e}}});t.exports=n},{"../../core/favorite":243,classnames:"classnames",react:"react"}],68:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=e("../../../../../core/i18n"),n=i.gettext,o=e("@deezer/components/common/Tooltip"),l=s.createClass({displayName:"OfflineButton",propTypes:{type:s.PropTypes.string.isRequired,items:s.PropTypes.array.isRequired},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]).isRequired},mixins:[r],render:function(){return"Mac"!==window.BrowserDetect.OS&&"Windows"!==window.BrowserDetect.OS?null:s.createElement("div",{className:"toolbar-group"},s.createElement("div",{className:"btn-group",id:"naboo_datagrid_offline"},s.createElement("label",{className:"btn btn-label"},s.createElement("span",{className:"label"},n("Mode hors connexion"))),s.createElement(o,{text:n("sur mon ordinateur")},s.createElement("button",{onClick:this._onOfflineClick,className:"btn btn-default",id:"naboo_datagrid_offline_local",type:"button","data-target":"offline-local"},s.createElement("span",{className:"icon icon-laptop"})))))},_onOfflineClick:function(){0!==this.props.items.length&&window.dzoffline.display(this.props.type+"/"+this.context.id)}});t.exports=l},{"../../../../../core/i18n":245,"@deezer/components/common/Tooltip":133,react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],67:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("react-addons-pure-render-mixin"),n=e("../../../../../core/i18n"),o=n.gettext,l=e("../cells"),c=[];for(var p in l)l.hasOwnProperty(p)&&"undefined"!=typeof l[p].filter&&c.push(l[p].filter);var d=s.createClass({displayName:"Toolbar",propTypes:{type:s.PropTypes.string.isRequired,onFilter:s.PropTypes.func.isRequired},mixins:[i],getInitialState:function(){return{filter:""}},render:function(){var e={downloads:o("Rechercher dans mes achats"),playlist:o("Rechercher dans la playlist"),personalPlaylist:o("Rechercher dans la playlist"),personal_song:o("Rechercher dans mes MP3"),folder:o("Rechercher dans le dossier"),favorite:o("Rechercher parmi les titres"),loved:o("Rechercher parmi les titres"),history:o("Rechercher dans l'historique")},t=e[this.props.type]||o("Rechercher dans les résultats"),a=r({"form-control":!0,clear:""!==this.state.filter});return s.createElement("div",{className:"toolbar-group pull-right"},s.createElement("form",{role:"search",className:"toolbar-search form-inline",method:"post",onSubmit:this._onFilterSubmit},s.createElement("input",{ref:"filter",className:a,id:"naboo_datagrid_filter_text",placeholder:t,onChange:this._onFilterChange,value:this.state.filter,type:"search"}),s.createElement("a",{className:"reset",onClick:this._onFilterClear,id:"naboo_datagrid_filter_clear",href:"#"},s.createElement("span",{className:"icon icon-cancel"}))))},_onFilterSubmit:function(e){e.preventDefault()},_onFilterChange:function(e){var t=window.rewriting(e.target.value.toLowerCase());this.setState({filter:e.target.value}),this.props.onFilter(t)},_onFilterClear:function(e){e.preventDefault(),this.setState({filter:""},function(){this.refs.filter.focus()}),this.props.onFilter("");}});t.exports=d},{"../../../../../core/i18n":245,"../cells":91,classnames:"classnames",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],66:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=e("../../../../../core/i18n"),n=i.gettext,o=i.ngettext,l=e("../../utils"),c=l.getItem,p=l.getContextName,d=l.getItemId,u=l.downloadItems,h=e("@deezer/components/common/Tooltip"),m=s.createClass({displayName:"Actions",propTypes:{type:s.PropTypes.string.isRequired,items:s.PropTypes.array.isRequired,add:s.PropTypes.bool.isRequired,download:s.PropTypes.bool.isRequired,remove:s.PropTypes.bool.isRequired},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),store:s.PropTypes.object.isRequired},mixins:[r],getInitialState:function(){return{hasOneSelected:this.context.store.hasOneSelected()}},componentDidMount:function(){this.context.store.onChange(this._updateSelection)},componentWillUnmount:function(){this.context.store.offChange(this._updateSelection)},render:function(){if(this.state.hasOneSelected===!1)return null;var e=[];return this.props.add===!0&&e.push(s.createElement(h,{key:"add",text:n("Ajouter")},s.createElement("button",{onClick:this._addMusicBox,className:"btn btn-default",id:"naboo_datagrid_add",type:"button"},s.createElement("span",{className:"icon icon-add"})))),this.props.download===!0&&e.push(s.createElement(h,{key:"download",text:n("Télécharger")},s.createElement("button",{onClick:this._onDownloadClick,className:"btn btn-default",type:"button"},s.createElement("span",{className:"icon icon-download"})))),this.props.remove===!0&&e.push(s.createElement(h,{key:"remove",text:n("Supprimer")},s.createElement("button",{onClick:this._onRemoveClick,className:"btn btn-default",id:"naboo_datagrid_remove",type:"button"},s.createElement("span",{className:"icon icon-trash"})))),0===e.length?null:s.createElement("div",{className:"toolbar-group pull-right"},s.createElement("div",{className:"btn-group"},e))},_onDownloadClick:function(){var e=this.props.items.filter(function(e){return this.context.store.isSelected(d(c(e)))},this);e=e.map(function(e){return d(e)}),0!==e.length&&u(e)},_onRemoveClick:function(){var e=this.props.items.filter(function(e){return this.context.store.isSelected(d(c(e)))},this);if(e=e.map(function(e){var t=d(e);return[t,t>0?0:1]}),0!==e.length&&confirm(o("Êtes-vous sûr de vouloir supprimer le titre sélectionné ?","Êtes-vous sûr de vouloir supprimer les titres sélectionnés ?",{count:e.length}))){var t,a;switch(this.props.type){case"loved":var s=[];for(t=0;t<e.length;t++)s.push(e[t][0]);api.call("favorite_song.removeMulti",{SNG_IDS:s},this._onRemoved,{sng_list:e});break;case"personalPlaylist":a={playlist_id:this.context.id,songs:e},api.call("playlist.deleteSongs",a,this._onRemoved,{sng_list:e});break;case"personal_song":for(t=0;t<e.length;t++)a={upload_id:e[t][0]},api.call("personal_song.delete",a,this._onRemoved,{sng_list:[e[t][0]]})}}},_onRemoved:function(e,t){if(this.isMounted()&&e===!0){userData.removePlaylistSong(this.context.id,t.sng_list);for(var a=0,s=t.sng_list.length;s>a;a++){var r="object"==typeof t.sng_list[a]?t.sng_list[a][0]:t.sng_list[a];this.context.store.unselect(r),"loved"===this.props.type&&userData.isFavorite("song",r)&&userData.deleteFavorite({type:"song",id:r})}}},_addMusicBox:function(e){e.preventDefault();var t;switch(this.props.type){case"discography":case"topArtist":t="artist";break;case"personalPlaylist":t="playlist";break;default:t=this.props.type}for(var a,s,r=[],i=[],n=0,o=this.props.items.length;o>n;n++)a=c(this.props.items[n]),s=d(a),this.context.store.isSelected(s)&&(r.push(s),i.push(a));Events.trigger(Events.menu.contextMenuOpen,{target:e.currentTarget,position:"left",type:"song",data:{SONG:1===i.length?i[0]:{},PLAYLIST_ID:"playlist"===this.props.type||"personalPlaylist"===this.props.type?this.context.id:0,PLAYLIST_PERSONNAL:"personalPlaylist"===this.props.type},id:r,context:t,listen_context:{TYPE:p(this.props.type),ID:this.context.id}})},_updateSelection:function(e){"selection"===e&&this.setState({hasOneSelected:this.context.store.hasOneSelected()})}});t.exports=m},{"../../../../../core/i18n":245,"../../utils":110,"@deezer/components/common/Tooltip":133,react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],65:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("@deezer/components/common/Tooltip"),n=e("./cells"),o=e("../utils"),l=o.getContextName,c=o.isItemAvailable,p=o.getPlayerOptions,d=o.getItemId,u=o.getItemRightMessage,h=o.isItemUnseen,m=o.isItemActive,_=s.createClass({displayName:"Line",propTypes:{type:s.PropTypes.string.isRequired,item:s.PropTypes.object.isRequired,items:s.PropTypes.array.isRequired,filter:s.PropTypes.string,sortCell:s.PropTypes.string,sortOrder:s.PropTypes.string,options:s.PropTypes.object.isRequired,index:s.PropTypes.number.isRequired,draggable:s.PropTypes.bool,onDragStart:s.PropTypes.func,onDrop:s.PropTypes.func,onDragOver:s.PropTypes.func,onDragEnd:s.PropTypes.func},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]),name:s.PropTypes.string,lastSeen:s.PropTypes.number},getInitialState:function(){return{trackActive:m(this.props.item,this.context.name),trackPaused:!dzPlayer.isPlaying()}},componentDidMount:function(){Events.subscribe(Events.player.play,this._onPlay),Events.subscribe(Events.player.paused,this._onPause),Events.subscribe(Events.player.playerLoaded,this._updateTrack)},shouldComponentUpdate:function(e,t){return this.props.filter!==e.filter||this.props.sortCell!==e.sortCell||this.props.sortOrder!==e.sortOrder||this.state.trackActive!==t.trackActive||this.state.trackPaused!==t.trackPaused||this.props.draggable!==e.draggable||this.props.item.ART_NAME!==e.item.ART_NAME||this.props.item.ALB_TITLE!==e.item.ALB_TITLE||this.props.item.SNG_TITLE!==e.item.SNG_TITLE},componentWillUnmount:function(){Events.unsubscribe(Events.player.play,this._onPlay),Events.unsubscribe(Events.player.paused,this._onPause),Events.unsubscribe(Events.player.playerLoaded,this._updateTrack)},render:function(){for(var e,t=[s.createElement("td",{key:"first",className:"first"})],a=d(this.props.item),o=r({song:"talkShow"!==this.props.type,show:"talkShow"===this.props.type,unavailable:c(this.props.item)===!1,active:this.state.trackActive,paused:this.state.trackPaused,unseen:h(this.props.item,this.context.lastSeen)}),l=0,p=this.props.options.cells.length;p>l;l++)e=this.props.options.cells[l],"undefined"!=typeof n[e]?t.push(s.createElement("td",{key:e,className:n[e].className?n[e].className:e},s.createFactory(n[e])({type:this.props.type,item:this.props.item,items:this.props.items,options:this.props.options,filter:this.props.filter,sortCell:this.props.sortCell,index:this.props.index}))):t.push(s.createElement("td",{key:e}));t.push(s.createElement("td",{key:"last",className:"last"}));var m=u(this.props.item),_=s.createElement("tr",{className:o,"data-key":a,key:"item-"+a,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDrop:this.props.onDrop,onDragOver:this.props.onDragOver,onDragEnd:this.props.onDragEnd,onContextMenu:"talkShow"!==this.props.type?this._contextMenu:void 0,onDoubleClick:this._play},t);return""!==m?s.createElement(i,{key:"item-tooltip-"+a,text:m,relativeTo:".track .title"},_):_},_onPlay:function(){var e=m(this.props.item,this.context.name);(this.state.trackActive!==e||this.state.trackPaused!==!1)&&this.setState({trackActive:e,trackPaused:!1})},_onPause:function(){var e=!dzPlayer.isPlaying();this.state.trackPaused!==e&&this.setState({trackPaused:e})},_updateTrack:function(){var e=m(this.props.item,this.context.name),t=!dzPlayer.isPlaying();(this.state.trackActive!==e||this.state.trackPaused!==t)&&this.setState({trackActive:e,trackPaused:t})},_play:function(e){if(e.preventDefault(),c(this.props.item)!==!1){if(m(this.props.item,this.context.name))return void dzPlayer.control.togglePause();var t=p(this.props,this.context);dzPlayer.play(t)}},_contextMenu:function(e){e.preventDefault();var t;switch(this.props.type){case"discography":case"topArtist":t="artist";break;case"personalPlaylist":t="playlist";break;default:t=this.props.type}Events.trigger(Events.menu.contextMenuOpen,{target:e.target,position:{left:e.pageX+1,top:e.pageY+1},type:"song",data:{SONG:this.props.item,PLAYLIST_ID:"playlist"===t?this.context.id:0,PLAYLIST_PERSONNAL:"personalPlaylist"===this.props.type},id:this.props.item.SNG_ID,context:t,listen_context:{TYPE:l(this.props.type),ID:this.context.id}})}});t.exports=_},{"../utils":110,"./cells":91,"@deezer/components/common/Tooltip":133,classnames:"classnames",react:"react"}],91:[function(e,t,a){"use strict";t.exports={AddDate:e("./AddDate"),Album:e("./Album"),Artist:e("./Artist"),Checkbox:e("./Checkbox"),Download:e("./Download"),Duration:e("./Duration"),EpisodeDuration:e("./EpisodeDuration"),EpisodeHeard:e("./EpisodeHeard"),EpisodeInformation:e("./EpisodeInformation"),EpisodeReleaseDate:e("./EpisodeReleaseDate"),EpisodeTitle:e("./EpisodeTitle"),Love:e("./Love"),Play:e("./Play"),Popularity:e("./Popularity"),Title:e("./Title")}},{"./AddDate":74,"./Album":75,"./Artist":76,"./Checkbox":79,"./Download":80,"./Duration":81,"./EpisodeDuration":82,"./EpisodeHeard":83,"./EpisodeInformation":84,"./EpisodeReleaseDate":85,"./EpisodeTitle":86,"./Love":87,"./Play":88,"./Popularity":89,"./Title":90}],90:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("classnames"),n=e("../../../../../core/modal"),o=e("../../../../../core/i18n"),l=o.gettext,c=e("@deezer/components/common/Tooltip"),p=e("../../utils"),d=p.isDeezerTrack,u=p.getContextName,h=p.getItem,m=p.downloadItems,_=p.isItemActive,y=p.getItemId,g=p.isItemAvailable,f=p.hasContributors,b=p.getPlayerOptions,v=s.createClass({displayName:"Title",propTypes:{type:s.PropTypes.string.isRequired,item:s.PropTypes.object.isRequired,items:s.PropTypes.array.isRequired,filter:s.PropTypes.string,sortCell:s.PropTypes.string,options:s.PropTypes.object.isRequired,index:s.PropTypes.number.isRequired},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]).isRequired,name:s.PropTypes.string.isRequired,store:s.PropTypes.object.isRequired},statics:{label:l("Titre"),className:"track",sort:function(e,t){return e.SNG_TITLE.toLowerCase()<t.SNG_TITLE.toLowerCase()?-1:1},filter:function(e,t){return-1!==window.rewriting(t.SNG_TITLE.toLowerCase()).indexOf(e)}},shouldComponentUpdate:function(e){var t=y(this.props.item),a=y(e.item);return t!==a||this.context.store.hasDisplayedContributors(t)!==this.context.store.hasDisplayedContributors(a)},render:function(){return s.createElement("div",null,s.createElement("div",{className:"icons"},this._renderLyrics(),this._renderAdd()),s.createElement("div",{className:"icons hover"},this._renderContributors(),this._renderEdit(),this._renderDownload(),this._renderLink()),s.createElement("div",{className:"icons replace"},this._renderReplace()),s.createElement("div",{className:"wrapper ellipsis"},s.createElement("a",{role:"button",onClick:this._play,className:"title link-gray"},this._getTitle())))},_renderContributors:function(){if(g(this.props.item)===!1||f(this.props.item)===!1)return null;var e=this.context.store.hasDisplayedContributors(y(this.props.item)),t=i({"icon icon-datagrid":!0,"icon-chevron-down":e===!1,"icon-chevron-up":e===!0});return s.createElement(c,{text:l("Voir les contributeurs")},s.createElement("a",{role:"button",onClick:this._toggleContributors},s.createElement("span",{className:t})))},_renderLyrics:function(){return g(this.props.item)===!1||"undefined"==typeof this.props.item.LYRICS_ID||0===this.props.item.LYRICS_ID?null:s.createElement(c,{text:l("Écouter avec les paroles")},s.createElement("a",{role:"button",onClick:this._onLyricsClick},s.createElement("span",{className:"icon icon-datagrid icon-lyrics"})))},_renderAdd:function(){return s.createElement("a",{role:"button",onClick:this._addMusicBox},s.createElement("span",{className:"icon icon-datagrid icon-options"}))},_renderEdit:function(){return d(this.props.item)===!0||this.props.options.editMp3===!1?null:s.createElement(c,{text:l("Editer")},s.createElement("a",{role:"button",onClick:this._onEditClick},s.createElement("span",{className:"icon icon-datagrid icon-edit"})))},_renderDownload:function(){return d(this.props.item)===!1||this.props.options.download!==!0?null:s.createElement(c,{text:l("Télécharger le titre acheté")},s.createElement("a",{role:"button",onClick:this._onDownloadClick},s.createElement("span",{className:"icon icon-datagrid icon-download"})))},_renderLink:function(){return"undefined"==typeof this.props.item.FALLBACK||this.props.options.fallback!==!0?null:s.createElement(c,{text:l("Afficher la source de ce titre")},s.createElement("a",{role:"button",className:"evt-click",href:"/album/"+this.props.item.FALLBACK.ALB_ID},s.createElement("span",{className:"icon icon-datagrid icon-link"})))},_renderReplace:function(){return this.props.options.replace===!1||g(this.props.item)?null:s.createElement("a",{id:"btn_replace_"+this.props.item.ART_ID+"_"+this.props.item.SNG_ID,role:"button",onClick:this._onReplaceClick,"data-hovercard":"/ajax/hovercard/page.php?card=replace&art_id="+this.props.item.ART_ID+"&sng_id="+this.props.item.SNG_ID+"&playlist_id="+this.context.id+"&art_name="+encodeURIComponent(this.props.item.ART_NAME)+"&sng_name="+encodeURIComponent(this.props.item.SNG_TITLE)},s.createElement("span",{className:"icon icon-datagrid icon-replace"}))},_onDownloadClick:function(e){e.preventDefault(),m(y(h(this.props.item)))},_onReplaceClick:function(e){e.preventDefault(),hovercard.init(r(e.currentTarget),0)},_onEditClick:function(e){e.preventDefault(),n.open("/lightbox/edit_personal_song.php?sng_id="+this.props.item.SNG_ID)},_onLyricsClick:function(e){e.preventDefault(),Events.subscribeOnce(Events.player.tracklist_changed,function(){dzPlayer.control.nextSong(),Events.trigger(Events.menu.togglePanel,"lyrics")});var t=b(this.props,this.context);t.radio=!1,t.addNext="radio"!==dzPlayer.getPlayerType()?!0:void 0,dzPlayer.play(t)},_play:function(){if(g(this.props.item)!==!1){if(_(this.props.item,this.context.name))return void dzPlayer.control.togglePause();var e=b(this.props,this.context);dzPlayer.play(e)}},_addMusicBox:function(e){e.preventDefault();var t;switch(this.props.type){case"discography":case"topArtist":t="artist";break;case"personalPlaylist":t="playlist";break;default:t=this.props.type}var a=h(this.props.item);Events.trigger(Events.menu.contextMenuOpen,{target:e.currentTarget,position:"left",type:"song",data:{SONG:a,PLAYLIST_ID:"playlist"===this.props.type||"personalPlaylist"===this.props.type?this.context.id:0,PLAYLIST_PERSONNAL:"personalPlaylist"===this.props.type},id:y(a),context:t,listen_context:{TYPE:u(this.props.type),ID:this.context.id}})},_getTitle:function(){var e=this.props.item.SNG_TITLE;return"string"==typeof this.props.item.VERSION&&""!==this.props.item.VERSION&&(e=e+" "+this.props.item.VERSION),e},_toggleContributors:function(e){e.preventDefault(),this.context.store.toggleContributors(y(this.props.item))}});t.exports=v},{"../../../../../core/i18n":245,"../../../../../core/modal":247,"../../utils":110,"@deezer/components/common/Tooltip":133,classnames:"classnames",jquery:"jquery",react:"react"}],89:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../../core/i18n"),i=r.gettext,n=e("@deezer/components/common/Tooltip"),o=s.createClass({displayName:"Popularity",propTypes:{item:s.PropTypes.object.isRequired},statics:{label:i("Pop."),className:"popularity",sort:function(e,t){return e.RANK_SNG-t.RANK_SNG}},render:function(){var e=this.props.item.RANK_SNG/1e5;return s.createElement(n,{text:i("Popularité : ")+e.toFixed(2)+" / 10",position:"left"},s.createElement("span",{className:"popularity"},s.createElement("span",{className:"note note-"+Math.round(e),"data-target":"note"})))}});t.exports=o},{"../../../../../core/i18n":245,"@deezer/components/common/Tooltip":133,react:"react"}],88:[function(e,t,a){"use strict";var s=e("react"),r=e("../../utils"),i=r.getPlayerOptions,n=r.isItemAvailable,o=r.isItemUnseen,l=r.isItemActive,c=s.createClass({displayName:"Play",propTypes:{type:s.PropTypes.string.isRequired,item:s.PropTypes.object.isRequired,items:s.PropTypes.array.isRequired,options:s.PropTypes.object.isRequired,index:s.PropTypes.number,filter:s.PropTypes.string,sortCell:s.PropTypes.string},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]).isRequired,name:s.PropTypes.string.isRequired,lastSeen:s.PropTypes.number},statics:{label:null,className:"position"},shouldComponentUpdate:function(){return!1},render:function(){var e=o(this.props.item,this.context.lastSeen)?s.createElement("span",{className:"picto-unseen"}):null,t=this.props.options.trackNumber?s.createElement("span",{className:"number"},window.pad(this.props.item.TRACK_NUMBER,2)):null,a=this.props.options.trackIndex?s.createElement("span",{className:"number"},window.pad(Number(this.props.index)+1,2)):null;return s.createElement("div",null,e,a,t,s.createElement("a",{role:"button",className:"play hover","data-target":"play",onClick:this._play,href:"#"},s.createElement("span",{className:"play-icon play-default icon-datagrid"},s.createElement("span",{className:"icon icon-play"})),s.createElement("span",{className:"play-icon play-hover icon-datagrid"},s.createElement("span",{className:"icon icon-pause"})),s.createElement("span",{className:"play-icon play-active"},s.createElement("span",{className:"equalizer equalizer-default equalizer-16"},s.createElement("span",{className:"equalizer-bar equalizer-bar-1"}),s.createElement("span",{className:"equalizer-bar equalizer-bar-2"}),s.createElement("span",{className:"equalizer-bar equalizer-bar-3"})))))},_play:function(e){if(e.preventDefault(),n(this.props.item)!==!1){if(l(this.props.item,this.context.name))return void dzPlayer.control.togglePause();var t=i(this.props,this.context);dzPlayer.play(t)}}});t.exports=c},{"../../utils":110,react:"react"}],87:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../Favorite"),i=s.createClass({displayName:"Love",propTypes:{item:s.PropTypes.object.isRequired},contextTypes:{name:s.PropTypes.string.isRequired},statics:{label:null,className:"loved"},shouldComponentUpdate:function(e){return this.props.item.SNG_ID!==e.item.SNG_ID},render:function(){return s.createElement(r,{type:"song",style:"heart_datagrid",id:String(this.props.item.SNG_ID),context:this.context.name})}});t.exports=i},{"../../../Favorite":119,react:"react"}],119:[function(e,t,a){"use strict";var s=e("babel-runtime/helpers/extends")["default"],r=e("react"),i=e("classnames"),n=e("jquery"),o=e("../../core/i18n"),l=o.gettext,c=r.createClass({displayName:"Favorite",propTypes:{id:r.PropTypes.string.isRequired,type:r.PropTypes.string,style:r.PropTypes.oneOf(["star","heart_small","heart","heart_medium","heart_large","heart_datagrid"]),overlay:r.PropTypes.bool,context:r.PropTypes.string,display_share:r.PropTypes.bool,share_context:r.PropTypes.string,tooltip:r.PropTypes.bool,tooltip_gravity:r.PropTypes.string,onClickCallback:r.PropTypes.func,elId:r.PropTypes.string},getDefaultProps:function(){return{type:"album",style:"heart_small",overlay:!0,context:"",elId:null,display_share:!1,share_context:null,tooltip:!1,tooltip_gravity:"s",onClickCallback:function(){}}},getInitialState:function(){return{share_button_display:!1,active:userData.isFavorite(this.props.type,this.props.id)}},componentDidMount:function(){Events.ready(Events.user.userReady,this._setActiveStatus),Events.subscribe(Events.modal.close,this._setShareButtonStatus),Events.subscribe(Events.user.addFavorite,this._onFavoriteToggle),Events.subscribe(Events.user.deleteFavorite,this._onFavoriteToggle)},componentWillReceiveProps:function(e){var t={active:userData.isFavorite(e.type,e.id)};this._timeout_id&&e.id!==this.props.id&&(t.share_button_display=!1,clearTimeout(this._timeout_id)),this.setState(t)},shouldComponentUpdate:function(e,t){return this.state.active!==t.active||this.state.share_button_display!==t.share_button_display||this.props.id!==e.id},componentWillUnmount:function(){Events.unsubscribe(Events.modal.close,this._setShareButtonStatus),Events.unsubscribe(Events.user.addFavorite,this._onFavoriteToggle),Events.unsubscribe(Events.user.deleteFavorite,this._onFavoriteToggle)},render:function(){var e=i({"evt-over evt-out":this.props.tooltip,active:this.state.active,selected:"heart_datagrid"===this.props.style&&this.state.active}),t=i({icon:!0,"icon-datagrid":"heart_datagrid"===this.props.style,"icon-love":!this.state.share_button_display,"icon-share":this.state.share_button_display,active:!this.state.share_button_display&&this.state.active}),a={};if(this.props.tooltip&&(a={"data-tooltip":"1","data-tooltip-gravity":this.props.tooltip_gravity,"data-tooltip-delay":"400",title:this.state.share_button_display?l("Partager"):this._getTooltip()}),"heart"===this.props.style||"heart_medium"===this.props.style||"heart_large"===this.props.style){e=i({"icon icon-love":"heart_small"===this.props.style,"icon icon-favorite":"star"===this.props.style,"evt-over evt-out":this.props.tooltip,action:!0});var n=i({"icon-32":"heart"===this.props.style,"icon-52":"heart_medium"===this.props.style,"icon-64":"heart_large"===this.props.style,"icon-stack-hover":this.props.overlay,"icon-stack icon-stack-circle":!0});return t=i({icon:!0,"icon-datagrid":"heart_datagrid"===this.props.style,"icon-love":!this.state.share_button_display,"icon-share":this.state.share_button_display,active:!this.state.share_button_display&&this.state.active}),r.createElement("a",s({role:"button",className:e,id:this.props.elId,onClick:this.state.share_button_display?this._onShareClick:this._onClick,"data-tooltip-offset":"2"},a),r.createElement("span",{className:n},r.createElement("span",{className:t})))}return r.createElement("a",s({role:"button",className:e,id:this.props.elId,onClick:this._onClick},a),r.createElement("span",{className:t}))},_onClick:function(e){e.stopPropagation();try{n(e.target).tipsy("hide")}catch(t){}var a=this.state.active?"remove":"add";favorite[a]({type:this.props.type,id:this.props.id,context:this.props.context}),this.props.onClickCallback(this.props.type,this.props.id,!this.state.active)},_onShareClick:function(){this._sharebox_id=sharebox.load(0,this.props.id,this.props.share_context)},_onFavoriteToggle:function(e,t){var a=Number(this.props.id),s=Number(t.id);if(a===s&&this.isMounted()){var r=userData.isFavorite(this.props.type,a),i=userData.isDisliked(a);this.setState({share_button_display:this.props.display_share&&r&&!i,active:r}),this._timeout_id=window.setTimeout(this._hideShareButton,5e3)}},_timeout_id:null,_sharebox_id:0,_hideShareButton:function(){clearTimeout(this._timeout_id),this.isMounted()&&this.setState({share_button_display:!1})},_setActiveStatus:function(){var e=userData.isFavorite(this.props.type,this.props.id);this.state.active!==e&&this.isMounted()&&this.setState({active:e})},_setShareButtonStatus:function(e,t){return t!==this._sharebox_id?!1:void this._hideShareButton()},_getTooltip:function(){return"song"===this.props.type?button_multi_state.getWording({type:this.props.type,action:"favorite"},this.state.active?"hover":"add","full"):""}});t.exports=c},{"../../core/i18n":245,"babel-runtime/helpers/extends":294,classnames:"classnames",jquery:"jquery",react:"react"}],86:[function(e,t,a){"use strict";var s=e("react"),r=e("jquery"),i=e("../../../../../core/i18n"),n=i.gettext,o=e("@deezer/components/common/Tooltip"),l=e("../../utils"),c=l.getContextName,p=l.isItemActive,d=l.getPlayerOptions,u=s.createClass({displayName:"EpisodeTitle",propTypes:{type:s.PropTypes.string.isRequired,item:s.PropTypes.object.isRequired,items:s.PropTypes.array.isRequired,filter:s.PropTypes.string,sortCell:s.PropTypes.string,options:s.PropTypes.object.isRequired},contextTypes:{id:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.string]).isRequired,name:s.PropTypes.string.isRequired},statics:{className:"episode",sort:function(e,t){return e.EPISODE_TITLE.toLowerCase()<t.EPISODE_TITLE.toLowerCase()?-1:1}},render:function(){var e="talkEpisodes"===this.props.type?this.props.item.SHOW_NAME+" | ":"";return e+=this.props.item.EPISODE_TITLE,s.createElement("div",null,s.createElement("div",{className:"icons hover"},this._renderAdd()),s.createElement("div",{className:"wrapper ellipsis"},s.createElement("a",{className:"link-gray evt-click",onClick:this._play,href:"#"},e)))},_renderLink:function(){return"undefined"==typeof this.props.item.FALLBACK||this.props.options.fallback!==!0?null:s.createElement(o,{text:n("Afficher la source de ce titre")},s.createElement("a",{role:"button",className:"evt-click",href:"/show/"+this.props.item.EPISODE_ID,"data-target":"icon-link"},s.createElement("span",{className:"icon icon-datagrid icon-link"})))},_renderAdd:function(){return s.createElement("a",{role:"button","data-target":"icon-add",onClick:this._addTalkBox},s.createElement("span",{className:"icon icon-datagrid icon-options"}))},_renderReplace:function(){return s.createElement("a",{id:"btn_replace_"+this.props.item.ART_ID+"_"+this.props.item.ART_ID,href:"#",onClick:this._onReplaceClick,"data-target":"icon-replace","data-hovercard":"/ajax/hovercard/page.php?card=replace&art_id="+this.props.item.ART_ID+"&sng_id="+this.props.item.SNG_ID+"&playlist_id="+this.context.id+"&art_name="+encodeURIComponent(this.props.item.ART_NAME)+"&sng_name="+encodeURIComponent(this.props.item.EPISODE_TITLE)},s.createElement("span",{className:"icon icon-datagrid icon-replace"}))},_onReplaceClick:function(e){hovercard.init(r(e.currentTarget),0)},_addTalkBox:function(e){e.preventDefault();var t="talkShow";Events.trigger(Events.menu.contextMenuOpen,{target:e.currentTarget,position:"left",type:"episode",data:{EPISODE:this.props.item,cover_type:"talk"},id:this.props.item.EPISODE_ID,context:t,listen_context:{TYPE:c(this.props.type),ID:this.context.id}})},_play:function(){if(p(this.props.item,this.context.name))return void dzPlayer.control.togglePause();var e=d(this.props,this.context);dzPlayer.play(e)}});t.exports=u},{"../../../../../core/i18n":245,"../../utils":110,"@deezer/components/common/Tooltip":133,jquery:"jquery",react:"react"}],85:[function(e,t,a){"use strict";var s=e("react"),r=s.createClass({displayName:"EpisodeReleaseDate",propTypes:{item:s.PropTypes.object.isRequired},statics:{className:"added",sort:function(e,t){return e.DATE_ADD-t.DATE_ADD}},getInitialState:function(){return{time:this.props.item.EPISODE_PUBLISHED_TIMESTAMP}},componentDidMount:function(){this.updateInterval=setInterval(this._updateTime,1e3)},shouldComponentUpdate:function(e,t){return this.state.time!==t.time},componentWillUnmount:function(){clearInterval(this.updateInterval)},updateInterval:null,render:function(){return s.createElement("div",{className:"wrapper ellipsis",title:this.props.item.EPISODE_PUBLISHED_TIMESTAMP},window.formatDate(this.props.item.EPISODE_PUBLISHED_TIMESTAMP.split(" ")[0],"/"))}});t.exports=r},{react:"react"}],84:[function(e,t,a){"use strict";var s=e("react"),r=s.createClass({displayName:"EpisodeInformation",propTypes:{item:s.PropTypes.object.isRequired},contextTypes:{name:s.PropTypes.string.isRequired,panel_name:s.PropTypes.string},statics:{className:"info",sort:function(e,t){return e.DATE_ADD-t.DATE_ADD}},render:function(){return s.createElement("span",{className:"icon icon-before icon-info hover",onClick:this._onClick,id:"episode_"+this.props.item.EPISODE_ID,context:this.context.name})},_onClick:function(e){Events.trigger(Events.menu.contextMenuOpen,{target:e.currentTarget,id:"talk_"+this.props.item.EPISODE_ID,type:"talk",data:this.props.item,position:"left",context:this.context.panel_name,cover_type:"talk",listen_context:{TYPE:"show",ID:this.props.item.EPISODE_ID}})}});t.exports=r},{react:"react"}],83:[function(e,t,a){"use strict";var s=e("react"),r=s.createClass({displayName:"EpisodeHeard",propTypes:{item:s.PropTypes.object.isRequired},statics:{className:"heard",sort:function(e,t){return e.IS_HEARD-t.IS_HEARD}},getInitialState:function(){return{heard:this.props.item.IS_HEARD}},componentDidMount:function(){Events.subscribe(Events.talk.bookmarkSet,this._updateHeard,"bookmark"),Events.ready(Events.user.userReady,this._initHeard,"bookmark")},shouldComponentUpdate:function(e,t){return this.state.heard!==t.heard},componentWillUnmount:function(){Events.unsubscribe(Events.talk.bookmarkSet,this._updateHeard)},render:function(){var e={width:this._getCircleWidth()};return s.createElement("span",{className:"heard-icon"},s.createElement("span",{className:"heard-circle"}),s.createElement("span",{className:"heard-status",style:e}))},_getCircleWidth:function(){var e="100%";return"1"===this.state.heard?e="0%":"0.5"===this.state.heard&&(e="50%"),e},_initHeard:function(){if(this.isMounted()){var e=window.bookmark.getEpisodeBookmark(this.props.item.EPISODE_ID,this.props.item.DURATION);this.setState({heard:e.IS_HEARD})}},_updateHeard:function(e,t){this.props.item.EPISODE_ID===t.EPISODE_ID&&this.setState({heard:t.ISHEARD})}});t.exports=r},{react:"react"}],82:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=s.createClass({displayName:"EpisodeDuration",propTypes:{item:s.PropTypes.object.isRequired},mixins:[r],statics:{className:"duration",sort:function(e,t){return e.DURATION<t.DURATION?-1:1}},render:function(){return s.createElement("span",null,window.secToMin(this.props.item.DURATION))}});t.exports=i},{react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],81:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../../core/i18n"),i=r.gettext,n=s.createClass({displayName:"Duration",propTypes:{item:s.PropTypes.object.isRequired},statics:{label:i("D."),className:"length",sort:function(e,t){return e.DURATION-t.DURATION}},shouldComponentUpdate:function(e){return this.props.item.DURATION!==e.item.DURATION},render:function(){return s.createElement("span",null,window.secToMin(this.props.item.DURATION))}});t.exports=n},{"../../../../../core/i18n":245,react:"react"}],80:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../../core/i18n"),i=r.gettext,n=e("@deezer/components/common/Tooltip"),o=e("../../utils"),l=o.getItemId,c=o.getItem,p=o.downloadItems,d=s.createClass({displayName:"Download",propTypes:{item:s.PropTypes.object.isRequired},statics:{label:i("MP3"),className:"download"},shouldComponentUpdate:function(e){return this.props.item.SNG_ID!==e.item.SNG_ID},render:function(){return s.createElement(n,{text:i("Télécharger")},s.createElement("button",{className:"btn btn-default btn-small",type:"button",onClick:this._onDownloadClick},s.createElement("span",{className:"icon icon-datagrid icon-download"})))},_onDownloadClick:function(){p(l(c(this.props.item)))}});t.exports=d},{"../../../../../core/i18n":245,"../../utils":110,"@deezer/components/common/Tooltip":133,react:"react"}],133:[function(e,t,a){"use strict";t.exports=e("./Tooltip")},{"./Tooltip":132}],79:[function(e,t,a){"use strict";t.exports=e("./Checkbox")},{"./Checkbox":77}],77:[function(e,t,a){"use strict";var s=e("react"),r=e("./Label"),i=e("../../../utils"),n=i.getItemId,o=i.getItem,l=s.createClass({displayName:"Checkbox",propTypes:{item:s.PropTypes.object.isRequired},contextTypes:{store:s.PropTypes.object.isRequired},statics:{label:s.createElement(r,null),className:"check"},getInitialState:function(){return{selected:this.context.store.isSelected(n(o(this.props.item)))}},componentDidMount:function(){this.context.store.onChange(this._updateSelection)},shouldComponentUpdate:function(e,t){return this.state.selected!==t.selected},componentWillUnmount:function(){this.context.store.offChange(this._updateSelection)},render:function(){return s.createElement("input",{"data-target":"check",type:"checkbox",checked:this.state.selected,onDoubleClick:this._onDoubleClick,onChange:this._onSelect})},_onDoubleClick:function(e){e.stopPropagation()},_onSelect:function(){this.context.store[this.state.selected?"unselect":"select"](n(o(this.props.item))),this._updateSelection("selection")},_updateSelection:function(e){"selection"===e&&this.setState({selected:this.context.store.isSelected(n(o(this.props.item)))})}});t.exports=l},{"../../../utils":110,"./Label":78,react:"react"}],110:[function(e,t,a){"use strict";function s(e){var t={playlist:"playlist_page",search:"search_page",personal_song:"personalsong_page",downloads:"downloads_page",album:"album_page",topArtist:"artist_top",discographyArtist:"artist_discography",exclusivityArtist:"artist_exclu",discography:"artist_discography",favorite:"loved_page",loved:"loved_page",history:"history_page",talkShow:"show_page",talkEpisodes:"show_page",personalPlaylist:"playlist_page",artistTopTracks:"artist_top"};return t[e]||e}function r(e){return Number(e.SNG_ID||e.EPISODE_ID)}function i(e){return e.hasFallback()?e.getFallback():e}function n(e,t){for(var a=r(i(e)),s=0,n=t.length;n>s;s++){var o=r(i(t[s]));if(a===o&&e.TS===t[s].TS)return s}return-1}function o(e){return"episode"===e.__TYPE__||right.checkSongAvailable(i(e))===right.READABLE}function l(e){if("episode"===e.__TYPE__)return"";var t=right.checkSongAvailable(i(e));return right.getMessage(t)}function c(e,t){return"undefined"!=typeof e&&t in e?e[t].join(" - "):""}function p(e){return e=i(e),"undefined"!=typeof e.SNG_CONTRIBUTORS&&(e.SNG_CONTRIBUTORS.author instanceof Array||e.SNG_CONTRIBUTORS.composer instanceof Array||e.SNG_CONTRIBUTORS.misc instanceof Array)?!0:!1}function d(e){return e.SNG_ID>0}function u(e,t){for(var a=0,s=t.length;s>a;a++){var n=i(t[a]);if(r(n)===e)return n}return null}function h(e,t){return storage.get(t.toUpperCase()+"_SORT_"+e,{cell:null,order:"asc"})}function m(e,t,a){storage.set(t.toUpperCase()+"_SORT_"+e,a)}function _(e,t){return t&&e.hasOwnProperty("DATE_ADD")?e.DATE_ADD>t:!1}function y(e,t){if(null===dzPlayer.getContext()||null===dzPlayer.getCurrentSong())return!1;var a=r(dzPlayer.getCurrentSong())===r(i(e)),s=t?dzPlayer.getContext().TYPE===t||LOG_CONTEXT[dzPlayer.getContext().TYPE]===LOG_CONTEXT[t]:!0,n=e.TS?e.TS===dzPlayer.getCurrentSong().TS:!0;return a&&s&&n}function g(e){e=Array.isArray(e)?e:[e],api.call("store.getDownloadUrl",{songs:e},function(e){var t=e+"";document.location.assign(t)})}function f(e){var t=r(e),a=e.TS?"-"+e.TS:"";return"item-"+t+a}function b(e,t){var a=e.options.infiniteScroll===!0,r=""!==e.filter||null!==e.sortCell||e.items.length<v,i="topArtist"===e.type,o=a&&!r||i?void 0:e.items;return{id:t.id,type:e.type,data:o,index:n(e.item,e.items),context:{TYPE:s(e.type),ID:t.id}}}var v=40;t.exports={getContextName:s,getItemIndex:n,isItemAvailable:o,isItemUnseen:_,isItemActive:y,getItemRightMessage:l,getItemId:r,getItem:i,getContributor:c,hasContributors:p,isDeezerTrack:d,getItemById:u,getSort:h,setSort:m,downloadItems:g,getItemUniqId:f,getPlayerOptions:b}},{}],78:[function(e,t,a){"use strict";var s=e("react"),r=e("react-addons-pure-render-mixin"),i=s.createClass({displayName:"CheckboxLabel",contextTypes:{store:s.PropTypes.object.isRequired},mixins:[r],getInitialState:function(){return{selected:!1}},render:function(){return s.createElement("input",{"data-target":"checkall",type:"checkbox",onChange:this._onSelect})},_onSelect:function(){var e=!this.state.selected;this.context.store.setDefaultSelection(e),this.context.store[e?"selectAll":"unselectAll"](),e===!0&&Events.trigger(Events.datagrid.allTracksSelected),this.setState({selected:e})}});t.exports=i},{react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],76:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../../core/i18n"),i=r.gettext,n=s.createClass({displayName:"Artist",propTypes:{item:s.PropTypes.object.isRequired},statics:{label:i("Artiste"),className:"artist",sort:function(e,t){return e.ART_NAME.toLowerCase()<t.ART_NAME.toLowerCase()?-1:1},filter:function(e,t){return-1!==window.rewriting(t.ART_NAME.toLowerCase()).indexOf(e)}},shouldComponentUpdate:function(e){return this.props.item.ART_ID!==e.item.ART_ID||this.props.item.ART_NAME!==e.item.ART_NAME},render:function(){var e;return e=0===Number(this.props.item.ART_ID)?this.props.item.ART_NAME:s.createElement("a",{className:"evt-click",href:"/artist/"+this.props.item.ART_ID},this.props.item.ART_NAME),s.createElement("div",{className:"wrapper ellipsis"},e)}});t.exports=n},{"../../../../../core/i18n":245,react:"react"}],75:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../../core/i18n"),i=r.gettext,n=s.createClass({displayName:"Album",propTypes:{item:s.PropTypes.object.isRequired},statics:{label:i("Album"),className:"album",sort:function(e,t){return e.ALB_TITLE.toLowerCase()<t.ALB_TITLE.toLowerCase()?-1:1},filter:function(e,t){return-1!==window.rewriting(t.ALB_TITLE.toLowerCase()).indexOf(e)}},shouldComponentUpdate:function(e){return this.props.item.ALB_ID!==e.item.ALB_ID||this.props.item.ALB_TITLE!==e.item.ALB_TITLE},render:function(){var e;return e=0===this.props.item.ALB_ID?this.props.item.ALB_TITLE:s.createElement("a",{className:"evt-click",href:"/album/"+this.props.item.ALB_ID},this.props.item.ALB_TITLE),s.createElement("div",{className:"wrapper ellipsis"},e)}});t.exports=n},{"../../../../../core/i18n":245,react:"react"}],74:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../../core/i18n"),i=r.gettext,n=s.createClass({displayName:"AddDate",propTypes:{item:s.PropTypes.object.isRequired},statics:{label:i("Ajouté"),className:"added",sort:function(e,t){return e.DATE_ADD-t.DATE_ADD}},getInitialState:function(){return{time:this._calculateTime(this.props.item.DATE_ADD)}},componentDidMount:function(){this.updateInterval=setInterval(this._updateTime,1e3)},shouldComponentUpdate:function(e,t){return this.state.time!==t.time},componentWillUnmount:function(){clearInterval(this.updateInterval)},updateInterval:null,render:function(){return s.createElement("div",{className:"wrapper ellipsis",title:this.state.time},this.state.time)},_calculateTime:function(e){return 0===e?"-":getAgoTime(window.SERVER_TIMESTAMP-e)},_updateTime:function(){window.SESSION_DURATION%30===0&&this.setState({time:this._calculateTime(this.props.item.DATE_ADD)})}});t.exports=n},{"../../../../../core/i18n":245,react:"react"}],64:[function(e,t,a){"use strict";var s=e("react"),r=e("classnames"),i=e("react-addons-pure-render-mixin"),n=s.createClass({displayName:"Header",propTypes:{cells:s.PropTypes.object.isRequired,options:s.PropTypes.object.isRequired,sortCell:s.PropTypes.string,sortOrder:s.PropTypes.string,onSort:s.PropTypes.func.isRequired},mixins:[i],render:function(){for(var e=[s.createElement("th",{key:"first",className:"first"})],t=0,a=this.props.options.cells.length;a>t;t++)e.push(this._renderHeader(this.props.options.cells[t]));return e.push(s.createElement("th",{key:"last",className:"last"})),s.createElement("thead",null,s.createElement("tr",null,e))},_renderHeader:function(e){if("undefined"==typeof this.props.cells[e])return null;var t=this.props.cells[e],a={sortable:"function"==typeof t.sort};a[t.className?t.className:e]=!0,a=r(a);var i=this.props.onSort&&this.props.cells[e].sort?this._onSort.bind(this,e):void 0;return s.createElement("th",{key:e,className:a,onClick:i},this._renderLabel(e))},_renderLabel:function(e){return this.props.cells[e].label?s.createElement("span",{className:"label"},this.props.cells[e].label,this._renderSortIcon(e)):null},_renderSortIcon:function(e){if("function"!=typeof this.props.cells[e].sort)return null;var t=r({sort:!0,"sort-asc":this.props.sortCell===e&&"asc"===this.props.sortOrder,"sort-desc":this.props.sortCell===e&&"desc"===this.props.sortOrder});return s.createElement("span",{className:t},s.createElement("span",{className:"icon icon-sort"}),s.createElement("span",{className:"icon icon-sort-asc"}),s.createElement("span",{className:"icon icon-sort-desc"}))},_onSort:function(e){this.props.onSort(e)}});t.exports=n},{classnames:"classnames",react:"react","react-addons-pure-render-mixin":"react-addons-pure-render-mixin"}],63:[function(e,t,a){"use strict";var s=e("react"),r=e("../../../../core/i18n"),i=r.ngettext,n=s.createClass({displayName:"DragImage",propTypes:{items:s.PropTypes.array},defaultImage:window.SETTING_DOMAIN_IMG+"/cover/d41d8cd98f00b204e9800998ecf8427e/30x30-000000-80-0-0.jpg",styles:{position:"fixed",zIndex:-1},render:function(){return null===this.props.items?this._renderPlaceholder():1===this.props.items.length?this._renderDragImageSingle():this._renderDragImageMultiple()},_renderPlaceholder:function(){return s.createElement("div",{className:"datagrid-ghost",id:"naboo_datagrid_ghost_single",style:this.styles},s.createElement("img",{className:"picture",src:this.defaultImage}))},_renderDragImageSingle:function(){var e=this.props.items[0],t=e.RANK_SNG/1e5;return s.createElement("div",{"aria-grabbed":!0,"aria-dropeffect":"move",className:"datagrid-ghost",id:"naboo_datagrid_ghost_single",style:this.styles},s.createElement("div",{className:"wrapper-table"},s.createElement("span",{className:"cell cell-thumbnail"},s.createElement("figure",{className:"thumbnail thumbnail-bordered"},s.createElement("img",{className:"picture",src:this.defaultImage}))),s.createElement("span",{className:"cell cell-track"},s.createElement("div",{className:"ellipsis"},s.createElement("strong",null,e.SNG_TITLE)),s.createElement("div",{className:"ellipsis"},e.ALB_TITLE)),s.createElement("span",{className:"cell cell-length"},window.secToMin(e.DURATION)),s.createElement("span",{className:"cell cell-popularity"},s.createElement("span",{className:"note note-"+Math.round(t)}))))},_renderDragImageMultiple:function(){var e=this.props.items.length;return s.createElement("div",{"aria-grabbed":!0,"aria-dropeffect":"move",className:"datagrid-ghost multiple",id:"naboo_datagrid_ghost_multi",style:this.styles},s.createElement("div",{className:"wrapper-table"},s.createElement("span",{className:"cell cell-thumbnail"},s.createElement("figure",{className:"thumbnail thumbnail-bordered"},s.createElement("img",{className:"picture",src:this.defaultImage}))),s.createElement("span",{className:"cell"},s.createElement("strong",null,e+" "+i("titre","titres",{count:e})))))}});t.exports=n},{"../../../../core/i18n":245,react:"react"}],62:[function(e,t,a){"use strict";var s=e("react"),r=s.createClass({displayName:"colgroup",propTypes:{cells:s.PropTypes.object.isRequired,options:s.PropTypes.object.isRequired},render:function(){for(var e,t,a=[s.createElement("col",{key:"first",className:"first"})],r=0,i=this.props.options.cells.length;i>r;r++)e=this.props.options.cells[r],t=this.props.cells[e]&&this.props.cells[e].className?this.props.cells[e].className:e,a.push(s.createElement("col",{key:e,className:t}));return a.push(s.createElement("col",{key:"last",className:"last"})),s.createElement("colgroup",null,a)}});t.exports=r},{react:"react"}],253:[function(e,t,a){"use strict";var s=e("jquery"),r=e("../core/i18n"),i=r.gettext,n=r.ngettext,o={id:0,data:[],template:"catalog/album",display:function(e){try{return"string"!=typeof e.alb_id?!1:(o.id=o.alb_id=parseInt(e.alb_id,10),"object"==typeof e.data?void Events.ready(Events.user.initialized,function(){o.displayCallback(e.data)}):(api.call("deezer.pageAlbum",{alb_id:o.id,lang:SETTING_LANG,tab:0},o.displayCallback),!0))}catch(t){error.log(t)}},displayCallback:function(e){try{if(templating.load(o.template),"object"==typeof e.DATA.FALLBACK)return loadBox("/album/"+e.DATA.FALLBACK.ALB_ID),!1;o.data=e.DATA;var t={track:{selected:!0,args:{type:"album",id:e.DATA.ALB_ID}},related_playlist:{args:{type:"album",id:e.DATA.ALB_ID}},fan:{args:{type:"album",id:e.DATA.ALB_ID}},related:{args:{art_id:e.DATA.ART_ID}},discography:{args:{art_id:e.DATA.ART_ID,page:"album"}},edito:{disabled:!0,args:{id:e.DATA.ALB_ID}}};s("#naboo_album_title").text(e.DATA.ALB_TITLE),s("#naboo_album_image").replaceWith(thumbnails.draw({id:o.id,art_id:o.data.ART_ID,type:"album",cover_type:"cover",pic_id:e.DATA.ALB_PICTURE,play:1,play_context:"album_page",border:!0,width:200,height:200,tracking:1,sent_to_mobile_banner:!0,release_date:e.DATA.PHYSICAL_RELEASE_DATE,play_force:!0,context_menu_excludes:["go_to_album"],zoom_on_cover:!0}));var a=[],r={};if("undefined"!=typeof e.DATA.ARTISTS&&e.DATA.ARTISTS.length>0){var l=s("#naboo_album_artist_modele").clone().removeAttr("id");s("#naboo_album_artist_modele").remove();for(var c=s("<p></p>"),p=0;p<e.DATA.ARTISTS.length;p++)if(0==e.DATA.ARTISTS[p].ROLE_ID||5==e.DATA.ARTISTS[p].ROLE_ID){var d=l.clone();d.attr("href","/artist/"+e.DATA.ARTISTS[p].ART_ID).text(e.DATA.ARTISTS[p].ART_NAME),a.push(e.DATA.ARTISTS[p].ART_NAME),0==e.DATA.ARTISTS[p].ROLE_ID&&(r[e.DATA.ARTISTS[p].ART_ID]=!0),p>0&&c.append(s("<span>, </span>")),c.append(d)}s("#naboo_album_artist").html(c.children())}else a.push(e.DATA.ART_NAME),s("#naboo_album_artist_modele").text(e.DATA.ART_NAME).attr("href","/artist/"+e.DATA.ART_ID);Events.subscribeOnce(Events.navigation.tab_displayed,function(){s("#naboo_album_heading").height()>135&&(s("#naboo_catalog_heading").addClass("extended"),s("#naboo_album_action").addClass("album-full-infos"))}),Events.subscribe(Events.user.addFavorite,o.updateNbFan),Events.subscribe(Events.user.deleteFavorite,o.updateNbFan),null!=e.DATA.PHYSICAL_RELEASE_DATE&&"0000-00-00"!=e.DATA.PHYSICAL_RELEASE_DATE&&s('#naboo_album_info > [data-target="date"] > strong').text(formatDate(e.DATA.PHYSICAL_RELEASE_DATE)),e.DATA.NB_FAN>0&&(s('#naboo_album_info > [data-target="fans"] > a > strong').text(breakUpThousands(e.DATA.NB_FAN)),s('#naboo_album_info > [data-target="fans"] > a').append(n("Fan","Fans",{count:e.DATA.NB_FAN})));var u=s("#naboo_album_review");if(e.CHRONICLES.count>0){t.edito.disabled=!1;for(var h in e.CHRONICLES.data)if(e.CHRONICLES.data.hasOwnProperty(h)){var m=e.CHRONICLES.data[h],_=m.LOGO_BIG.split(".");s('[data-target="logo"]',u).append('<a href="javascript:void(0)" class="review-logo" onclick="album.onOpenTab(\'edito\', \''+m.SOURCE+'\');"><img src="'+SETTING_STATIC+"/img/review/big/"+_[0]+"-v"+STATIC_VERSION+"."+_[1]+'"/></a>')}1==e.CHRONICLES.count?s('[data-target="text"]',u).prepend(e.CHRONICLES.data[0].RESUME):(s('[data-target="text-link"]',u).remove(),s('[data-target="text"]',u).text(i("Découvrez les chroniques :")).parent().removeClass("has-readmore"),s('[data-target="logo"]',u).addClass("multi-review")),s("#tab_edito_link > a").text(n("Chronique","Chroniques",{count:e.CHRONICLES.count}))}else u.hide();s("#naboo_album_favorite").html(button_multi_state.draw({action:"favorite",type:"album",id:o.id,elId:"add_to_library"})),s("#naboo_album_legal").text(e.DATA.PHYSICAL_RELEASE_DATE.substr(0,4)+" | "+e.DATA.LABEL_NAME),s("#naboo_album_share > button").data("id",e.DATA.ALB_ID);var y=[],g=0,f={data:[],count:0,total:0},b=0;if(null!=e.SONGS&&null!=e.SONGS.count&&e.SONGS.count>0){for(var v in e.SONGS.data)if(e.SONGS.data.hasOwnProperty(v)){var E=e.SONGS.data[v];g=parseInt(E.DISK_NUMBER,10)-1;var T=parseInt(E.TRACK_NUMBER,10)-1;"undefined"==typeof y[g]&&(y[g]=[]),("undefined"==typeof y[g][T]||right.checkSongAvailable(E)===right.READABLE)&&(y[g][T]=E,b+=parseInt(E.DURATION,10))}g=y.length;for(var S in y)if(y.hasOwnProperty(S))for(T in y[S])y[S].hasOwnProperty(T)&&f.data.push(y[S][T]);f.count=f.total=f.data.length,Events.trigger(Events.album.noReplaceNeed,{id:parseInt(e.DATA.ALB_ID,10),type:"empty"})}else Events.trigger(Events.album.checkReplace,{id:parseInt(e.DATA.ALB_ID,10),type:"empty"});return s("#naboo_album_tracks").createDatagrid({type:"album",id:e.DATA.ALB_ID,songs:f,disk_number:g,art_id:e.DATA.ART_ID,scrollInfinite:!1,main_artist_hash:r,offline_data:{alb_name:e.DATA.ALB_TITLE,alb_artist:e.DATA.ART_NAME,alb_rewriting:e.DATA.URL_REWRITING,alb_picture:e.DATA.ALB_PICTURE}}),s('#naboo_album_info > [data-target="duration"] > strong').text(getTotalDuration(b)),tabs.init(s("#naboo_album_tabs"),t),naboo.afterLoad(!0),!0}catch(A){error.log(A)}},updateNbFan:function(e,t){return t.id!=o.alb_id?!1:("USER.addFavorite"===e.namespace?o.data.NB_FAN+=1:o.data.NB_FAN-=1,void s('#naboo_album_action [data-target="fans"] > a').html(n("%s Fan","%s Fans",{count:o.data.NB_FAN,sprintf:["<strong>"+breakUpThousands(o.data.NB_FAN)+"</strong>"]})))},onOpenTab:function(e,t){tabs.display(e),"undefined"!=typeof t&&window[e].onDisplay(t),s("#page_content").scrollTop(0)},getLiveFeed:function(){return"1_0_ALBUMFEED_"+o.id}};t.exports=o},{"../core/i18n":245,jquery:"jquery"}]},{},[3]);;
(function(){'use strict';if(window.PLATFORM==='web'){var detectFlashCallback=function(){var player=document.getElementById('audioPlayerSWF');util.detectFlash(player,function(err){if(err){modal.open('/lightbox/flash_detect?type='+
encodeURIComponent(err)+'&browser='+encodeURIComponent(BrowserDetect.browser)+'&os='+encodeURIComponent(BrowserDetect.OS),true);}else{Events.unsubscribe(Events.player.play,detectFlashCallback);$('.page-sidebar').off('click',detectFlashCallback);$(document).off('click','#flash_detect a');}});};$(window).load(function(){setTimeout(function(){$(document).on('click','#flash_detect a',function(){var type=$(this).data('type');var clickType=$(this).data('click-type');if(type&&clickType){tracking.track('navigation',{event:'onClick',properties:{notification:'flash_detect',message:type}});}
modal.close();});Events.subscribe(Events.player.play,detectFlashCallback);$('.page-sidebar').on('click',detectFlashCallback);detectFlashCallback();},5000);});}})();;
var biography={display:function(args){if(artist.data.BIO===false){return false;}
var content=$('#tab_biography_content');$('[data-target="intro"]',content).html(artist.data.BIO.RESUME);$('[data-target="title"]',content).html(artist.data.DATA.ART_NAME);$('[data-target="text"]',content).html(artist.data.BIO.BIO);Events.trigger(Events.navigation.tab_displayed,{type:args.type,id:args.id});}};;
var lyrics={display:function(args){api.call({method:'song.getLyrics',data:{SNG_ID:args.sng_id},success:function(data){var container=$('#tab_lyrics_content');var lyricsData=data.LYRICS_TEXT.split(/\r\n|\r|\n/g);var fragment=document.createDocumentFragment();var para;var lyric;for(var i=0,len=lyricsData.length;i<len;i++){lyric=lyricsData[i];para=document.createElement('p');para.innerHTML=lyric||'&nbsp;';fragment.appendChild(para);}
$('.lyrics-content',container).append(fragment);$('.copyrights',container).html(data.LYRICS_COPYRIGHTS);$('.writers',container).html(data.LYRICS_WRITERS);var btn=$('.btn-karaoke',container);btn.on('click',function(){if(dzPlayer.getPlayerType()!=='ads'){if(dzPlayer.getCurrentSong('SNG_ID')!==args.sng_id){dzPlayer.play({id:args.sng_id,type:'track'});Events.subscribeOnce(Events.player.play,function(){Events.trigger(Events.menu.openPanel,'lyrics');});}else{Events.trigger(Events.menu.openPanel,'lyrics');}}});if(data.LYRICS_SYNC_JSON&&data.LYRICS_SYNC_JSON.length){btn.addClass('has-sync');}else{btn.addClass('has-text');}
btn.removeClass('hide');Events.trigger(Events.navigation.tab_displayed,args);lyrics.log({action:{type:'display'},container:'page_track',sng:args.sng_id,ts:SERVER_TIMESTAMP,type:(data.LYRICS_SYNC_JSON&&data.LYRICS_SYNC_JSON.length)?'synchro':'full_text'});}});return true;},log:function(params){api.call({method:'log_central.log',data:{BATCH:[{channel:'lyrics',params:params}]}});}};;
if(typeof comment=='undefined'){var comment={type_id:{artist:1,album:2,user:3,playlist:4,radio:5,video:6},remove:function(data,callback){if(typeof data!=='object'){return false;}
var type_id=comment.type_id[data.type]||0;api.call({method:'comment.delete',data:{comment_id:data.id,type:type_id,element_id:data.elementId},success:callback});},flag:function(data,callback){if(typeof data!=='object'){return false;}
var type_id=comment.type_id[data.type]||0;api.call({method:'comment.flag',data:{comment_id:data.id,type:type_id},success:callback});},post:function(data,callback){if(typeof data!=='object'){return false;}
var type_id=comment.type_id[data.type]||0;api.call({method:'comment.add',data:{comment:data.comment_txt,element_id:data.element_id,type:type_id,lang:SETTING_LANG},success:callback});},display:function(data,callback){if(typeof data!=='object'){return false;}
var type_id=comment.type_id[data.type]||0;api.call({method:'comment.getList',data:{element_id:data.element_id,type:type_id,start:data.start,nb:data.nb},success:callback});},getData:function(data,callback){if(typeof data!=='object'){return false;}
api.call({method:'comment.getData',data:{comment_id:data.comment_id},success:callback});}};};
(function(){'use strict';var replace={sng_id:0,div:'',playlist_id:0,songs_list:[],current_selected_id:0,init:function(sng_id,playlist_id,songs,div){try{replace.sng_id=sng_id;replace.playlist_id=playlist_id;replace.songs_list=songs;replace.div=div;window.setTimeout(function(){$('#hovercard_content_tracks').tinyscrollbar();},100);return true;}catch(e){error.log(e);}},replaceTrack:function(){try{if(replace.current_selected_id===0||typeof replace.sng_id==='undefined'||typeof replace.playlist_id==='undefined'){return false;}
var params={new_sng_id:replace.current_selected_id,old_sng_id:replace.sng_id,playlist_id:replace.playlist_id};api.call('playlist.recoverSong',params,replace.replaceTrackCallback);return true;}catch(e){error.log(e);}},replaceTrackCallback:function(result){try{if(result===true){window.track_list.component.replaceItem(replace.sng_id,replace.getNewSongInfo(Number(replace.current_selected_id)));hovercard.remove();}
return true;}catch(e){error.log(e);}},deleteTrack:function(){try{if(confirm(gettext('Voulez-vous vraiment effacer ce morceau ?'))){if(typeof replace.sng_id==='undefined'){return false;}
if(typeof replace.playlist_id==='undefined'){return false;}
api.call('playlist.deleteSongs',{playlist_id:replace.playlist_id,songs:[[replace.sng_id,0]]},replace.deleteTrackCallback);}
return true;}catch(e){error.log(e);}},deleteTrackCallback:function(result){try{if(result===true){window.track_list.component.removeItems([replace.sng_id]);hovercard.remove();userData.removePlaylistSong(replace.playlist_id,[{SNG_ID:replace.sng_id}]);}
return true;}catch(e){error.log(e);}},getNewSongInfo:function(sngId){try{if(replace.songs_list===0){return false;}
for(var t=0;t<replace.songs_list.length;t++){if(Number(replace.songs_list[t].SNG_ID)===Number(sngId)){return replace.songs_list[t];}}
return true;}catch(e){error.log(e);}},play:function(sngId){try{dzPlayer.play({data:[replace.getNewSongInfo(sngId)]});return true;}catch(e){error.log(e);}},selectTrack:function($line){try{replace.current_selected_id=$line.attr('data-id');$line.parents('dl').parent().children('dl').removeClass('selected');$line.parents('dl').addClass('selected');$('#hovercard_replace_button').show();return true;}catch(e){error.log(e);}}};window.replace=replace;})();;
if(typeof placeholder=='undefined'){var placeholder={draw:function(options){if(typeof options!=='object'){return false;}
var returnFormat='object';if(typeof options.hash==='undefined'){returnFormat='string';options={hash:options};}
var data={picture:options.hash.picture||'nocontent',wording:options.hash.wording||'Wording'};var generatePlaceholder=new Handlebars.SafeString(Handlebars.templates['placeholder'](data));return(returnFormat==='string')?generatePlaceholder.string:generatePlaceholder;}};};
(function($){$.grid=$.grid||{};$.grid.datagrid={template:{option:{},track:{},header:{},colgroup:{}},options:{songs:0,type:"",id:0,checksum:"",skin:{},disk_number:0,selectable:true,playlist_private:false,playlist_personnal:false,art_id:0,externalLoadingDataClass:'',autoplay:false,allowMoveToPlaylist:true,scrollInfinite:true,scrollAutoOnAir:false,main_artist_hash:{},offline_data:{},event_group:'datagrid'},skinDefault:{displayLovedColumn:true,displayPlayColumn:true,displaySongColumn:true,displayArtistColumn:true,displayAlbumColumn:true,displayDurationColumn:true,displayNoteColumn:true,displayCheckColumn:true,displayDateColumn:false,displayListenColumn:false,displayDownloadColumn:false,displaySongNumber:false,displayOrderNumber:false,displayCdNumber:false,displayHeader:true,displayOptionsToggle:true,displayFilter:true,displayEdit:false,displayListen:true,displaySyncOffline:(BrowserDetect.OS==='Mac'||BrowserDetect.OS==='Windows'),displayRemove:false,displayOrder:false,displayAdd:true,displayPlaylistAssistant:false,displayHistoric:false,displayPlaylistAdd:true,displaySubresult:false,displayDownload:false,displayExtendBackground:true,displaySelectAll:false,displayLoved:true,displayMultiArtistSong:false,displayFallbackIcon:false,backgroundColor:'',displayOptionPosition:'top',displayFanOnly:'hovercard',reverseBackgroundColor:false,reverseColor:false,rightClic:true},skinType:{'playlist':{displayNoteColumn:false,displayDateColumn:true,displayPlaylistAssistant:true},'history':{displaySyncOffline:false,displayHistoric:false,displayNoteColumn:false,displayListenColumn:true},'lovedpersonal':{displaySyncOffline:false,displayDateColumn:true,displayNoteColumn:false},'loved':{displaySyncOffline:false,displayDateColumn:false,displayNoteColumn:true},'search':{displaySubresult:true,displaySyncOffline:false,displayListen:false,displayFilter:false},'personal_song':{displayEdit:true,displaySyncOffline:false,displayRemove:true,displayNoteColumn:false},'downloads':{displayNoteColumn:false,displayDownloadColumn:true,displaySyncOffline:false,displayDownload:true,displayPlaylistAdd:false},'album':{displayArtistColumn:false,displayAlbumColumn:false,displaySongNumber:true,displayCdNumber:true,displayHeader:false,displayFilter:false,displayExtendBackground:false,displaySelectAll:true,displayMultiArtistSong:true,displayFallbackIcon:true},'artist_top':{displaySyncOffline:false,displayHeader:false,displayListen:false,displayFilter:false,displayArtistColumn:false,displayAlbumColumn:false,displayOrderNumber:true,displayMultiArtistSong:true,displayExtendBackground:false,displayOptionPosition:'hide',displayNoteColumn:false,displayCheckColumn:false,displayFanOnly:'text',reverseBackgroundColor:true},'artist_exclu':{displaySyncOffline:false,displayHeader:false,displayListen:false,displayFilter:false,displayArtistColumn:false,displayAlbumColumn:false,displayOrderNumber:true,displayExtendBackground:false,displayOptionPosition:'hide',displayNoteColumn:false,displayCheckColumn:false,displayFanOnly:'text',reverseBackgroundColor:true},'discography_album':{displaySyncOffline:false,displayHeader:false,displayListen:false,displayFilter:false,displayArtistColumn:false,displayAlbumColumn:false,displaySongNumber:true,displayCdNumber:true,displayExtendBackground:false,displayOptionPosition:'bottom',displayMultiArtistSong:true,displayFallbackIcon:true,displayOptionsToggle:false,reverseBackgroundColor:true,backgroundColor:'datagrid-white'}}};$.fn.createDatagrid=function(options){if(typeof $(this).data('dgd')=='undefined'){var options=$.extend({},$.grid.datagrid.options,options);this.each(function(){$(this).data('dgd',new Datagrid($(this),options));});return this;}};$.fn.actionDatagrid=function(params){try{if(typeof $(this).data('dgd')[params[0]]=='function'){return $(this).data('dgd')[params[0]].apply(this,Array.prototype.slice.call(params,1));}else{console.log('La method n existe pas:',params[0]);}}catch(e){error.log(e);}};$.fn.getData=function(param){try{return $(this).data('dgd').getData(param);}catch(e){error.log(e);}};$.fn.destroy=function(){try{$(this).data('dgd')['unsubscribe']();$(this).empty().removeClass('datagrid_master').removeClass('datagrid_'+$(this).data('dgd').getData('type'));$(this).removeData('dgd');}catch(e){error.log(e);}};function Datagrid(root,options){var oSelf=this;var oWrapper=root;var oDatagrid=null;var oBody=null;var oTable=null;var oHead=null;var oOption=null;var oColGroup=null;var isDisplay=false;var currentDisk=0;var filterInterval=300;var filterId=0;var filterActif=false;var filterResult=[];var unavailableList=[];var waitingAllTrackForDownload=false;var waitingAllTrackForFilter=false;var waitingAllTrackForReplaceProcess=false;var waitingAllTrackForTotalPlay=false;var waitingAllTrackForSort=false;var creationStartIndex=0;var creationEndIndex=0;var creationGroup=40;var creationInterval=100;var loadGroup=0;var removedTrackBeforeLoadComplete=0;var resizeStartIndex=0;var resizeEndIndex=0;var resizeGroup=40;var resizeInterval=50;var filterLabel='';var resizeMinPercent=8;var orderableBar=null;var cache_dom={};var lastColSort=false;var lastSort={};var artistOnlyEvent=false;var lastOnAirTrack=false;var favoriteSongEvent=false;var progressBar=null;var currentTrackNumber=0;var previousHierarchicalTitle='';var pageContent='';var scrollInterval=0;var contributor_model='';var upload_model='';var artist_model=$('<a class="evt-click" href=""></a>');var offline_mobile_model='';var offline_tablet_model='';var gridTrad={downloads:gettext('Rechercher dans mes achats'),playlist:gettext('Rechercher dans la playlist'),personal_song:gettext('Rechercher dans mes MP3'),folder:gettext('Rechercher dans le dossier'),loved:gettext('Rechercher parmi les titres'),loved_personal:gettext('Rechercher parmi les titres'),history:gettext('Rechercher dans l\'historique')};function create(){try{oWrapper.empty();templating.load('naboo/components/datagrid',oWrapper);if(USER.USER_ID===0){oSelf.initialize();return false;}
Events.ready(Events.user.userReady,function(){oSelf.initialize();});}catch(e){error.log(e);}};this.getData=function(param){return options[param];};this.initialize=function(){try{oWrapper.addClass('datagrid_master').css('height','auto');oDatagrid=$('.datagrid',oWrapper);oTable=$('.datagrid > table',oWrapper);oBody=$('.datagrid > table > tbody',oWrapper);oHead=$('.datagrid > table > thead',oWrapper);oColGroup=$('.datagrid > table > colgroup',oWrapper);oOption=$('#naboo_datagrid_options',oWrapper);pageContent=$('#page_content');isDisplay=true;if(options.songs.total==0){options.songs.count=0;options.songs.data=[];}
Events.subscribe(Events.player.displayCurrentSong,oSelf.displayPlayingTrack);Events.subscribe(Events.player.playing,oSelf.displayPlayingIcon);Events.subscribe(Events.player.finishTrackList,oSelf.displayPlayingIcon);if(USER.USER_ID!=0){Events.ready(Events.user.userReady,function(){Events.subscribe(Events.user.addFavorite,oSelf.displayChangeFavoriteTrack);Events.subscribe(Events.user.deleteFavorite,oSelf.displayChangeFavoriteTrack);});}
if(typeof $.grid.datagrid.skinType[options.type]=='object'){options.skin=$.extend(true,{},$.grid.datagrid.skinDefault,$.grid.datagrid.skinType[options.type]);if(options.type=='playlist'||options.type=='lovedpersonal'){options.skin.displayRemove=options.skin.displayOrder=options.skin.displayDateColumn=options.playlist_personnal;options.skin.displayNoteColumn=!options.playlist_personnal;options.skin.displayExtendBackground=!(options.playlist_personnal&&options.skin.displayPlaylistAssistant&&options.songs.total===0);}else if(options.type=='artist_exclu'){oSelf.subscribeEventFanOnly();}}else{options.skin=$.grid.datagrid.skinDefault;}
if(options.skin.reverseColor){oDatagrid.addClass('datagrid-inverse');}
oSelf.templateHeader();oSelf.templateOption();oSelf.templateOtherElements();oSelf.templateLineTrack();if(options.skin.displayHeader){oSelf.setHeaderColumnSize();}
if(options.songs.total==0){options.songs.count=0;options.songs.data=[];}
if(options.playlist_private){$("#naboo_datagrid_private",oWrapper).show();oTable.remove();oOption.remove();options.songs.total=0;options.songs.count=0;options.songs.data=[];}else{$("#naboo_datagrid_private",oWrapper).remove();}
if(OFFLINE){options.selectable=false;options.skin.displayRemove=false;$('[data-target="checkall"]',oHead).hide();}
if(options.skin.displayHeader){oDatagrid.addClass('datagrid-header');}
if(options.skin.reverseBackgroundColor&&options.disk_number<2){oDatagrid.addClass('datagrid-alt');}
if(options.skin.backgroundColor!=''){oDatagrid.addClass(options.skin.backgroundColor);}
loadGroup=1;creationStartIndex=0;if(options.skin.displayCdNumber){var songsCleaner=[];for(var i in options.songs.data){if(!options.songs.data.hasOwnProperty(i)){continue;}
if(options.songs.data[i]!==null){songsCleaner.push(options.songs.data[i]);}}
options.songs.data=songsCleaner;options.songs.total=songsCleaner.length;options.songs.count=songsCleaner.length;}
oSelf.createDatagridLines();if(options.skin.rightClic){oDatagrid.bind('contextmenu',function(){return false;});;oSelf.rightClic(oBody);}
if(options.autoplay){Events.ready(Events.player.playerReady,function(){oSelf.play();});}
Events.subscribe(Events.playlist.addSong,oSelf.liveAddSong);Events.trigger(Events.datagrid.displayed,{type:options.type,id:options.id,start:0});return oSelf;}catch(e){error.log(e);}};this.templateHeader=function(){try{if($.grid.datagrid.template.header[options.type]!=null&&$.grid.datagrid.template.colgroup[options.type]!=null){if(!options.skin.displayHeader){oHead.remove();}else{oHead.empty();oHead.show();oHead.append($.grid.datagrid.template.header[options.type].clone());}
oColGroup.empty();oColGroup.append($.grid.datagrid.template.colgroup[options.type].clone());oSelf.setHeaderLink();return true;}
if(!options.skin.displayLovedColumn){$('.loved',oHead).remove();$('.loved',oColGroup).remove();}
if(!options.skin.displayPlayColumn){$('.position',oHead).remove();$('.position',oColGroup).remove();}
if(!options.skin.displaySongColumn){$('.track',oHead).remove();$('.track',oColGroup).remove();}
if(!options.skin.displayArtistColumn){$('.artist',oHead).remove();$('.artist',oColGroup).remove();}
if(!options.skin.displayAlbumColumn){$('.album',oHead).remove();$('.album',oColGroup).remove();}
if(!options.skin.displayDurationColumn){$('.length',oHead).remove();$('.length',oColGroup).remove();}
if(!options.skin.displayNoteColumn){$('.popularity',oHead).remove();$('.popularity',oColGroup).remove();}
if(!options.skin.displayDateColumn){$('.added',oHead).remove();$('.added',oColGroup).remove();}
if(!options.skin.displayListenColumn){$('.listen',oHead).remove();$('.listen',oColGroup).remove();}
if(!options.skin.displayDownloadColumn){$('.download',oHead).remove();$('.download',oColGroup).remove();}
if(!options.skin.displayCheckColumn){$('.check',oHead).remove();$('.check',oColGroup).remove();}
if(!options.skin.displayHeader){oHead.remove();}else{oHead.show();}
$.grid.datagrid.template.header[options.type]=$('tr',oHead).clone();$.grid.datagrid.template.colgroup[options.type]=$('col',oColGroup).clone();oSelf.setHeaderLink();}catch(e){error.log(e);}};this.templateOption=function(){try{if(($.grid.datagrid.template.option[options.type])!=null){$("#naboo_datagrid_options",oDatagrid).remove();if(options.skin.displayOptionPosition=='bottom'){oDatagrid.append($.grid.datagrid.template.option[options.type].clone());}else if(options.skin.displayOptionPosition=='top'){oDatagrid.prepend($.grid.datagrid.template.option[options.type].clone());}
oOption=$('#naboo_datagrid_options',oDatagrid);oSelf.setOptionLink();return true;}
if(options.skin.displayFilter){$('#naboo_datagrid_filter',oOption).show();oSelf.setFilterLabel();}else{$('#naboo_datagrid_filter',oOption).remove();}
if(options.skin.displayListen){$('#naboo_datagrid_listen',oOption).show();}else{$('#naboo_datagrid_listen',oOption).remove();}
if(options.skin.displaySyncOffline){$('#naboo_datagrid_offline',oOption).show();$('#naboo_datagrid_offline [data-target="offline-mobile"]',oOption).attr('data-tooltip',gettext('sur %s',{sprintf:[gettext('mon mobile')]}));$('#naboo_datagrid_offline [data-target="offline-tablet"]',oOption).attr('data-tooltip',gettext('sur %s',{sprintf:[gettext('ma tablette')]}));}else{$('#naboo_datagrid_offline',oOption).remove();}
if(options.skin.displayPlaylistAssistant&&options.playlist_personnal){$('#naboo_datagrid_add_track',oOption).show();}else{$('#naboo_datagrid_add_track',oOption).hide();}
if(options.skin.displaySelectAll&&!options.skin.displayHeader){$('#naboo_datagrid_select_all',oOption).show();}else{$('#naboo_datagrid_select_all',oOption).remove();}
if(!options.skin.displayDownload){$('#naboo_datagrid_download',oOption).remove();}
if(!options.skin.displayAdd){$('#naboo_datagrid_add',oOption).remove();}
if(!options.skin.displayRemove){$('#naboo_datagrid_remove',oOption).hide();}
$.grid.datagrid.template.option[options.type]=$('#naboo_datagrid_options',oDatagrid).clone();$('#naboo_datagrid_options',oDatagrid).remove();if(options.skin.displayOptionPosition=='bottom'){oDatagrid.append($.grid.datagrid.template.option[options.type].clone());}else if(options.skin.displayOptionPosition=='top'){oDatagrid.prepend($.grid.datagrid.template.option[options.type].clone());}
if(options.skin.displayOptionPosition!='hide'){oOption=$('#naboo_datagrid_options',oDatagrid);}
oSelf.setOptionLink();}catch(e){error.log(e);}};this.templateLineTrack=function(){try{if(($.grid.datagrid.template.track[options.type])!=null){options.$line_model=$.grid.datagrid.template.track[options.type];$("tr",oBody).remove();return true;}
options.$line_model=$(".song",oBody).show();$(".song",oBody).remove();if(!options.skin.displayLoved){$('.loved',options.$line_model).remove();}
if(!options.skin.displayPlayColumn){$('.position [data-target="play"]',options.$line_model).remove();}
if(!options.skin.displaySongNumber&&!options.skin.displayOrderNumber){$('.position [data-target="position"]',options.$line_model).remove();}
if(!options.skin.displaySongColumn){$('.track',options.$line_model).remove();}else{if(!options.skin.displayMultiArtistSong){$('.track [data-target="featuring"]',options.$line_model).remove();}
if(!options.skin.displayEdit){$('.track [data-target="icon-edit"]',options.$line_model).remove();}
if(!options.skin.displaySubresult){$('.track [data-target="icon-similar"]',options.$line_model).remove();}
if(!options.skin.displayHistoric){$('.track [data-target="icon-historic"]',options.$line_model).remove();}}
if(!options.skin.displayArtistColumn){$('.artist',options.$line_model).remove();}
if(!options.skin.displayAlbumColumn){$('.album',options.$line_model).remove();}
if(!options.skin.displayDurationColumn){$('.length',options.$line_model).remove();}
if(!options.skin.displayCheckColumn){$('.check',options.$line_model).css('display','none');}
if(!options.skin.displayNoteColumn){$('.popularity',options.$line_model).remove();}
if(!options.skin.displayDateColumn){$('.added',options.$line_model).remove();}
if(!options.skin.displayListenColumn){$('.listen',options.$line_model).remove();}
if(!options.skin.displayDownloadColumn){$('.download',options.$line_model).remove();}
if(OFFLINE){$('.track [data-target="icon-add"]',options.$line_model).remove();}
$.grid.datagrid.template.track[options.type]=options.$line_model.clone();}catch(e){error.log(e);}};this.templateOtherElements=function(){try{ghost_single_model=$("#naboo_datagrid_ghost_single",oWrapper).clone().removeAttr('id').show();$("#naboo_datagrid_ghost_single",oWrapper).remove();ghost_multi_model=$("#naboo_datagrid_ghost_multi",oWrapper).clone().removeAttr('id').show();$("#naboo_datagrid_ghost_multi",oWrapper).remove();progressBar=$(".progress",oBody).clone().show();$(".progress",oBody).remove();fillerBar=$(".filler",oBody).clone().show();$(".filler",oBody).remove();dividerBar=$(".divider",oBody).clone().show();$(".divider",oBody).remove();if(options.skin.displayCdNumber){$(".caption > td",oBody).attr('colspan',oColGroup.children().length);disk_model=$(".caption",oBody).show().clone();}
$(".caption",oBody).remove();contributor_model=$(".contributors",oBody).show().clone();contributor_model=oSelf.addTdInLine(contributor_model,'.track',{before:true});$(".contributors",oBody).remove();if(options.type=='personal_song'){upload_model=$(".upload",oBody).show().clone();upload_model=oSelf.addTdInLine(upload_model,'.track',{before:true,after:true});}
$(".upload",oBody).remove();}catch(e){error.log(e);}};this.setHeaderLink=function(){try{$('.sortable > .label',oHead).click(function(){oSelf.sort($(this).parents('th'));});$('.check > input',oHead).click(function(){oSelf.selectAll($(this));});}catch(e){error.log(e);}};this.setHeaderColumnSize=function(){try{var lineSize=oHead.width();var trackSize=Math.floor(($('.track',oHead).width()/lineSize)*100);var artistSize=Math.floor(($('.artist',oHead).width()/lineSize)*100);if(trackSize+artistSize>100){trackSize=40;artistSize=20;}
$('.track',oHead).css('width',trackSize+'%');$('.artist',oHead).css('width',artistSize+'%');}catch(e){error.log(e);}};this.setOptionLink=function(){try{$listen=$(button_multi_state.draw({id:options.id,type:(options.type==='lovedpersonal')?'loved':options.type,action:'play',color_equalizer:'dark',wording:'full',play_context:oSelf.getContextName(),enable_delegation:false})).click(function(){$(this).data('cancelHover',true);oSelf.play($(this));});$('#naboo_datagrid_listen',oOption).replaceWith($listen);$('#naboo_datagrid_select_all > input',oOption).click(function(){oSelf.selectAll($(this));});$('#naboo_datagrid_add',oOption).click(function(evt){oSelf.addMusicBox($(this));evt.stopPropagation();}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$('#naboo_datagrid_download',oOption).click(function(){oSelf.storeAction($(this),'download');}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$('#naboo_datagrid_remove',oOption).click(function(){oSelf.removeTrack();}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$('#naboo_datagrid_filter_text',oOption).keyup(function(){oSelf.startFilter(this.value);}).focus(function(){oSelf.onFilterFocus();});$('#naboo_datagrid_filter_clear',oOption).click(function(){$(this).prev().val('').focus();oSelf.startFilter('');});$('#naboo_datagrid_offline [data-target^="offline-"]',oOption).click(function(){oSelf.download($(this));}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});if(options.skin.displayPlaylistAssistant&&(options.playlist_personnal||options.playlist_collab)){$('#naboo_datagrid_add_track',oOption).click(function(){modal.open('/lightbox/playlist_assistant?type=add_song&playlist_id='+options.id);}).show();}else{$('#naboo_datagrid_add_track',oOption).hide();}
if(options.skin.displayPlaylistAssistant&&options.playlist_personnal&&options.songs.total===0){$('#naboo_datagrid_add_track_empty',oWrapper).click(function(){modal.open('/lightbox/playlist_assistant?type=add_song&playlist_id='+options.id);}).show();}else{$('#naboo_datagrid_add_track_empty',oWrapper).hide();}
if(options.skin.displayOptionsToggle){oOption.show();}}catch(e){error.log(e);}};this.setLineLink=function($line){try{$line.dblclick(function(a){if($(a.target).is('i')||$(a.target).is('input')){return false;}
oSelf.play($(this));return false;});$line.find('[data-target="play"]').click(function(){oSelf.play($(this));return false;});$line.find('[data-target="track"]').click(function(){oSelf.play($(this));return false;});$line.find('[data-target="icon-add"]').click(function(){oSelf.addMusicBox($(this));return false;});$line.find('[data-target="icon-contributors"]').click(function(){oSelf.openContributor($(this));return false;}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('[data-target="icon-lyrics"]').click(function(){oSelf.playWithLyrics($(this));}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('[data-target="icon-edit"]').click(function(){modal.open('/lightbox/edit_personal_song.php?sng_id='+$(this).parents('tr').data('song').SNG_ID);return false;}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('[data-target="icon-download"]').click(function(){oSelf.storeAction($(this),'download');return false;}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('[data-target="download-one"]').click(function(){oSelf.storeAction($(this),'download');return false;}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('[data-target="icon-link"]').mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('[data-target="icon-replace"]').click(function(){hovercard.init($(this),0);return false;});$line.find('[data-target="icon-historic"]').click(function(){console.log('TODO : link');return false;}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('[data-target="icon-similar"]').click(function(){oSelf.openSubResult($(this));return false;}).mouseover(function(){oSelf.tipsy($(this),'over')}).mouseout(function(){oSelf.tipsy($(this),'out')});$line.find('.popularity').mouseover(function(){if($(this).attr('data-tooltip')==null){if($(this).parents('tr').data('song').RANK_SNG==null){return false;}
var rank_sng=($(this).parents('tr').data('song').RANK_SNG/100000);$(this).attr('data-tooltip',gettext('Popularité : ')+rank_sng.toFixed(2)+' / 10');}
oSelf.tipsy($(this),'over','e');}).mouseout(function(){if($(this).attr('data-tooltip')!=null){oSelf.tipsy($(this),'out');}});$line.find('[data-target="download-one"]').click(function(){oSelf.storeAction($(this),'download');return false;});$line.find('[data-target="check"]').click(function(){oSelf.selectOne($(this));});}catch(e){error.log(e);}};this.load=function(status,div,id,nb){try{if(creationEndIndex<options.songs.total){start=(loadGroup*creationGroup)-removedTrackBeforeLoadComplete;switch(options.type){case"playlist":var parameters={playlist_id:options.id,lang:SETTING_LANG,start:start,nb:nb,header:false,tags:false};api.call('deezer.pagePlaylist',parameters,oSelf.onLoaded,{nb:nb});break;case"lovedpersonal":case"loved":var parameters={start:start,nb:nb,user_id:options.id};api.call('favorite_song_getList',parameters,oSelf.onLoaded,{nb:nb});break;case"search":var filter='ALL';if(naboo.current_config.args&&naboo.current_config.args.tags){filter='TAG';}
var parameters={query:id,filter:filter,output:'TRACK',start:start,nb:nb};api.call('search.music',parameters,oSelf.onLoaded,{nb:nb});break;case"personal_song":var parameters={start:start,nb:nb};api.call('personal_song.getList',parameters,oSelf.onLoaded,{nb:nb});break;case"downloads":var parameters={start:start,nb:nb,order:7};api.call('store.getList',parameters,oSelf.onLoaded,{nb:nb});break;case"history":var parameters={start:start,nb:nb};api.call('user.getSongsHistory',parameters,oSelf.onLoaded,{nb:nb});break;default:console.log("datagrid.load : unknown type");}}else{if(options.scrollInfinite){infinite_scroll.disable();}}
return true;}catch(e){error.log(e);}};this.loadAllTracks=function(){try{if(options.songs.count<options.songs.total){if(options.scrollInfinite){infinite_scroll.disable();}
oSelf.load(false,"naboo_"+options.type+"_tracks",options.id,creationGroup);}
return true;}catch(e){error.log(e);}};this.onLoaded=function(result,callbackParameters){try{if(!isDisplay){return false;}
loadGroup++;switch(options.type){case"playlist":$.merge(options.songs.data,result.SONGS.data);var nbNewTrack=result.SONGS.count;if(nbNewTrack<callbackParameters.nb)options.songs.total-=(callbackParameters.nb-nbNewTrack);break;case"loved":case"lovedpersonal":$.merge(options.songs.data,result.data);var nbNewTrack=result.count;if(nbNewTrack<callbackParameters.nb)options.songs.total-=(callbackParameters.nb-nbNewTrack);break;case"search":$.merge(options.songs.data,result.data);var nbNewTrack=result.count;if(nbNewTrack<callbackParameters.nb)options.songs.total-=(callbackParameters.nb-nbNewTrack);break;case"downloads":case"personal_song":case"history":$.merge(options.songs.data,result.data);var nbNewTrack=result.count;if(nbNewTrack<callbackParameters.nb)options.songs.total-=(callbackParameters.nb-nbNewTrack);break;}
options.songs.count=options.songs.data.length;if(options.externalLoadingDataClass!=''){if(window[options.externalLoadingDataClass].isAllElementLoaded())
options.songs.total=options.songs.count;}
var oldStartInsert=creationStartIndex;oSelf.createDatagridLines(nbNewTrack);Events.trigger(Events.datagrid.displayed,{type:options.type,id:options.id,start:oldStartInsert});return true;}catch(e){error.log(e);}};this.createDatagridLines=function(addTrack){try{if(creationStartIndex+creationGroup>options.songs.count)creationEndIndex=options.songs.count;else creationEndIndex=creationStartIndex+((typeof addTrack=='undefined')?creationGroup:addTrack);$lines=$('<p></p>');for(j=creationStartIndex;j<creationEndIndex;j++){if(typeof options.songs.data[j].FALLBACK!='undefined'&&typeof options.songs.data[j].FALLBACK.SNG_ID!='undefined'){options.songs.data[j].SNG_ID_ORIGIN=options.songs.data[j].SNG_ID;delete options.songs.data[j].FALLBACK.TRACK_NUMBER;delete options.songs.data[j].FALLBACK.DISK_NUMBER;options.songs.data[j]=$.extend({},options.songs.data[j],options.songs.data[j].FALLBACK);delete options.songs.data[j].FALLBACK.SNG_ID;}
var currentData=options.songs.data[j];if(typeof currentData=='undefined')continue;if(options.skin.displayOrderNumber){currentTrackNumber++;}
if(options.skin.displayCdNumber){if(options.disk_number>1&&currentDisk<currentData.DISK_NUMBER){$disk=disk_model.clone();$('[data-target="cd"]',$disk).text('CD '+currentData.DISK_NUMBER);$lines.append($disk);currentDisk++;}}
var TYPE="";if(options.type!='search'){TYPE="SEARCH_";}
if(cache_dom["SONG_"+currentData.SNG_ID]!=null){$cache_line=$(cache_dom["SONG_"+currentData.SNG_ID]);$lines.append($cache_line);continue;}
$line=options.$line_model.clone();oSelf.setLineLink($line);oSelf.refreshLineContent($line,currentData);cache_dom["SONG_"+currentData.SNG_ID]=$line.removeClass('active').attr('outerHTML');$lines.append($line);}
oSelf.createDatagridDrag($lines.children('.song'));oBody.append($lines.children());creationStartIndex=creationEndIndex;if(creationEndIndex>=options.songs.count){oSelf.createDatagridResize();oSelf.unAvailableDisplay();oSelf.displayPlayingTrack(null,dzPlayer.getCurrentSong());if(waitingAllTrackForDownload)
oSelf.download($('#naboo_datagrid_offline_local',oOption));if(waitingAllTrackForFilter)
oSelf.onFilterFocus();if(waitingAllTrackForTotalPlay)
oSelf.playAllTracks();if(waitingAllTrackForSort)
oSelf.sort(lastSort.link,lastSort.columnIndex);if(creationStartIndex>=options.songs.total){if(options.scrollInfinite){infinite_scroll.disable();}
Events.trigger(Events.datagrid.allTracksDisplayed,{duration:oSelf.getTotalDuration(),nbSong:options.songs.total});}else{oSelf.activeInfiniteScroll();}
oSelf.extendBackground();}else{setTimeout(oSelf.createDatagridLines,creationInterval);}
if(options.skin.displayDateColumn||options.skin.displayListenColumn){calculeTime();}
return true;}catch(e){error.log(e);}};this.loadNextTrack=function(){try{oSelf.load(false,"naboo_"+options.type+"_tracks",options.id,creationGroup);}catch(e){error.log(e);}};this.refreshSongNumber=function(){try{$('tr:visible',oBody).each(function(index,item){$('.position [data-target="position"]',$(item)).text(pad(index+1,2));});}catch(e){error.log(e);}};this.refreshLineContent=function($line,currentData,subResult){try{if(typeof currentData=='undefined')return false;var isDeezerTrack=oSelf.isDeezerTrack(currentData);var isFallbackTrack=(typeof currentData.FALLBACK!='undefined');var sngId=oSelf.getSongId(currentData);var unavailableType=right.checkSongAvailable(currentData);var data={id:"naboo_datagrid_track_"+sngId};if(currentData.SNG_ID<0){data['data-fan-only']=currentData.FAN_ONLY;}
$line.attr(data).removeClass('active');$line.data('song',currentData);var onClikAlbum=(currentData.ALB_ID>0&&!OFFLINE)?"/album/"+currentData.ALB_ID:'';var sngTitle=currentData.SNG_TITLE;if(typeof currentData.VERSION!='undefined'&&currentData.VERSION!=''){sngTitle+=' '+currentData.VERSION;}
if(options.skin.displayMultiArtistSong){oSelf.displayArtistName($('.track [data-target="featuring"]',$line),currentData,options.main_artist_hash);}else{oSelf.displayArtistName($('.artist > div',$line),currentData);}
oSelf.displaySongTitle($('.track [data-target="track"]',$line),currentData);$('.album [data-target="album"]',$line).attr("href",onClikAlbum).text(currentData.ALB_TITLE);if(options.skin.displaySongNumber){var nb=pad(currentData.TRACK_NUMBER,2);$('.position [data-target="position"]',$line).text(nb);}
if(options.skin.displayOrderNumber){var nb=pad(currentTrackNumber,2);$('.position [data-target="position"]',$line).text(nb);}
if(unavailableType!==right.READABLE||typeof currentData.LYRICS_ID==='undefined'||currentData.LYRICS_ID===0){$('.track [data-target="icon-lyrics"]',$line).hide();}
if(isDeezerTrack&&options.skin.displayDownload){$('.track [data-target="icon-download"]',$line).show();}else{$('.track [data-target="icon-download"]',$line).hide();}
if(options.skin.displayHistoric){$('.track [data-target="icon-historic"]',options.$line_model).show().attr('href','/');}else{$('.track [data-target="icon-historic"]',options.$line_model).hide();}
if(currentData.DURATION==undefined)currentData.DURATION=0;$('[data-target="length"]',$line).text(secToMin(currentData.DURATION));if(options.skin.displayNoteColumn){$('.popularity [data-target="note"]',$line).attr('class','note');if(isDeezerTrack){if(currentData.RANK_SNG==undefined){currentData.RANK_SNG=0;}
$('.popularity [data-target="note"]',$line).addClass("note-"+Math.round(currentData.RANK_SNG/100000));}else{$('.popularity [data-target="note"]',$line).addClass("note-0");}
$('.popularity',$line).removeAttr('data-tooltip');}
if(options.skin.displayDateColumn){$('.added [data-target="added"]',$line).data('timestamp',currentData.DATE_ADD);}
if(options.skin.displayListenColumn){$('.listen [data-target="listen"]',$line).data('timestamp',currentData.TS);}
if(isFallbackTrack&&options.skin.displayFallbackIcon){$('.track [data-target="icon-link"]',$line).attr('href','/album/'+currentData.FALLBACK.ALB_ID).show();}else{$('.track [data-target="icon-link"]',$line).hide();}
if(options.skin.displaySubresult){if(typeof subResult=='object'){$line.addClass("similar").attr("data-parent-id",subResult.parentId).removeClass('song');if(subResult.isLastSubResult)$line.addClass('similar-last');}
if(typeof currentData.SUB_RESULT!='undefined'){$('.track [data-target="icon-similar"]',$line).show();}else{$('.track [data-target="icon-similar"]',$line).hide();}}else{$('.track [data-target="icon-similar"]',$line).hide();}
if(options.type!='search'&&typeof currentData.SNG_CONTRIBUTORS!='undefined'&&(oSelf.getContributor(currentData.SNG_CONTRIBUTORS,'author')!=false||oSelf.getContributor(currentData.SNG_CONTRIBUTORS,'composer')!=false||oSelf.getContributor(currentData.SNG_CONTRIBUTORS,'misc')!=false)){$('.track [data-target="icon-contributors"]',$line).show();}else{$('.track [data-target="icon-contributors"]',$line).hide();}
if(options.skin.displayLoved&&!OFFLINE){favorite.drawButton($('.loved [data-target="lovetrack"]',$line),{type:'song',id:sngId});}
if(OFFLINE){$('.track .icons',$line).hide();$('.loved [data-target="lovetrack"]',$line).hide();}
$(".check > input",$line).attr('disabled',!options.selectable);if(unavailableType==right.NOT_RELEASE_FREE||unavailableType==right.NOT_RELEASE_PREMIUM){oTable.addClass('has-calendar');$line.addClass('soon');var releaseDate=(unavailableType==right.NOT_RELEASE_FREE)?currentData.RIGHTS.STREAM_ADS.split('-'):currentData.RIGHTS.STREAM_SUB.split('-');$('.position [data-target="calendar"] .month',$line).text(getShortMonthName(releaseDate[1]));$('.position [data-target="calendar"] .day',$line).text(releaseDate[2]);}else{$line.removeClass('soon');$('.position [data-target="calendar"] .month',$line).text('');$('.position [data-target="calendar"] .day',$line).text('');}
if(unavailableType!=right.READABLE){$line.addClass('unavailable');$line.attr('data-unavailable',unavailableType);}else{$line.removeClass('unavailable').removeAttr('data-unavailable').removeAttr('data-tooltip').unbind('mouseover mouseout');}
if(options.type=='playlist'&&unavailableType>0)unavailableList.push(oSelf.getSongId(currentData));return true;}catch(e){error.log(e);}};this.unAvailableDisplay=function(){var trackUnavailableList=$(".unavailable",oBody);var globalBlockedType=0;var fanOnlyTrackFound=false;trackUnavailableList.each(function(){var trackUnavailable=parseInt($(this).attr('data-unavailable'));globalBlockedType+=trackUnavailable;if(trackUnavailable==right.FAN_ONLY){fanOnlyTrackFound=true;}
if(trackUnavailable!=right.LOCALITY||!options.playlist_personnal){$(this).find('[data-target="icon-replace"]').hide();}
if(trackUnavailable==right.FAN_ONLY&&options.skin.displayFanOnly=='hovercard'){}else{$(this).attr('data-tooltip',right.getMessage(trackUnavailable)).mouseover(function(){$(this).find('[data-target="track"]').tipsy({trigger:'manual',gravity:'sw',space:8,fallback:$(this).attr('data-tooltip')}).tipsy('show');}).mouseout(function(){$(this).find('[data-target="track"]').tipsy('hide');});}
if(trackUnavailable==right.FAN_ONLY){oSelf.subscribeEventFanOnly();}
oSelf.replace($(this));});if(fanOnlyTrackFound){Events.ready(Events.user.userReady,oSelf.refreshFanOnlyList);}};this.updatedPersonalSong=function(params){try{$editedLine=$('#naboo_datagrid_track_'+params.upload_id);if($editedLine.length==1){$('[data-target="track"]',$editedLine).text(params.data.SNG_TITLE);$('[data-target="artist"]',$editedLine).text(params.data.ART_NAME);$('[data-target="album"]',$editedLine).text(params.data.ALB_TITLE);$editedLine.data('song').SNG_TITLE=params.data.SNG_TITLE;$editedLine.data('song').ART_NAME=params.data.ART_NAME;$editedLine.data('song').ALB_TITLE=params.data.ALB_TITLE;var renameIndex=$('.song',oBody).index($editedLine);if(renameIndex>-1){options.songs.data[renameIndex]['SNG_TITLE']=params.data.SNG_TITLE;options.songs.data[renameIndex]['ART_NAME']=params.data.ART_NAME;options.songs.data[renameIndex]['ALB_TITLE']=params.data.ALB_TITLE;}}
return true;}catch(e){error.log(e);}};this.createDatagridDrag=function($lines){try{if(!OFFLINE&&options.skin.displayOrder){var draggableOptions={refreshPositions:true,cursorAt:{top:25,left:0},helper:function(event,ui){try{if($(event.target).is('a')||$(event.target).is('i'))return false;var parent=$(event.target).is('tr')?$(event.target):$(event.target).parents('tr');parent.children(".check").children("input").prop("checked",true);var selectedSongId=oSelf.getSelectedTrackId(true);var selectedSongData=oSelf.getSelectedTrackData();var img=(typeof selectedSongData[0].ALB_PICTURE!='undefined')?selectedSongData[0].ALB_PICTURE:'';oSelf.closeAllContributor();if(selectedSongId.length==1){$ghost=ghost_single_model.clone();$('img',$ghost).attr('src',SETTING_DOMAIN_IMG+'/cover/'+img+'/30x30-000000-80-0-0.jpg');$('.cell-track > div:eq(0) > strong',$ghost).text(selectedSongData[0].SNG_TITLE);$('.cell-track > div:eq(1)',$ghost).text(selectedSongData[0].ALB_TITLE);$('.cell-length',$ghost).text(secToMin(selectedSongData[0].DURATION));var rank=(selectedSongData[0].RANK_SNG>0)?((Math.floor((selectedSongData[0].RANK_SNG/100000))*100)/100):'0';$('.cell-popularity > span',$ghost).addClass('note-'+rank);}else{$ghost=ghost_multi_model.clone();$('span > strong',$ghost).text(selectedSongId.length+" "+ngettext('titre','titres',{count:selectedSongId.length}));$('.picture > img',$ghost).attr('src',SETTING_DOMAIN_IMG+'/cover/'+img+'/30x30-000000-80-0-0.jpg');}
$ghost.css('top',-24)
$ghost.data('value',selectedSongId);$ghost.data('element-type','0');$ghost.data('allow-move-to-playlist',options.allowMoveToPlaylist);if(options.skin.displayOrder){$(".contributor",oBody).remove();}
return $ghost;}catch(e){error.log(e);}},stop:oSelf.stopDragTrack,drag:oSelf.dragTrack};$lines.draggable(draggableOptions);}}catch(e){error.log(e);}};this.dragTrack=function(event,ui){try{if(typeof menu!=='undefined'){menu.autoScroll(event,ui);}
if(options.skin.displayOrder&&oBody.length>0){var rowHeight=30;var minLeft=USER.SETTING.site.menu_width||0;if(ui.offset.left>minLeft){if(ui.offset.top+ui.helper.height()+25>$(window).height()){if(scrollInterval===0){scrollInterval=setInterval(function(){if($(page_content).children().height()-$(page_content).scrollTop()>$(page_content).height()){$(page_content).scrollTop($(page_content).scrollTop()+rowHeight);oSelf.dragTrack(event,ui);return false}
clearInterval(scrollInterval);scrollInterval=0;},150);}}else if(ui.offset.top<=playercontrol.heightPlayer){if(scrollInterval===0){scrollInterval=setInterval(function(){if($(page_content).scrollTop()>0){$(page_content).scrollTop($(page_content).scrollTop()-rowHeight);oSelf.dragTrack(event,ui);return false;}
clearInterval(scrollInterval);scrollInterval=0;},150);}}else if(scrollInterval>0){clearInterval(scrollInterval);scrollInterval=0;}
var datagrid_top=oBody.offset().top;var gridPosition=ui.offset.top-datagrid_top+25;gridPosition=(Math.round(gridPosition/rowHeight)*rowHeight);if(gridPosition/rowHeight>options.songs.count){gridPosition=(options.songs.count)*rowHeight;}
options.dropPosition=gridPosition/rowHeight;if(options.dropPosition!=options.dropPositionLast){if(gridPosition>=0){$('.divider',oBody).remove();separator=dividerBar.clone();separator.insertBefore($('tr:eq('+options.dropPosition+')',oBody));options.dropPositionLast=options.dropPosition;}else if(gridPosition<0){options.dropPosition=-1;$('.datagrid > table > tbody > .divider').remove();}}}else{options.dropPosition=-1;$('.datagrid > table > tbody > .divider').remove();}}}catch(e){error.log(e);}};this.stopDragTrack=function(event,ui){try{if(options.skin.displayOrder&&oBody.length>0){$('.divider',oBody).remove();clearInterval(scrollInterval);scrollInterval=0;if(ui.position.left>0)
oSelf.onDrop(event,ui);}
oSelf.onStopDrag();}catch(e){error.log(e);}};this.onDrop=function(event,ui){try{var selectedTrack=$(".song > .check > input:checked",oBody);if(selectedTrack.length>0){var moved=false;$destinationItem=$(this);if(options.dropPosition==-1)return false;if(selectedTrack.length>1){var orderedSelectedTracks=[];var initialPosition;selectedTrack.each(function(index,item){orderedSelectedTracks.unshift(item);var currentPosition=$(".song:visible",oBody).index($(this).parents('tr'));if(typeof initialPosition=='undefined'||currentPosition<initialPosition){initialPosition=currentPosition;}});if(initialPosition>options.dropPosition){selectedTrack=$(orderedSelectedTracks);}}
selectedTrack.each(function(index){$movedItem=$(this).parents('tr');var movedIndex=$(".song:visible",oBody).index($movedItem);var destinationIndex=options.dropPosition;if(movedIndex+1==destinationIndex)destinationIndex=movedIndex;if(movedIndex!=destinationIndex){var movedElement=options.songs.data[movedIndex];options.songs.data.splice(movedIndex,1);if(movedIndex<destinationIndex)options.songs.data.splice(destinationIndex-1,0,movedElement);else options.songs.data.splice(destinationIndex,0,movedElement);if(options.dropPosition==0)
oBody.prepend($movedItem);else
$('tr:eq('+(options.dropPosition-1)+')',oBody).after($movedItem);moved=true;}});if(moved){if(options.type=='playlist'){api.call('playlist.updateOrder',{playlist_id:options.id,position:'0',order:oSelf.getOrderTrack()},function(){});}
if(options.type=='lovedpersonal'){api.call('favorite_song.updateOrder',{position:'0',order:oSelf.getOrderTrack()},function(){});}}
if(options.skin.displaySongNumber){oSelf.refreshSongNumber();}}
return true;}catch(e){error.log(e);}};this.onStopDrag=function(){try{if(options.skin.displayHeader){$("#naboo_datagrid_header_check input",oOption).prop("checked",false);}
if(options.skin.displaySelectAll){$("#naboo_datagrid_select_all input",oOption).prop("checked",false);}
oSelf.unSelectedTrack();return true;}catch(e){error.log(e);}};this.createDatagridResize=function(){try{if(options.skin.displayHeader&&DIRECTION!=='rtl'){$("tr > .track",oHead).resizable(oSelf.getResizableOption('track'));$("tr > .artist",oHead).resizable(oSelf.getResizableOption('artist'));}
return true;}catch(e){error.log(e);}};this.getResizableOption=function(columns){try{return{minWidth:110,handles:{'e':$("tr > ."+columns+' > .handler',oHead)},start:function(event,ui){$(this).resizable("option","maxWidth",oBody.width()/3);}};}catch(e){error.log(e);}};this.startFilter=function(query){try{if(!options.playlist_private){if(query!==''){if(filterId>0)clearTimeout(filterId);filterId=setTimeout(oSelf.filter,filterInterval);}else{$("#naboo_datagrid_filter_text",oOption).removeClass('clear');$(".song",oBody).show();oSelf.closeAllContributor();oSelf.closeAllSubResult();options.skin.displayOrder=options.playlist_personnal;filterActif=false;}}
return true;}catch(e){error.log(e);}};this.filter=function(){try{query=rewriting($("#naboo_datagrid_filter_text",oOption).val().toUpperCase());if(query!=""){oSelf.closeAllContributor();oSelf.closeAllSubResult();$("#naboo_datagrid_filter_text",oOption).addClass('clear');$(".song",oBody).hide();filterActif=true;filterResult=[];for(j=0;j<options.songs.count;j++){if(typeof options.songs.data[j].SEARCH_STR!="undefined"){search_str=options.songs.data[j].SEARCH_STR;}else{search_str=rewriting(options.songs.data[j].SNG_TITLE.toUpperCase()+" "+options.songs.data[j].ART_NAME.toUpperCase()+" "+options.songs.data[j].ALB_TITLE.toUpperCase());options.songs.data[j].SEARCH_STR=search_str;}
if(search_str.indexOf(query)>-1){filterResult.push(options.songs.data[j]);$("#naboo_datagrid_track_"+oSelf.getSongId(options.songs.data[j]),oBody).show();}}
if(options.skin.displayOrder){options.skin.displayOrder=false;}
oSelf.extendBackground();}
return true;}catch(e){error.log(e);}};this.setFilterLabel=function(){try{if(gridTrad[options.type]){filterLabel=gridTrad[options.type];}else{filterLabel=gettext('Rechercher dans les résultats');}
$('#naboo_datagrid_filter_text',oOption).attr('placeholder',filterLabel);return true;}catch(e){error.log(e);}};this.onFilterFocus=function(){try{if(options.songs.count<options.songs.total){waitingAllTrackForFilter=true;oSelf.loadAllTracks();}else{waitingAllTrackForFilter=false;}
return true;}catch(e){error.log(e);}};this.sort=function($link){try{if(options.songs.count<options.songs.total){lastSort.link=$link;lastSort.columnIndex=columnIndex;waitingAllTrackForSort=true;oSelf.loadAllTracks();}else{waitingAllTrackForSort=false;}
if(waitingAllTrackForSort){return false;}
$lines=oBody;oSelf.closeAllSubResult();oSelf.closeAllContributor();oSelf.unSelectedTrack();var sortType=(($('.label > .sort',$link).is('.sort-asc'))?"DESC":"ASC");$('.label > .sort',$link).removeClass('sort-asc sort-desc').addClass('sort-'+sortType.toLowerCase());var columnIndex=($link.is('.track'))?'SNG_TITLE':'';columnIndex=($link.is('.artist'))?'ART_NAME':columnIndex;columnIndex=($link.is('.album'))?'ALB_TITLE':columnIndex;columnIndex=($link.is('.length'))?'DURATION':columnIndex;columnIndex=($link.is('.popularity'))?'RANK_SNG':columnIndex;columnIndex=($link.is('.added'))?'DATE_ADD':columnIndex;options.songs.data.sort(function(a,b){if(typeof a['ORDER_'+columnIndex]!='undefined'&&typeof b['ORDER_'+columnIndex]!='undefined'){var compA=a['ORDER_'+columnIndex];var compB=b['ORDER_'+columnIndex];}else{if(columnIndex=="DURATION"||columnIndex=="RANK_SNG"||columnIndex=="DATE_ADD"){var compA=parseInt(a[columnIndex]);var compB=parseInt(b[columnIndex]);}else{var compA=rewriting(a[columnIndex].toLowerCase());var compB=rewriting(b[columnIndex].toLowerCase());}
a['ORDER_'+columnIndex]=compA;b['ORDER_'+columnIndex]=compB;}
if(sortType=="ASC")return(compA<compB)?-1:(compA>compB)?1:0;else return(compA>compB)?-1:(compA<compB)?1:0;});$lines.children('tr').each(function(index){if($(this).attr('unavailable')!=null){$(this).unbind('mouseenter').removeAttr('unavailable');}
oSelf.refreshLineContent($(this),options.songs.data[index]);});if(options.skin.displayDateColumn){calculeTime();}
oSelf.unAvailableDisplay();options.skin.displayOrder=false;if(lastColSort!==false&&lastColSort.attr('class')!=$link.attr('class')){$('.label > .sort',lastColSort).removeClass('sort-asc sort-desc');}
lastColSort=$link;oSelf.displayPlayingTrack(null,dzPlayer.getCurrentSong());return true;}catch(e){error.log(e);}};this.play=function($line){try{if(!$line.is('tr')&&!$line.is('button')){$line=$line.parents('tr');}
if(typeof $line!='undefined'&&$line.is('.unavailable')){return false;}
if($line.is('tr.active')){dzPlayer.control.togglePause();return false;}
if($line.is('button')&&oSelf.isSameContext(dzPlayer.getContext())&&dzPlayer.getContext('ID')==options.id){dzPlayer.control.togglePause();return false;}
var index=(typeof $line!='undefined')?$line.parent().children('.song:visible').index($line):-1;var songsList=(filterActif)?filterResult:options.songs.data;if(songsList.length>0){if((typeof $line!='undefined')&&options.type=="search"){if($line.is('.similar')&&!$line.is('.similar-parent')){index=(typeof $line!='undefined')?$line.parent().children('.similar').index($line):-1;$parentLine=$('#naboo_datagrid_track_'+$line.attr('data-parent-id'),oBody);var indexParent=(typeof $parentLine!='undefined')?$parentLine.parent().children('.song:visible').index($parentLine):0;var subTracks=songsList[indexParent].SUB_RESULT;for(var s=0;s<subTracks.length;s++){songsList.splice((indexParent+1)+s,0,songsList[indexParent].SUB_RESULT[s]);}
index+=indexParent;}}
var type=options.type;switch(options.type){case"loved":case"lovedpersonal":case"playlist":oSelf.playAllTracks(true);break;case"discography_album":type='album';songsList=[];break;}
dzPlayer.play({id:options.id,type:type,data:songsList,index:index,context:oSelf.getContext()});}
return true;}catch(e){error.log(e);}};this.playAllTracks=function(init){try{if(typeof init!='undefined'&&init){options.startAllLoaded=options.songs.count;}
if(options.songs.count<options.songs.total){waitingAllTrackForTotalPlay=true;oSelf.loadAllTracks();}else{if(waitingAllTrackForTotalPlay){var addedTracks=options.songs.data.slice();dzPlayer.enqueueTracks(addedTracks.splice(options.startAllLoaded,options.songs.total),oSelf.getContext());}
waitingAllTrackForTotalPlay=false;}}catch(e){error.log(e);}};this.playWithLyrics=function($line){Events.subscribeOnce(Events.player.tracklist_changed,function(){dzPlayer.control.nextSong();Events.trigger(Events.menu.togglePanel,'lyrics');});var params={type:'track',id:$line.parents('tr').data('song').SNG_ID,radio:false,context:oSelf.getContext()};if(dzPlayer.getPlayerType()!=='radio'){params.addNext=true;}
dzPlayer.play(params);},this.openSubResult=function($icon){try{$line=$icon.parents('tr');if(!$icon.children().is('.icon-chevron-up')){$icon.children().removeClass('icon-chevron-down').addClass('icon-chevron-up');var currentData=$line.data('song').SUB_RESULT;if(typeof currentData[0].SNG_TITLE!='undefined'){oSelf.drawSubResult($line,currentData);return;}
api.call('song.getListData',{'sng_ids':currentData},function(result){if(typeof result.data!='undefined'){currentData=result.data;oSelf.drawSubResult($line,currentData);var indexTrack=$line.parent().children('.song:visible').index($line);if(indexTrack>-1){options.songs.data[indexTrack].SUB_RESULT=currentData;}}});}else{$icon.children().addClass('icon-chevron-down').removeClass('icon-chevron-up');$line.removeClass('similar-parent similar');$('[data-parent-id="'+oSelf.getSongId($line.data('song'))+'"]',oBody).remove();}
return true;}catch(e){error.log(e);}};this.drawSubResult=function($line,currentData,parent_id){try{$blockSub=$('<p></p>');for(var s=0;s<currentData.length;s++){$lineSub=options.$line_model.clone();$lineSub.show();oSelf.refreshLineContent($lineSub,currentData[s],{isLastSubResult:((s)==currentData.length-1),parentId:oSelf.getSongId($line.data('song'))});oSelf.setLineLink($lineSub);$blockSub.append($lineSub);}
$line.addClass('similar-parent similar');$line.after($blockSub.children());oSelf.createDatagridDrag($line.nextAll('.similar'));return true;}catch(e){error.log(e);}};this.closeAllSubResult=function(){try{if(options.type=="search"){var currentSubResult=$(".similar",oBody);if(currentSubResult.length>0){currentSubResult.each(function(){$(this).prev().find('[data-target="icon-similar"] > i').removeClass('opened');});$('.similar-parent',oBody).removeClass('similar-parent similar');currentSubResult.remove();}}
return false;}catch(e){error.log(e);}};this.openContributor=function($btn){try{$line=$btn.parents('tr');if(!$btn.children().is('.opened')){var contributorData=$line.data('song').SNG_CONTRIBUTORS;var contributorListing=[];if(oSelf.getContributor(contributorData,'author')!=false){contributorListing.push(gettext('Auteur :')+' '+oSelf.getContributor(contributorData,'author'));}
if(oSelf.getContributor(contributorData,'composer')!=false){contributorListing.push(gettext('Compositeur :')+' '+oSelf.getContributor(contributorData,'composer'));}
if(oSelf.getContributor(contributorData,'misc')!=false){contributorListing.push(gettext('Autres contributeurs :')+' '+oSelf.getContributor(contributorData,'misc'));}
if(contributorData!=''){var line_contributors=contributor_model.clone();$('[data-target="contributors"]',line_contributors).text(contributorListing.join(' / '));$line.after(line_contributors);if(line_contributors.outerHeight()>30){line_contributors.outerHeight(Math.ceil(line_contributors.outerHeight()/30)*30);}}
$btn.children().removeClass('icon-chevron-down').addClass('icon-chevron-up');$btn.children().addClass('opened');}else{$btn.children().removeClass('icon-chevron-up').addClass('icon-chevron-down');$btn.children().removeClass('opened');$line.next('.contributors').remove();}
return true;}catch(e){error.log(e);}};this.getContributor=function(list,key){try{if(typeof list[key]!='undefined'){return list[key].join(' - ');}
return false;}catch(e){error.log(e);}};this.closeAllContributor=function(){try{var currentContributor=$(".contributors",oBody);if(currentContributor.length>0){currentContributor.each(function(){$(this).prev().find('[data-target="icon-contributors"] > .icon').removeClass('icon-chevron-up').addClass('icon-chevron-down');});currentContributor.remove();}
return false;}catch(e){error.log(e);}};this.addMusicBox=function($add,view){try{if(options.selectable){var songData=[];var songId=[];if($add.attr("id")=="naboo_datagrid_add"){songData=oSelf.getSelectedTrackData();songId=oSelf.getSelectedTrackId();}else{songData.push($add.parents('tr').data('song'));songId.push($add.parents('tr').data('song').SNG_ID);oSelf.unSelectedTrack();}
if(songData.length>0){context_menu.open({target:$add,position:'left',type:'song',view:view,data:{SONG:songData.length===1?songData[0]:{},PLAYLIST_ID:(options.type==='playlist')?options.id:0,PLAYLIST_PERSONNAL:options.playlist_personnal},id:songId,context:(options.type==='discography_album'||options.type==='artist_top')?'artist':options.type,listen_context:{TYPE:oSelf.getContextName(),ID:options.id}});}}
return true;}catch(e){error.log(e);}};this.storeAction=function($btn,action){try{if(options.selectable){var songId=[];if($btn.attr('data-target')=="download-multi"||$btn.attr('data-target')=="buy-multi"){songId=oSelf.getSelectedTrackId(false);}else{songId.push(oSelf.getSongId($btn.parents('tr').data('song')));}
if(songId.length>0){storeSongsDownload(songId);}}
return true;}catch(e){error.log(e);}};this.replace=function($replace){try{if(options.playlist_personnal){if($replace.attr('data-unavailable')==right.LOCALITY){var sng_id=oSelf.getSongId($replace.data('song'));var art_id=$replace.data('song').ART_ID;var sng_name=$replace.data('song').SNG_TITLE;var art_name=$replace.data('song').ART_NAME;$('.track [data-target="icon-replace"]',$replace).attr({'id':'btn_replace_'+art_id+"_"+sng_id,'data-hovercard':'/ajax/hovercard/page.php?card=replace&art_id='+art_id+'&sng_id='+sng_id+'&playlist_id='+options.id+'&art_name='+escape(art_name)+'&sng_name='+escape(sng_name)+'&div='+oWrapper.attr('id')});}}
return true;}catch(e){error.log(e);}};this.onReplaced=function(old_id,sng_obj){try{$line=$("#naboo_datagrid_track_"+old_id,oBody);if($line.length==0){return false;}
if($line.attr('data-unavailable')!=null){$line.removeAttr('data-unavailable');$line.unbind('mouseover mouseout');}
if(options.type=='lovedpersonal'){userData.data.FAVORITES_SONGS_HASH[old_id+'_0']=false;userData.data.FAVORITES_SONGS_HASH[oSelf.getSongId(sng_obj)+'_0']=true;}
oSelf.refreshLineContent($line,sng_obj);var indexData=$(".song:visible",oBody).index($line);options.songs.data[indexData]=sng_obj;}catch(e){error.log(e);}};this.removeTrack=function(removeId,forceRemove){try{if(options.skin.displayRemove){var selectedTrackId=(typeof removeId=='undefined')?oSelf.getSelectedTrackId(true):removeId;if(selectedTrackId.length==0){return false;}
forceRemove=forceRemove||false;if(forceRemove||confirm(ngettext('Êtes-vous sûr de vouloir supprimer le titre sélectionné ?','Êtes-vous sûr de vouloir supprimer les titres sélectionnés ?',{count:selectedTrackId.length}))){switch(options.type){case"lovedpersonal":var i;var song_ids=[];for(i=0;i<selectedTrackId.length;i++){song_ids.push(selectedTrackId[i][0]);}
api.call('favorite_song.removeMulti',{SNG_IDS:song_ids},oSelf.onRemoved,{sng_list:selectedTrackId});break;case"playlist":var params={playlist_id:options.id,songs:selectedTrackId};api.call('playlist.deleteSongs',params,oSelf.onRemoved,{sng_list:selectedTrackId});break;case"personal_song":for(var i=0;i<selectedTrackId.length;i++){var params={upload_id:selectedTrackId[i][0]};api.call('personal_song.delete',params,oSelf.onRemoved,{sng_list:[selectedTrackId[i][0]]});}
break;}}}
return true;}catch(e){error.log(e);}};this.onRemoved=function(result,params){try{if(result==true){var nbSong=params.sng_list.length;var duration=0;userData.removePlaylistSong(options.id,params.sng_list);for(j=0;j<nbSong;j++){var sng_id=((typeof params.sng_list[j]=="object")?params.sng_list[j][0]:params.sng_list[j]);$line=$("#naboo_datagrid_track_"+sng_id,oBody);$line_contributors=$("#naboo_datagrid_contributors_"+sng_id,oBody);var indexData=$(".song:visible",oBody).index($line);if(typeof options.songs.data[indexData]!='undefined'){duration+=parseInt(options.songs.data[indexData].DURATION);}
options.songs.data.splice(indexData,1);$line.remove();if($line_contributors.length>0){$line_contributors.remove();}
if(options.type==='lovedpersonal'&&userData.isFavorite('song',sng_id)){userData.deleteFavorite({type:'song',id:sng_id});}}
if(options.type=='playlist'){playlist.updateDurationAndNbSongs(-duration,-nbSong);}
options.songs.count=options.songs.count-nbSong;options.songs.total=options.songs.total-nbSong;if(creationEndIndex<options.songs.total){removedTrackBeforeLoadComplete+=nbSong;creationStartIndex-=nbSong;}
if(oBody.length==0){if(options.songs.total>0){options.$line_model.children('.check').children('input').prop('checked',false);creationStartIndex=creationEndIndex=0;oSelf.load(null,null,options.id,creationGroup);}}
$checkAll=$('tr [data-target="checkall"]',oHead);if($checkAll.prop("checked")){$checkAll.prop("checked",false);}
if(options.type!=='lovedpersonal'){Events.trigger(Events.datagrid.removedTrack);}
oSelf.visibleActionButton(false);oSelf.closeAllContributor();}
return true;}catch(e){error.log(e);}};this.selectAll=function($check){try{if(!OFFLINE&&options.songs.total>0){$(".song:visible > .check > input",oBody).prop("checked",$check.prop("checked"));oSelf.visibleActionButton($check.prop("checked"));}
return true;}catch(e){error.log(e);}};this.selectOne=function($check){try{if($check.prop("checked")){oSelf.visibleActionButton(true);}else{oSelf.visibleActionButton($("tr > .check > input:checked",oBody).length>0);}
return false;}catch(e){error.log(e);}};this.unSelectedTrack=function(){try{var selectedTrack=$("tr input:checked",oBody);selectedTrack.each(function(){$(this).prop("checked",false);});if(options.skin.displaySelectAll){$('[data-target="checkall"]',oOption).prop("checked",false);}else{$('tr [data-target="checkall"]',oHead).prop("checked",false);}
oSelf.visibleActionButton(false);}catch(e){error.log(e);}};this.visibleActionButton=function(status){try{if(status){if(!options.skin.displayOptionsToggle){oOption.show();}
$('.toolbar-actions',oOption).show();if(options.skin.displayRemove)
$("#naboo_datagrid_remove",oOption).show();if(options.skin.displayDownload)
$("#naboo_datagrid_download",oOption).show();if(options.skin.displayAdd)
$("#naboo_datagrid_add",oOption).show();}else{if(!options.skin.displayOptionsToggle){oOption.hide();}
$('.toolbar-actions',oOption).hide();}
return true;}catch(e){error.log(e);}};this.insertUploadFile=function(id,fileName){try{$progressBar=progressBar.clone();$progressBar.attr('id','PROGRESS_'+id).show();oBody.prepend($progressBar);$upload=upload_model.clone();$upload.attr('id','UPLOAD_'+id);$upload.children('[data-target="status"]').text(gettext('En cours'));$upload.children('[data-target="filename"]').text(fileName);oBody.prepend($upload);return true;}catch(e){error.log(e);}};this.updateUploadFile=function(id,fileName,pourcent){try{$("#PROGRESS_"+id,oBody).css('width',pourcent+'%');$('#UPLOAD_'+id,oBody).children('[data-target="status"]').text(gettext('En cours')+' ('+pourcent+'%)');return true;}catch(e){error.log(e);}};this.finishUploadFile=function(id,fileName,response){try{$('#PROGRESS_'+id,oWrapper).remove();if(response.error.length==0){$('#UPLOAD_'+id,oWrapper).remove();var sng_id=-Math.abs(response.results);api.call('song.getData',{sng_id:sng_id},oSelf.finishUploadFileCallback);}else{$('#UPLOAD_'+id,oWrapper).children('[data-target="status"]').text(gettext('Erreur'));}
return true;}catch(e){error.log(e);}};this.finishUploadFileCallback=function(result){try{result.FILESIZE=result.FILESIZE_MP3_MISC;options.songs.data.push(result);options.songs.count=options.songs.data.length;options.songs.total=options.songs.data.length;creationStartIndex=options.songs.count-1;oSelf.createDatagridLines();return true;}catch(e){error.log(e);}};this.download=function($btn){try{if(options.songs.data.length==0){return false;}
dzoffline.display(options.type+'/'+options.id);}catch(e){error.log(e);}};this.displayPlayingTrack=function(evt,onair){try{if(lastOnAirTrack!=false){lastOnAirTrack.removeClass('active paused');lastOnAirTrack=false;}
if(oSelf.isSameContext(dzPlayer.getContext())){$('#naboo_datagrid_track_'+oSelf.getSongId(dzPlayer.getCurrentSong()),oBody).each(function(){$(this).addClass('active');if(options.scrollAutoOnAir){Events.trigger(Events.datagrid.onAirPosition,{top:$(this).position().top,height:$(this).height()});}
lastOnAirTrack=$(this);if(!dzPlayer.isPlaying()){$(this).addClass('paused');}else{$(this).removeClass('paused');}});}
return true;}catch(e){error.log(e);}};this.displayPlayingIcon=function(evt,playing){try{if(!dzPlayer.isPaused()&&!dzPlayer.isPlaying()){playing=false;}
if(lastOnAirTrack.length==1){if(playing){lastOnAirTrack.removeClass('paused');}else{lastOnAirTrack.addClass('paused');}}
return true;}catch(e){error.log(e);}};this.isSameContext=function(onair){try{if(onair==null){return false;}
if((onair.TYPE.indexOf(options.type)>-1||onair.TYPE==oSelf.getContextName())&&onair.ID==options.id){return true;}
if(options.type==='discography_album'&&onair.TYPE.indexOf('album')>-1){return true;}
if(options.type==='album'&&onair.TYPE.indexOf('discography')>-1){return true;}
if((options.type=='loved'||options.type=='lovedpersonal')&&onair.TYPE==oSelf.getContextName()){return true;}
if(options.type=='personal_song'&&onair.TYPE==oSelf.getContextName()){return true;}
if(options.type==='history'&&onair.TYPE.indexOf('history')>-1){return true;}
return false;}catch(e){error.log(e);}};this.subscribeEventFanOnly=function(){try{if(!artistOnlyEvent){Events.subscribe(Events.user.addFavorite,oSelf.addFavoriteArtist);Events.subscribe(Events.user.deleteFavorite,oSelf.deleteFavoriteArtist);artistOnlyEvent=true;}}catch(e){error.log(e);}};this.refreshFanOnlyList=function(){try{var trackUnavailableList=$(".unavailable",oBody);trackUnavailableList.each(function(){var trackUnavailable=parseInt($(this).attr('data-unavailable'));if(trackUnavailable==right.FAN_ONLY){if(userData.isFavorite('artist',$(this).data('song').ART_ID)){oSelf.addFavoriteArtist(null,{ART_ID:$(this).data('song').ART_ID,type:'artist'});}}});}catch(e){error.log(e);}}
this.addFavoriteArtist=function(evt,params){try{if(params.type!='artist')return false;$(".unavailable",oBody).each(function(){if(typeof $(this).data('song')!='undefined'&&right.checkSongAvailable($(this).data('song'))==right.READABLE){$(this).removeClass('unavailable').unbind('mouseover mouseout');;}});}catch(e){error.log(e);}};this.deleteFavoriteArtist=function(evt,params){try{if(params.type!='artist')return false;$(".song:visible",oBody).each(function(){if(typeof $(this).data('song')!='undefined'&&right.checkSongAvailable($(this).data('song'))==right.FAN_ONLY){$(this).addClass('unavailable').attr('data-tooltip',right.getMessage(right.FAN_ONLY)).mouseover(function(){$(this).find('[data-target="track"]').tipsy({trigger:'manual',gravity:'sw',space:8,fallback:$(this).attr('data-tooltip')}).tipsy('show');}).mouseout(function(){$(this).find('[data-target="track"]').tipsy('hide');});}});}catch(e){error.log(e);}};this.displayChangeFavoriteTrack=function(evt,params){try{if(params.type!='song'){return false;}
$targetLine=$('#naboo_datagrid_track_'+params.id,oWrapper);if($targetLine.length>0){if(typeof $targetLine.data('song')!='undefined'){if(options.type==='lovedpersonal'&&evt.namespace==='USER.deleteFavorite'){if($("#naboo_datagrid_track_"+params.id,oBody).length===1){oSelf.onRemoved(true,{sng_list:[params.id]});}}else{favorite.drawButton($('.loved [data-target="lovetrack"]',$targetLine),params);}
return true;}}
if(options.type=='lovedpersonal'&&evt.namespace=='USER.addFavorite'){if(options.songs.total==options.songs.count&&countObject(params)>0){options.songs.data.push(params);options.songs.count=options.songs.data.length;options.songs.total=options.songs.data.length;creationStartIndex=options.songs.count-1;oSelf.createDatagridLines();}}
return true;}catch(e){error.log(e);}};this.getContext=function(){try{var context={TYPE:oSelf.getContextName(),ID:options.id};switch(options.type){case"playlist":context.NAME=$.trim($('#naboo_playlist_title').text());break;case"album":context.ALB_TITLE=$.trim($('#naboo_album_title').text());break;}
return context;}catch(e){error.log(e);}}
this.getContextName=function(){try{var contextName={playlist:'playlist_page',search:'search_page',personal_song:'personalsong_page',downloads:'downloads_page',album:'album_page',artist_top:'artist_top',artist_exclu:'artist_exclu',discography_album:'artist_discography',loved:'loved_page',lovedpersonal:'loved_page',history:'history_page'};if(typeof contextName[options.type]!='undefined'){return contextName[options.type];}
return options.type;}catch(e){error.log(e);}};this.activeInfiniteScroll=function(){try{if(creationStartIndex<options.songs.total&&options.scrollInfinite){Events.subscribeOnce(Events.layout.infiniteScroll,oSelf.loadNextTrack,options.event_group);infinite_scroll.active();}}catch(e){error.log(e);}};this.extendBackground=function(){try{if(options.skin.displayExtendBackground){$('.filler',oBody).remove();oTable.attr('style','');var diffSize=$(pageContent).height()-$(pageContent).children().height();if(diffSize>0){if(options.songs.count==creationGroup&&options.songs.total>creationGroup){oSelf.loadNextTrack();}else{oBody.append(fillerBar);oTable.height(oTable.height()+diffSize);}}}
return true;}catch(e){error.log(e);}};this.getSelectedTrackId=function(withType,inputChecked){try{var selectedTrack=(typeof inputChecked=='undefined')?$("tr > .check > input:checked",oBody):inputChecked;var selected=[];for(i=0;i<selectedTrack.length;i++){currentData=$(selectedTrack[i]).parents('tr').data('song');var sng_id=oSelf.getSongId(currentData);if(withType){selected.push([sng_id,sng_id>0?0:1]);}else{selected.push(sng_id);}}
return selected;}catch(e){error.log(e);}};this.getSelectedTrackData=function(inputChecked){try{var selectedTrack=(typeof inputChecked=='undefined')?$("tr > .check > input:checked",oBody):inputChecked;var song_data=[];for(var s=0;s<selectedTrack.length;s++){$line=$(selectedTrack[s]).parents('tr');if(typeof $line.data('song')!='undefined'){song_data.push($line.data('song'));}}
return song_data;}catch(e){error.log(e);}};this.getOrderTrack=function(){try{var order=[];for(i=0;i<options.songs.count;i++){order.push(oSelf.getSongId(options.songs.data[i]));}
return order;}catch(e){error.log(e);}};this.liveAddSong=function(evt,params){try{if(options.type=='playlist'&&options.id==params.playlist_id){if(creationStartIndex>=options.songs.total){api.call({method:'song.getListAllData',data:{'sng_ids':params.song},success:function(result){if(options.songs.total===0){options.skin.displayExtendBackground=true;$('#naboo_datagrid_add_track_empty',oWrapper).hide();oSelf.extendBackground();}
var duration=0;for(var t=0;t<result.data.length;t++){duration+=parseInt(result.data[t].DURATION,10);result.data[t].DATE_ADD=SERVER_TIMESTAMP;options.songs.data.push(result.data[t]);}
options.songs.count=options.songs.total=options.songs.data.length;creationStartIndex=options.songs.count-1;oSelf.createDatagridLines();playlist.updateDurationAndNbSongs(duration,result.data.length);}});}}}catch(e){error.log(e);}};this.rightClic=function($line){try{if(OFFLINE){return false;}
$line.mousedown(function(e){var evt=e;$line.mouseup(function(e){$line.unbind('mouseup');if(e.button==2){oSelf.unSelectedTrack();$target=$(e.target);if($target.is('tr')){$selectedLine=$target;}else{$selectedLine=$target.parents('tr');}
if($selectedLine.data('song')!=null){context_menu.open({target:e.target,position:{left:e.pageX+1,top:e.pageY+1},type:'song',data:{SONG:$selectedLine.data('song'),PLAYLIST_ID:(options.type==='playlist')?options.id:0,PLAYLIST_PERSONNAL:options.playlist_personnal},id:$selectedLine.data('song').SNG_ID,context:(options.type==='discography_album'||options.type==='artist_top')?'artist':options.type,listen_context:{TYPE:oSelf.getContextName(),ID:options.id}});}
e.stopPropagation();}});});}catch(e){error.log(e);}};this.tipsy=function($btn,status,gravity){try{if(status=='over'){if(typeof gravity=='undefined'){gravity='s';}
$btn.tipsy({trigger:'manual',force_top:true,gravity:gravity,title:function(){var wording=$(this).attr('data-tooltip');if($(this).is('[data-target="offline-mobile"]')){if($(this).is('.synced')){wording=gettext('Synchronisation terminée sur votre %s. Cliquez pour désynchroniser.',{sprintf:[$(this).data('device')]});}else if($(this).is('.pending')){wording=gettext('Synchronisation en cours sur votre %s. Vérifiez votre appareil.',{sprintf:[$(this).data('device')]});}}
return wording;}}).tipsy('show');}else if(status=='out'){$btn.tipsy('hide');}}catch(e){error.log(e);}}
this.getTotalDuration=function(){try{var duration=0;for(var s=0;s<options.songs.data.length;s++){duration+=parseInt(options.songs.data[s].DURATION);}
return duration;}catch(e){error.log(e);}};this.displayArtistName=function(container,data,artists){try{if(typeof data.ARTISTS!='undefined'&&data.ARTISTS.length>0){var lines=[];container.empty();var checkDouble={};for(var a=0;a<data.ARTISTS.length;a++){if(typeof artists=='undefined'||(typeof artists=='object'&&typeof artists[data.ARTISTS[a].ART_ID]=='undefined')){if(typeof checkDouble[data.ARTISTS[a].ART_ID]==='boolean'){continue;}
var line=artist_model.clone();line.attr('href','/artist/'+data.ARTISTS[a].ART_ID).text(data.ARTISTS[a].ART_NAME);lines.push(util.getOuterHTML(line));checkDouble[data.ARTISTS[a].ART_ID]=true;}}
container.append(lines.join(', '));return true;}
container.html(artist_model.clone());$('a',container).text(data.ART_NAME).attr('href',(data.ART_ID!=0&&!OFFLINE)?'/artist/'+data.ART_ID:'javascript:void(0)');return true;}catch(e){error.log(e);}};this.displaySongTitle=function(container,data){try{var sng_title=[];var str_title='';if(typeof data.SNG_CONTRIBUTORS!='undefined'&&typeof data.SNG_CONTRIBUTORS.abbreviated_composer!='undefined'&&data.SNG_CONTRIBUTORS.abbreviated_composer!=''){sng_title.push(data.SNG_CONTRIBUTORS.abbreviated_composer);}
if(options.type=='album'){sng_title.push(data.SNG_TITLE);str_title=sng_title.join(' | ');if(typeof data.VERSION!='undefined'&&data.VERSION!=''){str_title+=' '+data.VERSION;}
$(container).text(str_title);return true;}
sng_title.push(data.SNG_TITLE);str_title=sng_title.join(' | ');if(typeof data.VERSION!='undefined'&&data.VERSION!=''){str_title+=' '+data.VERSION;}
$(container).text(str_title);return true;}catch(e){error.log(e);}};this.isDeezerTrack=function(data){try{return(data.SNG_ID>0);}catch(e){error.log(e);}};this.getSongId=function(data){try{if(typeof data.SNG_ID_ORIGIN!='undefined'){return data.SNG_ID_ORIGIN;}
return data.SNG_ID;}catch(e){error.log(e);}};this.unsubscribe=function(){try{isDisplay=false;Events.unsubscribeAll(options.event_group);Events.unsubscribe(Events.player.displayCurrentSong,oSelf.displayPlayingTrack);Events.unsubscribe(Events.user.addFavorite,oSelf.displayChangeFavoriteTrack);Events.unsubscribe(Events.user.deleteFavorite,oSelf.displayChangeFavoriteTrack);Events.unsubscribe(Events.playlist.addSong,oSelf.liveAddSong);}catch(e){error.log(e);}};this.addTdInLine=function($item,selector,position){try{var colgroupTrackPosition=oColGroup.children().index(oColGroup.children(selector));var colgroupLength=oColGroup.children().length-$item.children().length;for(var i=0;i<colgroupLength;i++){var td=$('<td></td>');if(i<colgroupTrackPosition&&position.before){$item.prepend(td);}else if(position.after){$item.append(td);}}
if(position.after==null||position.before==null){$('td:eq('+colgroupTrackPosition+')',$item).attr('colspan',oColGroup.children().length-$item.children().length+1);}
return $item;}catch(e){error.log(e);}};return create();}})(jQuery);var datagrid={action:function(btn,params){try{if($(btn).is('.datagrid_master')){$datagridInstance=$(btn);}else{$datagridInstance=$(btn).parents('.datagrid_master');}
if($datagridInstance.length>0){$datagridInstance.actionDatagrid(params);}else{console.log('Impossible de trouver l instance');}}catch(e){error.log(e);}}};;
var episode_description={display:function(args){$('#naboo_episode_description').text(args.description);Events.trigger(Events.navigation.tab_displayed,{type:args.type,id:args.id});}};;
var advertising={call:function(element_type,args){try{if(typeof USER!=='undefined'&&USER.OPTIONS.ads_display===false){return false;}
if(!dzPlayer.isAdvertisingAllowed()){return false;}
var element_id=args.element_id||0;var element_data=args.element_data||'';var ord=parseInt(Math.random()*10000000000000000,10);switch(element_type){case'home':ads.callAds('15829/114873/6955/S/'+ord+'/');ads.callAds('15829/114873/19632/S/'+ord+'/');ads.callAds('15829/114873/27374/S/'+ord+'/');break;case'feed':ads.callAds('15829/605946/6955/S/'+ord+'/');ads.callAds('15829/605946/19632/S/'+ord+'/');ads.callAds('15829/605946/27374/S/'+ord+'/');break;case'multiple_feed':ads.callAds('15829/114873/22283/M/'+ord+'/element_type=;element_id='+element_id);break;case'explore':ads.callAds('15829/274132/6955/M/'+ord+'/element_type=;element_id='+element_id);ads.callAds('15829/274132/27374/S/'+ord+'/element_type=;element_id='+element_id);break;case'tops':ads.callAds('15829/274126/6955/M/'+ord+'/element_type=tops;element_id='+element_id);ads.callAds('15829/274126/27374/S/'+ord+'/element_type=tops;element_id='+element_id);break;case'radio':ads.callAds('15829/115070/6955/M/'+ord+'/element_type=;element_id='+element_id);ads.callAds('15829/115070/27374/S/'+ord+'/element_type=;element_id='+element_id);break;case'talk':ads.callAds('15829/555138/6955/M/'+ord+'/element_type=;element_id='+element_id);ads.callAds('15829/555138/27374/S/'+ord+'/element_type=;element_id='+element_id);break;case'talkshow':ads.callAds('15829/555137/6955/M/'+ord+'/element_type=;element_id='+element_id);ads.callAds('15829/555137/27374/S/'+ord+'/element_type=;element_id='+element_id);break;case'profile':ads.callAds('15829/115081/6955/M/'+ord+'/element_type=profile;element_id='+element_id+';element_style='+element_data);ads.callAds('15829/115081/27374/S/'+ord+'/element_type=profile;element_id='+element_id+';element_style='+element_data);break;case'loved':ads.callAds('15829/274137/6955/M/'+ord+'/element_type=loved;element_id='+element_id);ads.callAds('15829/274137/27374/S/'+ord+'/element_type=loved;element_id='+element_id);break;case'artist':ads.callAds('15829/115069/6955/M/'+ord+'/element_type=artist;element_id='+element_id);ads.callAds('15829/115069/27374/S/'+ord+'/element_type=artist;element_id='+element_id);break;case'album':ads.callAds('15829/115066/6955/M/'+ord+'/element_type=album;element_id='+element_id);ads.callAds('15829/115066/27374/S/'+ord+'/element_type=album;element_id='+element_id);break;case'playlist':ads.callAds('15829/115067/6955/M/'+ord+'/element_type=playlist;element_id='+element_id);ads.callAds('15829/115067/27374/S/'+ord+'/element_type=playlist;element_id='+element_id);break;case'search':ads.callAds('15829/115072/6955/M/'+ord+'/element_type=result;element_id='+element_id+';element_style='+element_data);ads.callAds('15829/115072/27374/S/'+ord+'/element_type=result;element_id='+element_id+';element_style='+element_data);break;case'track':ads.callAds('15829/487686/6955/M/'+ord+'/element_type=;element_id='+element_id);ads.callAds('15829/487686/27374/S/'+ord+'/element_type=;element_id='+element_id);break;case'lyrics':$('body').removeClass('has-lyrics-ads-bottom');ads.callAds('15829/548730/27374/S/'+ord+'/element_type=;element_id='+element_id);break;}
return true;}catch(e){error.log(e);}}};;
(function(){'use strict';var track={id:0,template:'catalog/track',display:function(args){if(typeof args.sng_id!=='string'){return false;}
track.id=args.sng_id;if(typeof args.data==='object'){return track.displayCallback(args.data);}
api.call('deezer.pageTrack',{sng_id:track.id},track.displayCallback);return true;},displayCallback:function(result){try{templating.load(track.template);$('#naboo_track_play').replaceWith(thumbnails.draw({id:track.id,alb_id:result.DATA.ALB_ID,art_id:result.DATA.ART_ID,lyrics_id:result.DATA.LYRICS_ID,type:'song',cover_type:'cover',pic_id:result.DATA.ALB_PICTURE,border:true,play:1,play_context:'track_page',width:200,height:200,width_img:250,height_img:250,play_force:true,sent_to_mobile_banner:true}));var hasLyrics=(typeof result.DATA.LYRICS_ID!=='undefined'&&result.DATA.LYRICS_ID!==0);var list_tabs={related_track:{args:{album_list:result.ISRC.data,sng_id:result.DATA.SNG_ID},selected:!hasLyrics},lyrics:{args:{lyrics_id:result.DATA.LYRICS_ID,sng_id:result.DATA.SNG_ID},disabled:!hasLyrics,selected:hasLyrics}};$('#naboo_track_title').text(result.DATA.SNG_TITLE);var mainArtistName=[];var mainArtistHash={};var $item;if(typeof result.DATA.ARTISTS!=='undefined'&&result.DATA.ARTISTS.length>0){var art_name=$('#naboo_track_song > a').clone().removeAttr('id');$('#naboo_track_song > a').remove();var art_list=$('<p></p>');for(var a in result.DATA.ARTISTS){if(!result.DATA.ARTISTS.hasOwnProperty(a)){continue;}
if(result.DATA.ARTISTS[a].ROLE_ID==0||result.DATA.ARTISTS[a].ROLE_ID==5){mainArtistName.push(result.DATA.ARTISTS[a].ART_NAME);mainArtistHash[result.DATA.ARTISTS[a].ART_ID]=true;$item=art_name.clone();$item.attr('href','/artist/'+result.DATA.ARTISTS[a].ART_ID).text(result.DATA.ARTISTS[a].ART_NAME);if(a>0){art_list.append($('<span>, </span>'));}
art_list.append($item);}}
$('#naboo_track_song').append(art_list.children());}else if(result.DATA.ART_ID!=null&&result.DATA.ART_NAME!=null){mainArtistName.push(result.DATA.ART_NAME);$('#naboo_track_song > a').attr('href','/artist/'+result.DATA.ART_ID).text(result.DATA.ART_NAME);}
if(result.DATA.DURATION!=null){$('#naboo_track_duration').text(secToMin(result.DATA.DURATION));}
$('#naboo_track_share > button').data('id',track.id);$('#naboo_track_favorite').html(button_multi_state.draw({action:'favorite',type:'song',id:track.id}));Events.subscribe(Events.layout.adsBackground,track.adjustContent,'track');$('#naboo_track_share a').attr('onClick','sharebox.load(0, '+track.id+'); return false;');tabs.init($('#naboo_track_tabs'),list_tabs);naboo.afterLoad(true);return true;}catch(e){error.log(e);}},adjustContent:function(){try{$('#related_content_top > ul').responsiveCover_update();}catch(e){error.log(e);}}};window.track=track;})();;
if(typeof app=='undefined'){var app={id:0,template:'naboo/app',actual_page:null,last_page:null,base_page:null,loaded:false,iframe:null,url_id:null,alias:null,display:function(args){if(args.action=='login'){return app.displayLogin(args);}
if(typeof args.app_id!=='string'){return false;}
app.id=app.app_id=args.app_id;var deep_link='';if(typeof args.deep_link==='string'){deep_link=args.deep_link;}
if(typeof args.dzq=='string'){deep_link+='?dzq='+args.dzq;}
var page_splitted=deep_link.split('?');deep_link=page_splitted[0];if(page_splitted.length>1){var search=page_splitted[1];search=search.split('&');for(var i=0;i<search.length;i++){var param=search[i].split('=');if(param.length==2&&param[0]=='dzq'){deep_link+='?'+hex2bin(param[1]);break;}}}
if(typeof args.data==='object'){return app.launch({app_data:args.data,deep_link:deep_link});}
api.call('application.getPublicData',{app_id:app.id},function(result){app.launch({app_data:result,deep_link:deep_link});});},onPageChanged:function(args){app.loadPage(args.deep_link);naboo.afterLoad();},sendRequest:function(user_id_to,app_id,message){api.call('application.sendRequest',{user_ids_to:[user_id_to],app_id:app_id,message:message},function(result){$.facebox.close(false);});},displayLogin:function(args){try{if(typeof args.redirect_app_id==='undefined'){naboo.afterLoad(true);app.redirect_appstudio();return true;}
if(typeof args.data==='object'){app.displayLoginCallback(args.data,args);return true;}
api.call('application.getPublicData',{app_id:args.redirect_app_id},function(response){app.displayLoginCallback(response,args);});return true;}catch(e){error.log(e);}},displayLoginCallback:function(result,args){var redirect_app_id=args.redirect_app_id||'';var redirect_link=typeof args.redirect_link!=='undefined'?decodeURIComponent('/'+args.redirect_link):('/app/'+request.APP_ID);templating.load('app/login');$('#app_picture').attr('src',SETTING_DOMAIN_IMG+'/misc/'+result.APP_PICTURE+'/120x120-000000-80-0-0.jpg');$('#app_name').text(result.NAME);$('#h2_app_name').text(result.NAME);$('#app_description').text(result.DESCRIPTION);$('#btn_login').click(function(){modal.open('/lightbox/login.php?redirect_type=refresh&redirect_link='+encodeURIComponent(redirect_link)+'&app_id='+redirect_app_id);}).attr('onclick','');$('#btn_register').click(function(){modal.open('/lightbox/register.php?redirect_type=refresh&redirect_link='+encodeURIComponent(redirect_link)+'&app_id='+redirect_app_id);}).attr('onclick','');naboo.afterLoad(true);Events.ready(Events.user.loaded,function(){loadBox(redirect_link);});},redirect_appstudio:function(){window.setTimeout(function(){loadBox('/appstudio');},300);},filterDzParams:function(query_string){var filter=['dzpage','dzlang','dzcountry','dzhash'];var qs=query_string.split('&');query_string=[];for(var i=0;i<qs.length;i++){var filter_this=false;for(var j=0;j<filter.length;j++){if(qs[i].substr(0,filter[j].length+1)==filter[j]+'='){filter_this=true;break;}}
if(filter_this){continue;}
query_string.push(qs[i]);}
return query_string.join('&');},setPage:function(page){if(typeof page!=='object'||typeof page.href==='undefined'){return;}
if(typeof page.pathname==='undefined'){return;}
var dzq='';if(typeof page.search==='string'&&page.search!==''){dzq=page.search.substr(1);dzq=app.filterDzParams(dzq);if(dzq!==''){dzq='?dzq='+bin2hex(dzq);}}
var a=document.createElement('a');a.href=app.app_data.INAPP_URL_WEB;page.pathname=ltrim(page.pathname,'/');var new_page_link;if(app.loadPageMode=='ajax'){new_page_link='/'+page.pathname;}else{var origin=app.app_data.INAPP_URL_WEB.split(a.host)[0]+a.host+'/'+page.pathname;new_page_link='/'+origin.substr(app.app_data.INAPP_URL_WEB.length);}
new_page_link+=dzq;app.actual_page=new_page_link;var actual_page=trim(www.getCurrentPath(),'/ ');new_page_link=trim(new_page_link,'/');var address='app/'+app.url_id+'/'+new_page_link;if(actual_page!=address){www.setCurrentPath(address,true);}
Events.trigger(Events.navigation.page_displayed,{path:naboo.getCurrentPath()});return;},loadPageMode:'basic',loadPage:function(page){if(!app.loaded){return false;}
if(app.actual_page!=page){app.actual_page=page;var loadPage=app.actual_page;if(app.actual_page.indexOf('?')!=-1){var url=app.actual_page.split('?');var qs=url[1].split('&');var dzq=null;for(var i=0;i<qs.length;i++){if(qs[i].substr(0,4)=='dzq='){dzq=qs[i].substr(4);break;}}
if(dzq!==null){loadPage=url[0]+'?'+hex2bin(dzq);}}
if(app.loadPageMode=='ajax'){DZ.communication.callAppMethod('DZ.navigation.pageChanged',{evt:'PAGE_CHANGED',val:loadPage});}else{app.loadIframe(loadPage);}}},clear:function(){if(app.loaded){DZ.clearDeezer();}
if(app.iframe!==null){app.iframe.attr('id','dzapp_old').attr('name','dzapp_old').remove();}
dzPlayer.setApp({id:0,type:''});playercontrol.setBlindTestMode(false);app.current_height=0;app.app_id=0;app.alias=null;app.name='';app.channel_url='';app.url_id=null;app.launch_options={};app.actual_page=null;app.loadPageMode='basic';app.last_page=null;app.base_page=null;app.loaded=false;},app_id:0,userDataLoaded:function(){if(!userData.isFavorite('application',app.app_id)){if(typeof USER!='undefined'&&typeof USER.SETTING!='undefined'){app.addToFav.show();app.iframeContainer.addClass('has-favorite');}}},launch_options:{},launch:function(options){var app_data=options.app_data;app.url_id=app.id;if(app.id==app_data.INAPP_ALIAS){app.url_id=app_data.INAPP_ALIAS;}
var the_app_id=app_data.APP_ID;var newNotifs=notifications.list_unread;var to_remove=[];for(var key in newNotifs){if(!newNotifs.hasOwnProperty(key)){continue;}
var notif=newNotifs[key];if(typeof notif.ACTION!='undefined'&&notif.ACTION=='APPLICATION_NOTIFICATION'&&typeof notif.APP_ID!='undefined'){if(notif.APP_ID==the_app_id){to_remove.push(key);}}}
notifications.read(to_remove);if(USER.USER_ID===0&&app_data.NEED_LOGIN){naboo.afterLoad(true);var base_href=(app_data.INAPP_ALIAS===''?app_data.APP_ID:app_data.INAPP_ALIAS);var link=document.createElement('a');link.href='/app/'+base_href+decodeURIComponent(options.deep_link);var dzq=link.search.substr(1);dzq=app.filterDzParams(dzq);if(dzq!==''){dzq='?dzq='+bin2hex(dzq);}
link=encodeURIComponent(link.pathname.substr(1)+dzq);window.setTimeout(function(){loadBox('/app/login?app_id='+app_data.APP_ID+'&redirect_app_id='+app_data.APP_ID+'&redirect_link='+link);},300);return false;}
app.app_data=app_data;options={app_id:app_data.APP_ID,alias:app_data.INAPP_ALIAS,channel_url:app_data.INAPP_CHANNEL_URL,name:app_data.NAME,deep_link:typeof options.deep_link=='undefined'?null:options.deep_link};if(options.deep_link===null){delete options.deep_link;}
if(typeof DZ!='undefined'){DZ.inapploadedCount=0;}
if(typeof options.deep_link!='undefined'){options.deep_link=decodeURIComponent(options.deep_link);}
if(typeof options.deep_link=='undefined'||options.deep_link=='/'){options.deep_link='';}
if(options.deep_link!==''){var deep_link=options.deep_link.split('?');if(deep_link.length>1){deep_link[1]=app.filterDzParams(deep_link[1]);options.deep_link=deep_link.join('?');}}
app.launch_options=options;app.app_id=options.app_id;app.alias=options.alias;app.channel_url=options.channel_url;app.name=options.name;app.base_page='app/'+options.app_id+options.deep_link;app.actual_page=options.deep_link;getScripts(RESSOURCES.dz,function(){app.loadDom();app.loadDZ();app.loadIframe(options.deep_link);});naboo.afterLoad(true);app.loaded=true;return true;},leave:function(){app.clear();},loadDZ:function(){if(ENV=='DEV'){DZ.SETTING_HOST_SITE=SETTING_HOST_SITE;DZ.SETTING_HOST_CONNECT=SETTING_HOST_CONNECT;DZ.SETTING_HOST_API=SETTING_HOST_API;DZ.DEBUG=true;}
if(ENV=='PREPROD'){DZ._override_pp();}
DZ.init({appId:app.app_id,channelUrl:app.channel_url,inapp:true});},loadDom:function(){var naboo=$('#naboo_content');var draggable=$('<div class="inapp-draggable-element" id="inapp_draggable_element"></div>');var appfavorite=$('<button class="btn btn-primary type="button"><span class="icon icon-add"></span><span class="label">'+gettext('Ajouter à mes applis')+'</span></button>');naboo.html('');naboo.append('<div id="dz-root"></div>');naboo.append(draggable);app.iframeContainer=$('<div id="inapp_iframe_container"></div>');app.addToFav=$('<div class="inapp-add-favorite"></div>').appendTo(naboo);$('#inapp_draggable_element').draggable({helper:function(){return'<div class="inapp-draggable-helper">music draggable !</div>';},appendTo:'body',refreshPositions:true,cursorAt:{top:0,left:0},start:function(event,ui){$('#inapp_draggable_element').attr({'data-value':JSON.stringify([[$('#inapp_draggable_element').attr('data-id'),'0']]),'element-type':'0'});}});app.addToFav.hide();appfavorite.click(function(){favorite.add({type:'application',id:app.app_id});}).appendTo(app.addToFav);Events.ready(Events.user.userReady,app.userDataLoaded);Events.addEvent('DZ',Events.user.addFavorite,function(evt,params){if(params.id==app.app_id){app.addToFav.hide();app.iframeContainer.removeClass('has-favorite');}});Events.addEvent('DZ',Events.user.deleteFavorite,function(evt,params){if(params.id==app.app_id){app.addToFav.show();app.iframeContainer.addClass('has-favorite');}});app.iframeContainer.append('<div id="inapp_iframe_overlay"></div>');naboo.append(app.iframeContainer);return true;},onResize:function(evt,args){app.setSize(0,true);},nbIframes:0,loadIframe:function(deep_link){app.nbIframes++;if(typeof deep_link=='undefined'||deep_link===null){deep_link='';}
deep_link=ltrim(deep_link,'/ ');if(deep_link===''&&typeof DZ!='undefined'){DZ.inapploadedCount=0;}
var container=$('#inapp_iframe_container');var iframe_url=PROTOCOL_HTTP+SETTING_HOST+'/app/launcher.php?app_id='+app.app_id+'&inapp_page='+encodeURIComponent(deep_link);var iframe=$('#dzapp'+(app.nbIframes-1));if(iframe.length>0){iframe.remove();}
app.iframe=$('<iframe id="dzapp'+app.nbIframes+'" name="dzapp'+app.nbIframes+'" frameBorder="0" allowTransparency="true" src="'+iframe_url+'" '+' style="width:100%;height:100%;border: 0;"'+'></iframe>');container.append(app.iframe);},current_height:0,setSize:function(height,fromResize){return true;},scrollTop:function(){$(document.body).scrollTop(0);},hideInappOverlay:function(){$('#inapp_iframe_overlay').hide();window.setTimeout(function(){$(document).unbind('mouseup',app.hideInappOverlay);},0);},showInappOverlay:function(){$('#inapp_iframe_overlay').show();$(document).bind('mouseup',app.hideInappOverlay);},startDragElement:function(type,id){$('#inapp_iframe_overlay').show();$(document).bind('mouseup',app.hideInappOverlay);var evt=document.createEvent('MouseEvents');evt.initMouseEvent('mousedown',true,true,window,0,0,0,0,0,false,false,false,false,0,null);var element=document.getElementById('inapp_draggable_element');var data_type=0;switch(type){case'track':data_type=0;break;default:break;}
$(element).attr('data-type',data_type).attr('data-id',id);element.dispatchEvent(evt);}};};
var appstudio={id:0,template:'naboo/appstudio',categories:['curators','labels','tools','discovery','games','events'],init:function(){appstudio.initApps();appstudio.initCategories();},display:function(args){if(typeof args.data==='object'){return appstudio.displayCallback(args.data);}
getScripts(RESSOURCES.appstudio,function(){api.call('deezer.pageAppstudio',{},appstudio.displayCallback,{});});return true;},displayCallback:function(result){templating.load(appstudio.template);var apps_list=[result.visio,result.apps];var header=$('#page_appstudio_header');var showcase=$('.showcase');var applist=$('.applications .applist_container',showcase);var app_tpl=$('.application',applist).remove();for(var k=0;k<apps_list.length;k++){var apps=apps_list[k];var html_apps=[];for(var i=0;i<apps.length;i++){var $app=app_tpl.clone();var app=apps[i];app.LINK=(app.INAPP_ALIAS===''?app.APP_ID:app.INAPP_ALIAS);var app_img;if(k===0){app_img=appstudio.getImgLink(app.APP_PICTURE_950x320,'160x475');}else{app_img=appstudio.getImgLink(app.APP_PICTURE_220x140,'140x220');}
var cat_name=appstudio.getCatKey(app.CATEGORY);$app.addClass(cat_name).find('.meta_name').html(appstudio.getCatName(app.CATEGORY));$app.find('.app_name').html(app.NAME);$app.find('.app_description .tinyscroll_overview').html(app.DESCRIPTION);$app.find('.app_img img').attr('src',app_img);var links=[];var meta_links=[];if(app.INAPP_STATUS=='2'){links.push('<li><a href="'+SETTING_HOST_SITE+'/app/'+app.LINK+'" target="_blank" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'inapp\', source:\'btn\', category:\''+cat_name+'\'}); appstudio.goToApp(\''+app.LINK+'\', '+(app.NEED_LOGIN?'true':'false')+');return false;">'+gettext('App Deezer')+'</a></li>');meta_links.push('<a href="'+SETTING_HOST_SITE+'/app/'+app.LINK+'" target="_blank" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'inapp\', source:\'icon\', category:\''+cat_name+'\'});appstudio.goToApp(\''+app.LINK+'\', '+(app.NEED_LOGIN?'true':'false')+');return false;"><span class="icon icon-deezer-short"></span></a>');}else{if(app.SITE_URL!==''){links.push('<li><a href="'+app.SITE_URL+'" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'web\', source:\'btn\', category:\''+cat_name+'\'});" target="_blank">Web</a></li>');meta_links.push('<a href="'+app.SITE_URL+'" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'web\', source:\'icon\', category:\''+cat_name+'\'});" target="_blank"><span class="icon icon-html5"></span></a>');}
if(app.APP_STORE_URL!==''){links.push('<li><a href="'+app.APP_STORE_URL+'" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'ios\', source:\'btn\', category:\''+cat_name+'\'});" target="_blank">iOS</a></li>');meta_links.push('<a href="'+app.APP_STORE_URL+'" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'ios\', source:\'icon\', category:\''+cat_name+'\'});" target="_blank"><span class="icon icon-apple"></span></a>');}
if(app.GOOGLE_PLAY_URL!==''){links.push('<li><a href="'+app.GOOGLE_PLAY_URL+'" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'android\', source:\'btn\', category:\''+cat_name+'\'});" target="_blank">Android Market</a></li>');meta_links.push('<a href="'+app.GOOGLE_PLAY_URL+'" onclick="tracking.track(\'appstudio_app_click\', {app_id:'+app.APP_ID+', app_name:\''+escape(app.NAME)+'\', type:\'android\', source:\'icon\', category:\''+cat_name+'\'});" target="_blank"><span class="icon icon-android"></span></a>');}}
$app.find('.button-container .block_available-links ul').append(links.join(''));$app.find('.meta_links').append(meta_links.join(''));html_apps.push($app.get(0).outerHTML);}
$(applist.get(k)).html(html_apps.join(''));}
naboo.afterLoad(true);appstudio.init();},getCatKey:function(cat_id){if(typeof appstudio.categories[cat_id]=='undefined'){return'';}
return appstudio.categories[cat_id];},getCatName:function(cat_id){if(typeof appstudio.categories[cat_id]=='undefined'){return'';}
return appstudio.categories_name[appstudio.categories[cat_id]];},getImgLink:function(md5,size){return SETTING_DOMAIN_IMG+'/misc/'+md5+'/'+size+'-ffffff-90-1-1.jpg';},goToApp:function(app_id,need_login){if(USER.USER_ID===0&&need_login){www.goToConnection();return false;}
loadBox('/app/'+app_id);},resizeTinyscrollbars_timeout:null,resizeTinyscrollbars:function(){if(appstudio.resizeTinyscrollbars_timeout!==null){window.clearTimeout(appstudio.resizeTinyscrollbars_timeout);appstudio.resizeTinyscrollbars_timeout=null;}
appstudio.resizeTinyscrollbars_timeout=window.setTimeout(function(){$('.app_description').each(function(){$(this).tinyscrollbar_update('relative');});},500);},initApps:function(){$('.app_description').each(function(){$(this).tinyscrollbar({extremePreventDefault:false});});$('.applist_container').each(function(i){if(i===0){$(this).coverPane({'max_line':1,'ratio':0.35,'cover_size':475,'padding':20,'between':20,'label_size':100,'onresize':function(){appstudio.resizeTinyscrollbars();}});}else{$(this).coverPane({'ratio':0.63,'cover_size':220,'padding':20,'between':20,'label_size':140,'onresize':function(){appstudio.resizeTinyscrollbars();}});}});$('.application .app_img').hover(function(){},function(){$(this).find('.block_available-links').hide();});$('.button-container').each(function(){var available_links=$(this).find('.block_available-links li');if(available_links.length==1){var button=$(this).find('.btn');button.find('.icon-arrow-filter-down').remove();button.css({'padding-right':'13px','text-align':'center'});button.click(function(){var link=available_links.find('a');var result_click=link.get(0).onclick();if(result_click!==false){window.open(link.attr('href'));}});}else{$(this).find('.btn').click(function(){$(this).parent().find('.block_available-links').slideToggle('fast');});}});$('.icn_deezer').tipsy({gravity:'e',fallback:gettext('Disponible dans Deezer')});$('.icn_web').tipsy({gravity:'e',fallback:gettext('Disponible sur le Web')});$('.icn_ios').tipsy({gravity:'e',fallback:gettext('Disponible sur iOS')});$('.icn_android_market').tipsy({gravity:'e',fallback:gettext('Disponible sur Android')});},initCategories:function(){$('.app_cat_menu .menu_item').each(function(){$(this).click(function(){var id_cat=$(this).attr('id-cat');var app_list=$('#apps_container');if(id_cat=='all'){$('.app_cat_menu .menu_item').removeClass('app_disabled');$('.application',app_list).removeClass('app_disabled');return true;}
$('.app_cat_menu .menu_item').addClass('app_disabled');$(this).removeClass('app_disabled');$('.application',app_list).addClass('app_disabled');$('.application.'+id_cat,app_list).removeClass('app_disabled');});});},openAppDetails:function(app_id){loadFacebox('/lightbox/app.php?app_id='+app_id);},actual_width:0,nb_apps:0,apps_container:null,big_apps:[],events_subscribed:false,subscribeEvents:function(){if(appstudio.events_subscribed){return false;}
appstudio.events_subscribed=true;Events.subscribe(Events.layout.resize,appstudio.redrawApps);},initCovers:function(){try{appstudio.actual_width=0;appstudio.nb_apps=0;appstudio.big_apps=[];appstudio.apps_container=$('#apps_container');appstudio.prepareListApp();appstudio.redrawApps();appstudio.subscribeEvents();}catch(e){console.log(e,e.stack);}},prepareListApp:function(){appstudio.apps_container.find('.application').each(function(i){var $this=$(this);if($this.is('.app_big')){var big_app={position_original:i,position:i,element:$this};appstudio.big_apps.push(big_app);}
appstudio.nb_apps=i+1;});},getNbAppsAfter:function(i){if(i>=appstudio.big_apps.length){return 0;}
var app=appstudio.big_apps[i];var nb_app_after=(appstudio.nb_apps-app.position-1);if(i+1<appstudio.big_apps.length){nb_app_after=appstudio.big_apps[i+1].position_original-app.position-1;}
return nb_app_after;},getNbAppsBefore:function(i){if(i>=appstudio.big_apps.length){return 0;}
var pos_before=0;if(i>0){pos_before=appstudio.big_apps[i-1].position+1;}
var pos=appstudio.big_apps[i].position;var nb_app_before=pos-pos_before;return nb_app_before;},redrawApps:function(){var container_width=appstudio.apps_container.width();var app_width=222;var app_margin=18;var app_cols=Math.floor((container_width+app_margin)/(app_width+app_margin));var new_width=app_cols*(app_width+app_margin)-app_margin;if(new_width==appstudio.actual_width){return false;}
appstudio.actual_width=new_width;for(var i=0;i<appstudio.big_apps.length;i++){appstudio.big_apps[i].position=appstudio.big_apps[i].position_original;var app=appstudio.big_apps[i];var nb_app_before=appstudio.getNbAppsBefore(i);var nb_app_after=appstudio.getNbAppsAfter(i);if(i%2==1){app.element.css({'float':'right'});}
if(i>0){nb_app_needed=((app_cols-2)*2);if(nb_app_before==nb_app_needed){continue;}else{if(nb_app_before<nb_app_needed){var decal=nb_app_needed-nb_app_before;console.log(i,'DECAL',decal,nb_app_needed,nb_app_before,nb_app_after);if(decal>=nb_app_after){app.position=app.position-nb_app_before;nb_app_after=appstudio.getNbAppsAfter(i);if(app_cols>4&&nb_app_after<(app_cols-4)*2){app.element.css({'float':'left'});}
continue;}
app.position=app.position+decal;nb_app_after=appstudio.getNbAppsAfter(i);console.log(i,'THE TESt',nb_app_after,((app_cols-2)*2));if(app_cols<=4&&nb_app_after<(app_cols-2)*2){app.element.css({'float':'left'});}
nb_app_before=0;}else{nb_app_before=nb_app_before-nb_app_needed;}}}
var lines=Math.ceil(nb_app_before/app_cols);var nb_app_needed=lines*app_cols-nb_app_before;if(nb_app_needed>(app_cols/2)){app.position=app.position-(app_cols-nb_app_needed);}else{app.position=app.position+nb_app_needed;}}
appstudio.apps_container.find('.application.app_big').remove();for(i=0;i<appstudio.big_apps.length;i++){var list_app=appstudio.apps_container.find('.application');var position=Math.min(appstudio.big_apps[i].position-1,list_app.length-1);console.log('INSERT AFTER',appstudio.big_apps[i].position,list_app.get(position));appstudio.big_apps[i].element.insertAfter($(list_app.get(position)));}
$('.applications',appstudio.apps_container).css({width:new_width+'px'});$('.applist_container',appstudio.apps_container).css({width:(new_width+app_margin)+'px'});$('.fluid_container').css({width:new_width+'px'});}};;
var tabs={loaded:false,$container_naboo:null,$container_active:null,$container:null,$links:null,$panels:null,selected:null,list_tabs:{},destroy:function(){for(var key in tabs.list_tabs){if(!tabs.list_tabs.hasOwnProperty(key)){continue;}
if(typeof window[key]==='undefined'){delete tabs.list_tabs[key];continue;}
var component=window[key];if(typeof component.destroy=='function'){component.destroy();}
delete tabs.list_tabs[key];}
if(tabs.selected!=null){Events.unsubscribeAll(tabs.selected);}
Events.unsubscribeAll('tabs');tabs.loaded=false;tabs.selected=null;tabs.list_tabs={};tabs.$container=null;tabs.$nav_bar=null;tabs.$links=null;tabs.$panels=null;tabs.$more=null;},init:function($container,list_tabs){tabs.$container_naboo=$('#naboo_content');tabs.$container=$container;tabs.$nav_bar=$('.navbar',tabs.$container);tabs.$links=$('.navbar > ul',tabs.$container);tabs.$panels=$('.nav-tabs-panel',tabs.$container);tabs.$more=$('[data-target="more"]',tabs.$links);tabs.list_tabs={};for(var type in list_tabs){if(!list_tabs.hasOwnProperty(type)){continue;}
if(typeof window[type]!=='object'){throw new Error(type+' is not a valid component for tabs !');}
var component=list_tabs[type];component.cached=false;if(typeof component.disabled==='boolean'&&component.disabled){$('#tab_'+type+'_link',tabs.$container).remove();continue;}
$('#tab_'+type+'_link',tabs.$container).data('width',$('#tab_'+type+'_link',tabs.$container).outerWidth(true));if(typeof component.selected=='boolean'&&component.selected){tabs.selected=type;}
tabs.list_tabs[type]=component;}
Events.subscribe(Events.layout.resize,function(){clearTimeout(tabs.resize_delay);tabs.resize_delay=setTimeout(tabs.resizeMenu,500);},naboo.getCurrentClass());Events.subscribe(Events.layout.adsBackground,function(){tabs.resizeMenu();},naboo.getCurrentClass());tabs.resizeMenu();$('.dropdown',tabs.$links).on('click',tabs.toggleMoreMenu).on('mouseup',function(){return false;}).on('mousedown',function(){$('body').unbind('mouseup',tabs.toggleMoreMenu);return false;});tabs.loaded=true;if(tabs.selected!==null){tabs.display(tabs.selected);}},navClick:function($tab){if(!tabs.loaded){return false;}
var type=$tab.attr('data-tabs');if(typeof tabs.list_tabs[type]!=='undefined'&&typeof tabs.list_tabs[type].url!=='undefined'){loadBox(tabs.list_tabs[type].url);}
tabs.display(type);return true;},display:function(type,auto_scroll){if(!tabs.loaded){return false;}
if(typeof auto_scroll==='undefined'){auto_scroll=false;}
if(typeof tabs.list_tabs[type]==='undefined'){return false;}
if(tabs.selected!=null){Events.unsubscribeAll(tabs.selected);}
Events.subscribeOnce(Events.navigation.tab_displayed,function(){tabs.$container_active.height('auto');});tabs.selected_previous=tabs.selected;tabs.selected=type;var args=tabs.list_tabs[type].args||{type:type,id:naboo.id};var tab=type;$tab=$('#tab_'+tab+'_link > a');tabs.$container_active=$('#tab_'+tab+'_content',tabs.$container);tabs.$container_active.addClass('active');if(!tabs.list_tabs[tab].cached){tabs.$container_active.height(tabs.$container_naboo.height());}
var $tab_link_active=$('#tab_'+tab+'_link',tabs.$container);$tab_link_active.addClass('active');if(tabs.selected_previous!==tabs.selected){$('#tab_'+tabs.selected_previous+'_link',tabs.$container).removeClass('active');$('#tab_'+tabs.selected_previous+'_content',tabs.$container).removeClass('active');}
$('.badge',$tab_link_active).text(0).hide();infinite_scroll.disable();if(auto_scroll){var div_position=tabs.$container.position();if(div_position.top!=null){$('#page_content').scrollTop(yscroll+div_position.top);}}
if(tabs.list_tabs[tab].cached){if(typeof window[tab].onDisplay=='function'){window[tab].onDisplay();}
Events.trigger(Events.navigation.tab_displayed,args);return true;}
if(tab==='comment'||tab==='track'){$('.comment-box',tabs.$container_active).commentbox({display:true,infinite_scroll:true,type:args.type,element_id:args.id,twitter_share:true,facebook_share:true,publish_button:$('#btn-submit-comment'),template:(tab==='track')?'catalog':null,events_group:(tab==='track')?'track':'comment'});}else{window[tab].display(args);}
tabs.list_tabs[tab].cached=true;return;},resizeMenu:function(evt){try{if(typeof tabs.$links!=='undefined'){tabs.$links.children('li').last().show();}
if(tabs.$more.hasClass('opened')){tabs.toggleMoreMenu();}
var usedItemsSize=tabs.getTabsMenuWidth();if(tabs.$nav_bar.width()<usedItemsSize){var elt=tabs.$links.children('li[data-tab]').last().clone(true);tabs.$links.children('li[data-tab]').last().remove();tabs.$more.prepend(elt);tabs.resizeMenu();return true;}
var nbMoreItems=tabs.$more.children().children().length;var addItemSize=tabs.$more.children().first().data('width');var addItemInMainBar=(nbMoreItems>1&&tabs.$nav_bar.width()>usedItemsSize+addItemSize);var addLastItemInMainBar=(nbMoreItems===1&&tabs.$nav_bar.width()>(addItemSize+usedItemsSize-tabs.$more.parent().outerWidth()));if(addItemInMainBar||addLastItemInMainBar){var elt=tabs.$more.children().first().clone(true);tabs.$more.children().first().remove();elt.insertBefore(tabs.$links.children('li').last());if(nbMoreItems>1){tabs.resizeMenu();}else{tabs.$links.children('li').last().hide();}
return true;}
if(nbMoreItems===0){tabs.$links.children('li').last().hide();}
return false;}catch(e){error.log(e);}},getTabsMenuWidth:function(){try{var totalWidth=0;tabs.$links.children('li:visible').each(function(){totalWidth+=$(this).outerWidth(true);});return totalWidth;}catch(e){error.log(e);}},toggleMoreMenu:function(e){try{if(typeof e==='object'){e.preventDefault();}
var dropdown=tabs.$more.closest('.dropdown');if(!dropdown.hasClass('opened')){dropdown.addClass('opened');$('body').trigger('mouseup');$('body').bind('mouseup',tabs.toggleMoreMenu);}else{dropdown.removeClass('opened');$('body').unbind('mouseup',tabs.toggleMoreMenu);}}catch(e){error.log(e);}}};;
var chronicles={alb_id:0,provider:'',display:function(args){try{chronicles.alb_id=args.id;if(typeof provider!=='undefined'){chronicles.provider=args.provider;}
var params={alb_id:chronicles.alb_id,lang:SETTING_LANG};api.call('review.getList',params,chronicles.displayCallback);return true;}catch(e){error.log(e);}},displayCallback:function(result){try{if(result.count!=null&&result.count>0){for(var chronicle_item in result.data){if(!result.data.hasOwnProperty(chronicle_item)){continue;}
var chronicle_data=result.data[chronicle_item];var file_name=chronicle_data.LOGO_BIG.split('.');if(file_name.length!==2){continue;}
var logo_chronicle=SETTING_STATIC+'/img/review/big/'+file_name[0]+'-v'+STATIC_VERSION+'.'+file_name[1];var name_chronicle=chronicle_data.PARTNER_NAME;var id_chronicle=chronicle_data.SOURCE;if(chronicles.provider==''){chronicles.provider=id_chronicle;}
$('#tab_chronicles_content > table .naboo_album_chronicles_providers').append('<div id="naboo_album_chronicles_provider_'+id_chronicle+'"><a href="javascript:void(0)" onclick="chronicles.changePovider(\''+id_chronicle+'\'); return false;"><img src="'+logo_chronicle+'" alt="'+name_chronicle+'" /></a></div>');if(result.data[chronicle_item].AUTHOR_NAME==null){result.data[chronicle_item].AUTHOR_NAME='';}
if(result.data[chronicle_item].URL!=null&&result.data[chronicle_item].CHRONICLE!=null){var html_chronicles='<div id="naboo_album_chronicles_text_'+id_chronicle+'" style="display:none">'+result.data[chronicle_item].CHRONICLE+'<br/><br/>'+result.data[chronicle_item].AUTHOR_NAME;if((result.data[chronicle_item].URL!=null)&&(result.data[chronicle_item].URL!=='')){html_chronicles+='<br/>'+gettext('Retrouvez plus de chroniques sur')+' <a href="'+result.data[chronicle_item].URL+'" target="_blank">'+result.data[chronicle_item].URL+'</a>';}
html_chronicles+='</div>';$('#tab_chronicles_content > table .naboo_album_chronicles_texts').append(html_chronicles);}}}
chronicles.changePovider(chronicles.provider);Events.trigger(Events.navigation.tab_displayed,{type:'chronicles',id:chronicles.alb_id});return true;}catch(e){error.log(e);}},changePovider:function(id_provider){try{if(id_provider!=''){$('#tab_chronicles_content .naboo_album_chronicles_texts div').hide();$('#naboo_album_chronicles_text_'+id_provider).show();}
$('#tab_chronicles_content .naboo_album_chronicles_providers div a').removeClass('selected');$('#naboo_album_chronicles_provider_'+id_provider+' a').addClass('selected');return true;}catch(e){error.log(e);}},onDisplay:function(){chronicles.changePovider(chronicles.provider);return true;},open:function(id_provider){try{if(id_provider!=''&&id_provider!=chronicles.provider){chronicles.changePovider(id_provider);}
return false;}catch(e){error.log(e);}}};;
var edito={alb_id:0,current_provider:'',data:{},display:function(args){try{edito.alb_id=args.id;edito.current_provider=args.provider||'';edito.content=$('#tab_edito_content');var params={alb_id:edito.alb_id,lang:SETTING_LANG};api.call('review.getList',params,edito.displayCallback);return true;}catch(e){error.log(e);}},displayCallback:function(result,params){try{edito.data=result;edito.current_provider=params.provider_name||edito.current_provider;var index_display=0;if(result.count!=null&&result.count>0){$('[data-target="logo"]',edito.content).empty();$('[data-target="author"] > img',edito.content).remove();for(var chronicle_item in result.data){if(!result.data.hasOwnProperty(chronicle_item)){continue;}
var chronicle_data=result.data[chronicle_item];var file_name=chronicle_data.LOGO_BIG.split('.');if(chronicle_data.SOURCE===edito.current_provider){index_display=chronicle_item;}
if(file_name.length!==2){continue;}
var logo_chronicle=SETTING_STATIC+'/img/review/big/'+file_name[0]+'-v'+STATIC_VERSION+'.'+file_name[1];var name_chronicle=chronicle_data.PARTNER_NAME;var id_chronicle=chronicle_data.SOURCE;if(edito.provider===''){edito.provider=id_chronicle;}
$img='<img src="'+logo_chronicle+'" alt="'+name_chronicle+'"/>';if(result.count>1){$img='<a href="javascript:void(0)" class="review-logo" onclick="edito.changePovider(\''+chronicle_data.SOURCE+'\'); return false;">'+$img+'</a>';}
$('[data-target="logo"]',edito.content).append($img);}
$('[data-target="logo"] > a',edito.content).removeClass('active');$('[data-target="logo"] > a:eq('+index_display+')',edito.content).addClass('active');$('[data-target="title"]',edito.content).text(album.data.ALB_TITLE);$('[data-target="author"]',edito.content).text(result.data[index_display].AUTHOR_NAME||'');if(result.data[index_display].PARTNER_NAME!==''&&result.data[index_display].URL!==''){$('[data-target="source"]',edito.content).html(gettext('Source :')+' <a href="'+result.data[index_display].URL+'" class="link-primary" target="_blank">'+result.data[index_display].PARTNER_NAME+'<span class="icon icon-arrow-right icon-after"></span></a>');}
if(result.data[index_display].URL!=null&&result.data[index_display].CHRONICLE!=null){$('[data-target="text"]',edito.content).html(result.data[index_display].CHRONICLE);}}
Events.trigger(Events.navigation.tab_displayed,{type:'edito',id:edito.alb_id});return true;}catch(e){error.log(e);}},onDisplay:function(provider_name){edito.current_provider=provider_name;edito.changePovider(provider_name);},changePovider:function(provider_name){try{edito.displayCallback(edito.data,{provider_name:provider_name});return true;}catch(e){error.log(e);}}};;
if(typeof setting==='undefined'){var setting={removeApp:function(appId){var data='app_id='+encodeURIComponent(appId)+'&checkForm='+encodeURIComponent(checkForm);var request=sendRequest('/ajax/action.php','text','type=setting_removeApp&'+data);if(request==false){return;}
var result=JSON.parse(request);if(result.error.length>0){return;}
loadBox(www.getCurrentPath());return;},updateEmail:function(){try{var actionDone=false;var email=$('#info_new_mail').val()||'';if($('#info_new_mail').length===1){email=$('#info_new_mail').val();}
var password='';if($('#info_pwd').length===1){password=$('#info_pwd').val();}
var email2='';if($('#info_new_mail2').length===1){email2=$('#info_new_mail2').val();}
var old_email='';if($('#info_old_mail').length===1){old_email=$('#info_old_mail').val();}
var checkForm='';if($('#checkForm').length===1){checkForm=$('#checkForm').val();}
var error_message='';if(email==email2){var data='email='+encodeURIComponent(email);data+='&password='+encodeURIComponent(password);data+='&old_email='+encodeURIComponent(old_email);data+='&checkForm='+encodeURIComponent(checkForm);var request=sendRequest('/ajax/action.php','text','type=user_updateEmail&'+data);if(request==false){return;}
var result=JSON.parse(request);if(result.error.REQUEST_ERROR!==undefined){actionDone=false;if(result.error.REQUEST_ERROR==='Email already exists'){error_message=gettext('Cette adresse email est indisponible.');}else if(result.error.REQUEST_ERROR==='Invalid email domain'){error_message=gettext('Le nom de domaine \'%s\' n\'est pas autorisé.',{sprintf:[result.payload.domain]});}else{error_message=gettext('Votre adresse email n\'a pas été mise à jour.');}}else{actionDone=true;}}else{error_message=gettext('Vos adresses email ne correspondent pas. Veuillez réessayer.');}
if(actionDone==false){$('#update_email_result').html(error_message).show();}else{$('#info_save_form').hide();$('#info_save_email_confirm').show();loadBox(www.getCurrentPath());}}catch(e){error.log(e);}},updatePassword:function(){try{var actionDone=false;var password='';if($('#info_new_pwd').length===1){password=$('#info_new_pwd').val();}
var password2='';if($('#info_new_pwd2').length===1){password2=$('#info_new_pwd2').val();}
var old_password='';if($('#info_old_pwd').length===1){old_password=$('#info_old_pwd').val();}
var checkForm='';if($('#checkForm').length===1){checkForm=$('#checkForm').val();}
if(password==password2&&password!=''){var data='password='+encodeURIComponent(password);data+='&old_password='+encodeURIComponent(old_password);data+='&checkForm='+encodeURIComponent(checkForm);var request=sendRequest('/ajax/action.php','text','type=user_updatePassword&'+data);if(request==false){return;}
var result=JSON.parse(request);if(result.error.length>0){actionDone=false;}else{actionDone=true;}}
if(actionDone==false){$('#update_password_result').html(gettext('Votre mot de passe n\'a pas été mis à jour.')).show();}else{$('#info_save_form').hide();$('#info_save_password_confirm').show();loadBox(www.getCurrentPath());}}catch(e){error.log(e);}},saveData:function(){try{$('#check_nom').empty();$('#check_prenom').empty();$('#check_sexe').empty();$('#check_naissance').empty();$('#check_adresse').empty();$('#check_cp').empty();$('#check_ville').empty();$('#check_pays').empty();$('#check_mobile').empty();$('#blog_name').empty();$('#adresse').removeClass();$('#ville').removeClass();$('#pays').removeClass();$('#mobile').removeClass();var sexe='M';if($('#sexe_f').is(':checked')){sexe='F';}
var date_naissance_jour=0;if($('#date_naissance_jour').length===1){date_naissance_jour=$('#date_naissance_jour').val();}
var date_naissance_mois=0;if($('#date_naissance_mois').length===1){date_naissance_mois=$('#date_naissance_mois').val();}
var date_naissance_annee=0;if($('#date_naissance_annee').length===1){date_naissance_annee=$('#date_naissance_annee').val();}
var adresse='';if($('#adresse').length===1){adresse=$('#adresse').val();}
var nom='';if($('#nom').length===1){nom=$('#nom').val();}
var prenom='';if($('#prenom').length===1){prenom=$('#prenom').val();}
var cp='';if($('#cp').length===1){cp=$('#cp').val();}
var ville='';if($('#ville').length===1){ville=$('#ville').val();}
var pays='';if($('#pays').length===1){pays=$('#pays').val();}
var mobile='';if($('#mobile').length===1){mobile=$('#mobile').val();}
var blog_name='';if($('#blog_name').length===1){blog_name=$('#blog_name').val();}
var checkForm='';if($('#checkForm').length===1){checkForm=$('#checkForm').val();}
var data='sexe='+encodeURIComponent(sexe);data+='&date_naissance='+encodeURIComponent(date_naissance_annee)+'-'+encodeURIComponent(date_naissance_mois)+'-'+encodeURIComponent(date_naissance_jour);data+='&adresse='+encodeURIComponent(adresse);data+='&nom='+encodeURIComponent(nom);data+='&prenom='+encodeURIComponent(prenom);data+='&cp='+encodeURIComponent(cp);data+='&ville='+encodeURIComponent(ville);data+='&pays='+encodeURIComponent(pays);data+='&mobile='+encodeURIComponent(mobile);data+='&blog_name='+encodeURIComponent(blog_name);data+='&checkForm='+encodeURIComponent(checkForm);var request=sendRequest('/ajax/action.php','text','type=user_setData&'+data);if(request==false){return;}
var result=JSON.parse(request);if(result.error.length>0){if(result.error==='error'){www.drawFormResult('data_result','form_error','<div class="data_result_nok">'+gettext('Une erreur est survenue, merci de réessayer plus tard.')+'</div>');}else{for(var i=0;i<result.error.length;i++){if(result.error[i]==='sexe'){$('#check_sexe').html('<img src="'+SETTING_STATIC+'/img/common/form_nok.png" alt="" />');}else if(result.error[i]==='naissance'){$('#check_naissance').html('<img src="'+SETTING_STATIC+'/img/common/form_nok.png" alt="" />');}else if(result.error[i]==='blog_name'){$('#check_blog_name').html('<img src="'+SETTING_STATIC+'/img/common/form_nok.png" alt="" />');}}
www.drawFormResult('data_result','form_error','<div class="data_result_nok">'+gettext('Vos données n\'ont pas été mises à jour. Veuillez corriger les champs rouges.')+'</div>');}}else{www.drawFormResult('data_result','form_success','<div class="data_result_ok">'+gettext('Vos données ont été mises à jour.')+'</div>');USER.LASTNAME=nom;USER.FIRSTNAME=prenom;USER.USER_AGE=return_age(date_naissance_annee+'-'+date_naissance_mois+'-'+date_naissance_jour);Events.trigger(Events.user.updateName,{lastname:nom,firstname:prenom});}
$('#data_result').delay(3000).fadeOut();}catch(e){error.log(e);}},initShare:function(){$('#setting_settings .icon-24.icon-mail, #setting_settings .icon-24.icon-phone, #page_account_share .social').tipsy({gravity:'s'});Events.ready(Events.googleplus.ready,function(){googleplus.renderGGPlus('hp_create_account_gp');});setting.$userSetting=$('#share_notification, #share_newsletter');if(setting.$userSetting.length===0){return;}
setting.$userSetting.on('click','input[type=checkbox]',function(){var settings={};var namespace=this.getAttribute('data-namespace');settings[namespace]={};settings[namespace][this.id]=this.checked;userSetting.set(settings,true);});},deleteAccount:function(){try{var password='';if($('#delete_account').length===1){password=$('#delete_account').val();}
var checkForm='';if($('#checkForm').length===1){checkForm=$('#checkForm').val();}
var data='&password='+encodeURIComponent(password)+'&checkForm='+encodeURIComponent(checkForm);var request=sendRequest('/ajax/action.php','text','type=user_delete&'+data);if(request==false){return;}
var result=JSON.parse(request);if(result.error.length>0){www.drawFormResult('delete_result','msg_error',gettext('Veuillez vérifier votre mot de passe.'));}else{www.drawFormResult('delete_result','msg_succes',gettext('Un email vient de vous être envoyé.'));}
$('#delete_result').delay(3000).fadeOut();return true;}catch(e){error.log(e);}},confirmUnsubscribeStep1:function(){var form=$('#form_unsubscribe');var radio_btn=$(':radio:checked',form);var err_form=$('#msg_error',form);var err_input=$('#msg_error_input',form);var err_status=false;var message=[];$(err_form,err_input).hide();radio_btn.each(function(){var input=$(this).closest('li').find(':input').not(':radio');if(input.data('force')===true&&input.val().length===0){err_input.show();err_status=true;}
message.push({type:$(this).attr('id'),detail:input.val()});});if(err_status===true){return false;}
if(radio_btn.length===0){err_form.show();return false;}
api.call('feedback.save',{type:'premium',message:message});modal.open('/lightbox/unsubscribe.php?step=2',true);return true;},confirmUnsubscribeStep2:function(){var form=$('#form_unsubscribe');var pwd=$('#user_password',form).val();var err=$('#msg_error',form);if(pwd.length===0){err.show();return false;}
var data='password='+encodeURIComponent(pwd)+'&checkForm='+encodeURIComponent(checkForm);var request=sendRequest('/ajax/action.php','text','type=order_unsubscribe&'+data);if(request==false){return;}
var result=JSON.parse(request);var nb_error=0;if(typeof result.error==='object'){for(var i in result.error){if(!result.error.hasOwnProperty(i)){continue;}
nb_error=nb_error+1;}}
if(nb_error==0){modal.open('/lightbox/unsubscribe.php?step=3',true);return true;}
if(typeof result.error.ERROR==='string'){if(result.error.ERROR==='PASSWORD'){err.show();}
if(result.error.ERROR==='PAYPAL_OLD_SUBSCRIBE_CANCEL'){loadBox('/payment/paypal_unsubscribe.php');}
if(result.error.ERROR==='PAYPAL_SUBSCRIBE_CANCEL'){www.drawFormResult('delete_premium_result','form_error',gettext('Veuillez vous rendre sur Paypal afin de couper votre paiement récurrent'));$('#delete_premium_result').delay(3000).fadeOut();}}},confirmUnsubscribeStep3:function(){user.refreshPageAfterLogin({type:'page',link:'account/subscription'});return true;},resetDeviceSerial:function(user_device_serial_id,device_serial){try{if(typeof user_device_serial_id!='undefined'&&user_device_serial_id>0){var checkForm='';if($('#checkForm').length===1){checkForm=$('#checkForm').val();}
var request=sendRequest('/ajax/action.php','text','type=user_resetDeviceSerial&device_serial_id='+encodeURIComponent(user_device_serial_id)+'&checkForm='+encodeURIComponent(checkForm));if(request==false){return;}
var result=JSON.parse(request);if(result.error.length===0){if($('#device_serial_'+user_device_serial_id).length>0){$('#device_serial_'+user_device_serial_id).hide();}
www.drawFormResult('reset_device_serial','form_success','<div style="background:#F1F1F1;width:391px;padding:10px;margin-top:5px">'+gettext('Votre ancien mobile a été désactivé.')+'</div>');$('#reset_device_serial').delay(3000).fadeOut();}}}catch(e){error.log(e);}},reactivatear:function(){var request=sendRequest('/ajax/action.php','text','type=renewal_reactivate');if(request==false){return;}
var result=JSON.parse(request);var nb_error=0;if(typeof result.error==='object'){for(var i in result.error){if(!result.error.hasOwnProperty(i)){continue;}
nb_error=nb_error+1;}}
if(nb_error==0){document.location.href='/account/subscription?lb=reactive_ar';return true;}
www.drawFormResult('delete_premium_result','form_error',gettext('Impossible de réactiver votre abonnement.'));}};};
var loading_bar={init:function(){loading_bar.content=$('#loading_bar');loading_bar.content_bar=loading_bar.content.children('div');var interval=null;var timeout_interval=null;var is_loading=false;loading_bar.content_bar.css('width','0%');Events.subscribe(Events.navigation.page_changed,function(){if(is_loading){return;}
is_loading=true;var width=20+(Math.random()*55);loading_bar.content.addClass('opened');loading_bar.content_bar.addClass('has-transition').css('width',width+'%');timeout_interval=window.setTimeout(function(){var interval_fct=function(){width+=5;loading_bar.content_bar.css('width',width+'%');if(width>=95){window.clearInterval(interval);}};interval_fct();interval=window.setInterval(interval_fct,1000);},1000);});Events.subscribe(Events.navigation.page_displayed,function(){if(!is_loading){return;}
if(timeout_interval!=null){window.clearTimeout(timeout_interval);timeout_interval=null;}
if(interval!=null){window.clearInterval(interval);interval=null;}
loading_bar.content_bar.removeClass('has-transition');loading_bar.content_bar.css('width','100%');window.setTimeout(function(){loading_bar.content.on('transitionend',function(e){loading_bar.content_bar.css('width','0%');$(this).off('transitionend');}).removeClass('opened');is_loading=false;},500);});}};;
var pro={id:0,template:'naboo/pro',display:function(args){try{pro.displayCallback();return true;}catch(e){error.log(e);}},displayCallback:function(result){try{templating.load(pro.template);naboo.afterLoad(true);return true;}catch(e){error.log(e);}}};;
(function(){'use strict';var show_info={display:function(args){var content=$('#tab_show_info_content');$('[data-target="title"]',content).html(args.data.SHOW_NAME);$('[data-target="text"]',content).html(args.data.SHOW_DESCRIPTION);Events.trigger(Events.navigation.tab_displayed,args);return true;}};window.show_info=show_info;})();;
(function(){'use strict';var episode={id:0,template:'catalog/episode',display:function(args){if(typeof args.episode_id!=='string'){return false;}
episode.id=args.episode_id;if(typeof args.data==='object'){return episode.displayCallback(args.data);}
api.call('episode.getData',{episode_id:episode.id},episode.displayCallback);return true;},displayCallback:function(result){templating.load(episode.template);$('#naboo_episode_play').replaceWith(thumbnails.draw({id:episode.id,show_id:result.SHOW_ID,type:'episode',cover_type:'talk',pic_id:result.SHOW_ART_MD5,border:true,play:1,play_context:'episode_page',width:200,height:200,width_img:250,height_img:250,play_force:true,sent_to_mobile_banner:true,enable_preview:false,favorite_hide:true}));tabs.init($('#naboo_episode_tabs'),{episode_description:{args:{type:'episode_description',id:episode.id,description:result.EPISODE_DESCRIPTION},selected:true}});$('#naboo_episode_title').text(result.EPISODE_TITLE);$('#naboo_show_title > a').attr('href','/show/'+result.SHOW_ID).text(result.SHOW_NAME);if(result.DURATION){$('#naboo_episode_duration').text(secToMin(result.DURATION));}
if(result.EPISODE_PUBLISHED_TIMESTAMP){var episode_date=result.EPISODE_PUBLISHED_TIMESTAMP.split(' ');$('#naboo_episode_date').text(formatDate(episode_date[0]));}
Events.ready(Events.user.userReady,function(){var _bookmark=window.bookmark.getEpisodeBookmark(episode.id).OFFSET;$('#naboo_episode_bookmark').css('width',(Number(_bookmark)*100/result.DURATION)+'%');});naboo.afterLoad(true);}};window.episode=episode;})();;